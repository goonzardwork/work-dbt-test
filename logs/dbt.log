[0m09:24:20.003507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118908ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119817940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119817220>]}


============================== 09:24:20.037755 | 4fe23692-bbce-4ef8-bcee-45c1a5b8f28c ==============================
[0m09:24:20.037755 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:24:20.038158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:24:20.191019 [info ] [MainThread]: dbt version: 1.9.4
[0m09:24:20.191575 [info ] [MainThread]: python version: 3.10.3
[0m09:24:20.191887 [info ] [MainThread]: python path: /Users/goonzardw/Developer/bi/dbt3/.venv/bin/python3
[0m09:24:20.192159 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m09:24:21.858981 [info ] [MainThread]: Using profiles dir at /Users/goonzardw/.dbt
[0m09:24:21.859436 [info ] [MainThread]: Using profiles.yml file at /Users/goonzardw/.dbt/profiles.yml
[0m09:24:21.859704 [info ] [MainThread]: Using dbt_project.yml file at /Users/goonzardw/Developer/bi/dbt3/dbt_project.yml
[0m09:24:21.863250 [info ] [MainThread]: adapter type: postgres
[0m09:24:21.863656 [info ] [MainThread]: adapter version: 1.9.0
[0m09:24:21.927603 [info ] [MainThread]: Configuration:
[0m09:24:21.927944 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:24:21.928282 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:24:21.928499 [info ] [MainThread]: Required dependencies:
[0m09:24:21.928802 [debug] [MainThread]: Executing "git --help"
[0m09:24:21.957658 [debug] [MainThread]: STDOUT: "b"\xec\x82\xac\xec\x9a\xa9\xeb\xb2\x95: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\n\xeb\x8b\xa4\xec\x9d\x8c\xec\x9d\x80 \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\x83\x81\xed\x99\xa9\xec\x97\x90\xec\x84\x9c \xec\x9e\x90\xec\xa3\xbc \xec\x82\xac\xec\x9a\xa9\xed\x95\x98\xeb\x8a\x94 \xea\xb9\x83 \xeb\xaa\x85\xeb\xa0\xb9\xec\x9e\x85\xeb\x8b\x88\xeb\x8b\xa4:\n\n\xec\x9e\x91\xec\x97\x85 \xea\xb3\xb5\xea\xb0\x84 \xec\x8b\x9c\xec\x9e\x91 (\xec\xb0\xb8\xea\xb3\xa0: git help tutorial)\n   clone     \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xb3\xb5\xec\xa0\x9c\xed\x95\xb4 \xec\x83\x88 \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac\xeb\xa1\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   init      \xeb\xb9\x88 \xea\xb9\x83 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98 \xea\xb8\xb0\xec\xa1\xb4 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\x8b\xa4\xec\x8b\x9c \xec\xb4\x88\xea\xb8\xb0\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xeb\xb3\x80\xea\xb2\xbd \xec\x82\xac\xed\x95\xad\xec\x97\x90 \xeb\x8c\x80\xed\x95\x9c \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help everyday)\n   add       \xed\x8c\x8c\xec\x9d\xbc \xeb\x82\xb4\xec\x9a\xa9\xec\x9d\x84 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90 \xec\xb6\x94\xea\xb0\x80\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   mv        \xed\x8c\x8c\xec\x9d\xbc, \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac, \xec\x8b\xac\xeb\xb3\xbc\xeb\xa6\xad \xeb\xa7\x81\xed\x81\xac\xeb\xa5\xbc \xec\x98\xae\xea\xb8\xb0\xea\xb1\xb0\xeb\x82\x98 \xec\x9d\xb4\xeb\xa6\x84\xec\x9d\x84 \xeb\xb0\x94\xea\xbf\x89\xeb\x8b\x88\xeb\x8b\xa4\n   restore   Restore working tree files\n   rm        \xed\x8c\x8c\xec\x9d\xbc\xec\x9d\x84 \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94\xec\x97\x90\xec\x84\x9c \xec\xa0\x9c\xea\xb1\xb0\xed\x95\x98\xea\xb3\xa0 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90\xec\x84\x9c\xeb\x8f\x84 \xec\xa0\x9c\xea\xb1\xb0\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xea\xb3\xbc \xec\x83\x81\xed\x83\x9c \xeb\xb3\xb4\xea\xb8\xb0 (\xec\xb0\xb8\xea\xb3\xa0: git help revisions)\n   bisect    \xec\x9d\xb4\xec\xa7\x84 \xed\x83\x90\xec\x83\x89\xec\x9c\xbc\xeb\xa1\x9c \xeb\xb2\x84\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xec\x96\xb4\xeb\x82\xb8 \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xec\xb0\xbe\xec\x8a\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   diff      \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\xbb\xa4\xeb\xb0\x8b \xec\x82\xac\xec\x9d\xb4, \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\x9e\x91\xec\x97\x85 \xeb\x82\xb4\xec\x9a\xa9 \xec\x82\xac\xec\x9d\xb4 \xeb\x93\xb1\xec\x9d\x98 \xeb\xb0\x94\xeb\x80\x90 \xec\xa0\x90\xec\x9d\x84 \xeb\xb4\x85\xeb\x8b\x88\xeb\x8b\xa4\n   grep      \xed\x8c\xa8\xed\x84\xb4\xea\xb3\xbc \xec\x9d\xbc\xec\xb9\x98\xed\x95\x98\xeb\x8a\x94 \xec\xa4\x84\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   log       \xec\xbb\xa4\xeb\xb0\x8b \xea\xb8\xb0\xeb\xa1\x9d\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   show      \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\xa2\x85\xeb\xa5\x98\xec\x9d\x98 \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   status    \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94 \xec\x83\x81\xed\x83\x9c\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x82\xa4\xec\x9a\xb0\xea\xb3\xa0, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb3\xa0, \xec\xa1\xb0\xec\x9e\x91\xed\x95\x98\xea\xb8\xb0\n   branch    \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xeb\xaa\xa9\xeb\xa1\x9d\xec\x9d\x84 \xec\xb6\x9c\xeb\xa0\xa5\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   commit    \xeb\xb0\x94\xeb\x80\x90 \xec\x82\xac\xed\x95\xad\xec\x9d\x84 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90 \xea\xb8\xb0\xeb\xa1\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   merge     \xec\x97\xac\xeb\x9f\xac \xea\xb0\x9c\xec\x9d\x98 \xea\xb0\x9c\xeb\xb0\x9c \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x95\x98\xeb\x82\x98\xeb\xa1\x9c \xed\x95\xa9\xec\xb9\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   rebase    \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xb2\xa0\xec\x9d\xb4\xec\x8a\xa4 \xeb\x81\x9d\xec\x9d\x98 \xec\xb5\x9c\xec\x83\x81\xec\x9c\x84\xec\x97\x90\xec\x84\x9c \xec\xa0\x81\xec\x9a\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   reset     \xed\x98\x84\xec\x9e\xac HEAD\xeb\xa5\xbc \xec\xa7\x80\xec\xa0\x95\xed\x95\x9c \xec\x83\x81\xed\x83\x9c\xeb\xa1\x9c \xec\x9e\xac\xec\x84\xa4\xec\xa0\x95\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   switch    Switch branches\n   tag       \xed\x83\x9c\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, GPG \xec\x84\x9c\xeb\xaa\x85\xec\x9d\x84 \xea\xb2\x80\xec\xa6\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xed\x98\x91\xeb\x8f\x99 \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help workflows)\n   fetch     \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90\xec\x84\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xec\x99\x80 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4\xeb\xa5\xbc \xeb\x8b\xa4\xec\x9a\xb4\xeb\xa1\x9c\xeb\x93\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   pull      \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c \xeb\x98\x90\xeb\x8a\x94 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xa1\x9c\xec\xbb\xac \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xec\x97\x90\xec\x84\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xa4\xea\xb1\xb0\xeb\x82\x98 \xed\x86\xb5\xed\x95\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   push      \xec\x9b\x90\xea\xb2\xa9 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4 \xeb\xb0\x8f \xea\xb7\xb8\xec\x99\x80 \xea\xb4\x80\xeb\xa0\xa8\xeb\x90\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xec\x97\x85\xeb\x8d\xb0\xec\x9d\xb4\xed\x8a\xb8\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:24:21.958591 [debug] [MainThread]: STDERR: "b''"
[0m09:24:21.958854 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:24:21.959072 [info ] [MainThread]: Connection:
[0m09:24:21.959288 [info ] [MainThread]:   host: localhost
[0m09:24:21.959456 [info ] [MainThread]:   port: 5432
[0m09:24:21.959615 [info ] [MainThread]:   user: postgres
[0m09:24:21.959775 [info ] [MainThread]:   database: postgres
[0m09:24:21.959933 [info ] [MainThread]:   schema: bi
[0m09:24:21.960090 [info ] [MainThread]:   connect_timeout: 10
[0m09:24:21.960249 [info ] [MainThread]:   role: None
[0m09:24:21.960400 [info ] [MainThread]:   search_path: None
[0m09:24:21.960556 [info ] [MainThread]:   keepalives_idle: 0
[0m09:24:21.960711 [info ] [MainThread]:   sslmode: None
[0m09:24:21.960862 [info ] [MainThread]:   sslcert: None
[0m09:24:21.961013 [info ] [MainThread]:   sslkey: None
[0m09:24:21.961160 [info ] [MainThread]:   sslrootcert: None
[0m09:24:21.961311 [info ] [MainThread]:   application_name: dbt
[0m09:24:21.961460 [info ] [MainThread]:   retries: 1
[0m09:24:21.961844 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:24:22.054710 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:24:25.617403 [debug] [MainThread]: Using postgres connection "debug"
[0m09:24:25.617724 [debug] [MainThread]: On debug: select 1 as id
[0m09:24:25.617919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:25.910137 [debug] [MainThread]: SQL status: SELECT 1 in 0.290 seconds
[0m09:24:25.912769 [debug] [MainThread]: On debug: Close
[0m09:24:25.913576 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:24:25.914214 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:24:25.933816 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 6.0213947, "process_in_blocks": "0", "process_kernel_time": 0.407616, "process_mem_max_rss": "131268608", "process_out_blocks": "0", "process_user_time": 1.137933}
[0m09:24:25.934578 [debug] [MainThread]: Command `dbt debug` succeeded at 09:24:25.934444 after 6.02 seconds
[0m09:24:25.935050 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:24:25.935507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118908ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198ebd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189d1ae0>]}
[0m09:24:25.936016 [debug] [MainThread]: Flushing usage events
[0m09:24:26.782984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:34.827876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118308ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a219c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a220e0>]}


============================== 09:24:34.832235 | 795c50eb-0208-4fb4-89a8-11b35c5bb027 ==============================
[0m09:24:34.832235 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:24:34.832589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:24:34.947344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab8efb0>]}
[0m09:24:34.980038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abb72e0>]}
[0m09:24:34.980710 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:24:35.057655 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:24:35.058413 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:24:35.058683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac83700>]}
[0m09:24:36.605376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d960070>]}
[0m09:24:36.652335 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:24:36.658974 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:24:36.727875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d910580>]}
[0m09:24:36.728262 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:24:36.728489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107422050>]}
[0m09:24:36.729403 [info ] [MainThread]: 
[0m09:24:36.729630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:24:36.729814 [info ] [MainThread]: 
[0m09:24:36.730121 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:24:36.730636 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:24:36.842868 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:24:36.843164 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:24:36.843348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:36.898894 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.055 seconds
[0m09:24:36.899925 [debug] [ThreadPool]: On list_postgres: Close
[0m09:24:36.900430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_bi_staging)
[0m09:24:36.900808 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "bi_staging"
"
[0m09:24:36.904741 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_staging"
[0m09:24:36.904990 [debug] [ThreadPool]: On create_postgres_bi_staging: BEGIN
[0m09:24:36.905180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:36.915009 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:24:36.915324 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_staging"
[0m09:24:36.915546 [debug] [ThreadPool]: On create_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "create_postgres_bi_staging"} */
create schema if not exists "bi_staging"
[0m09:24:36.926106 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.010 seconds
[0m09:24:36.926793 [debug] [ThreadPool]: On create_postgres_bi_staging: COMMIT
[0m09:24:36.927028 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_staging"
[0m09:24:36.927237 [debug] [ThreadPool]: On create_postgres_bi_staging: COMMIT
[0m09:24:36.937253 [debug] [ThreadPool]: SQL status: COMMIT in 0.010 seconds
[0m09:24:36.937489 [debug] [ThreadPool]: On create_postgres_bi_staging: Close
[0m09:24:36.938238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_bi_staging, now list_postgres_bi_staging)
[0m09:24:36.942856 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:24:36.943151 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:24:36.943351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:36.955172 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:24:36.955508 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:24:36.955750 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:24:36.997077 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.041 seconds
[0m09:24:36.998210 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:24:36.998934 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:24:37.002940 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.003332 [debug] [MainThread]: On master: BEGIN
[0m09:24:37.003589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:37.014195 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:24:37.014527 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.014839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:24:37.058128 [debug] [MainThread]: SQL status: SELECT 0 in 0.043 seconds
[0m09:24:37.059286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9da650>]}
[0m09:24:37.059717 [debug] [MainThread]: On master: ROLLBACK
[0m09:24:37.061272 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.061714 [debug] [MainThread]: On master: BEGIN
[0m09:24:37.063220 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:24:37.063510 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.063791 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.064049 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.064850 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:24:37.065138 [debug] [MainThread]: On master: Close
[0m09:24:37.077008 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:24:37.077691 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:24:37.078220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:24:37.078600 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:24:37.087272 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:24:37.088202 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:24:37.120367 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:24:37.121372 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:24:37.121623 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:24:37.121844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:37.139899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m09:24:37.140285 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:24:37.140665 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "dw"."igisbiz"."afndbascm"
),
fn as (
    select * from "dw"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:24:37.141656 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "dw.igisbiz.afndbascm"
LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                           ^

[0m09:24:37.142041 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:24:37.142583 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:24:37.154295 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:24:37.157248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198cb9d0>]}
[0m09:24:37.157778 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.08s]
[0m09:24:37.158192 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:24:37.158580 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:24:37.159774 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.160022 [debug] [MainThread]: On master: BEGIN
[0m09:24:37.160216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:37.174330 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:24:37.174668 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.174880 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.175074 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.175696 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:24:37.176043 [debug] [MainThread]: On master: Close
[0m09:24:37.176429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:37.176684 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:24:37.176919 [info ] [MainThread]: 
[0m09:24:37.177160 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m09:24:37.177632 [debug] [MainThread]: Command end result
[0m09:24:37.200939 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:24:37.202619 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:24:37.207532 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:24:37.207830 [info ] [MainThread]: 
[0m09:24:37.208089 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:24:37.208304 [info ] [MainThread]: 
[0m09:24:37.208555 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:24:37.208753 [info ] [MainThread]: 
[0m09:24:37.209366 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:24:37.211040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4475546, "process_in_blocks": "0", "process_kernel_time": 0.236021, "process_mem_max_rss": "133480448", "process_out_blocks": "0", "process_user_time": 1.8206}
[0m09:24:37.211379 [debug] [MainThread]: Command `dbt run` failed at 09:24:37.211318 after 2.45 seconds
[0m09:24:37.211654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118308ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abb72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db34b80>]}
[0m09:24:37.211903 [debug] [MainThread]: Flushing usage events
[0m09:24:38.060224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:48.269925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a21a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a22140>]}


============================== 09:32:48.274978 | 4b96db50-529c-4503-816f-9e3dc95b7ca2 ==============================
[0m09:32:48.274978 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:32:48.275333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:32:48.454240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7c520>]}
[0m09:32:48.486780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104552f50>]}
[0m09:32:48.487641 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:32:48.578421 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:32:48.754924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:32:48.755243 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:32:48.777780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106160130>]}
[0m09:32:48.825998 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:32:48.832506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:32:48.859929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f1c30>]}
[0m09:32:48.860311 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:32:48.860545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d3fa00>]}
[0m09:32:48.861520 [info ] [MainThread]: 
[0m09:32:48.861755 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:32:48.861934 [info ] [MainThread]: 
[0m09:32:48.862250 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:32:48.862734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:32:49.154810 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:32:49.155224 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:32:49.155496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:49.238578 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.083 seconds
[0m09:32:49.239680 [debug] [ThreadPool]: On list_postgres: Close
[0m09:32:49.240525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:32:49.245818 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:32:49.246121 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:32:49.246348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:49.259071 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:32:49.259424 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:32:49.259665 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:32:49.282522 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m09:32:49.283544 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:32:49.284604 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:32:49.288233 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.288575 [debug] [MainThread]: On master: BEGIN
[0m09:32:49.288803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:32:49.299321 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:32:49.299656 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.299967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:32:49.314160 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m09:32:49.315204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106183cd0>]}
[0m09:32:49.315616 [debug] [MainThread]: On master: ROLLBACK
[0m09:32:49.316238 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.316501 [debug] [MainThread]: On master: BEGIN
[0m09:32:49.317429 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:32:49.317773 [debug] [MainThread]: On master: COMMIT
[0m09:32:49.318058 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.318303 [debug] [MainThread]: On master: COMMIT
[0m09:32:49.318910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:32:49.319280 [debug] [MainThread]: On master: Close
[0m09:32:49.321673 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:32:49.322167 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:32:49.322546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:32:49.322841 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:32:49.329684 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:32:49.330499 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:32:49.359195 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:32:49.365649 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:32:49.365984 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:32:49.366202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:49.381797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:32:49.382143 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:32:49.382467 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "dw"."igisbiz"."afndbascm"
),
fn as (
    select * from "dw"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:32:49.383535 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "dw.igisbiz.afndbascm"
LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                           ^

[0m09:32:49.383871 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:32:49.384564 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:32:49.413968 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:32:49.415712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cb700>]}
[0m09:32:49.416246 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.09s]
[0m09:32:49.416673 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:32:49.417032 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:32:49.418307 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.418554 [debug] [MainThread]: On master: BEGIN
[0m09:32:49.418749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:32:49.432808 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:32:49.433192 [debug] [MainThread]: On master: COMMIT
[0m09:32:49.433421 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.433649 [debug] [MainThread]: On master: COMMIT
[0m09:32:49.434372 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:32:49.434799 [debug] [MainThread]: On master: Close
[0m09:32:49.435176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:49.435386 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:32:49.435610 [info ] [MainThread]: 
[0m09:32:49.435850 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m09:32:49.436303 [debug] [MainThread]: Command end result
[0m09:32:49.480807 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:32:49.482116 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:32:49.486437 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:32:49.486681 [info ] [MainThread]: 
[0m09:32:49.486927 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:32:49.487139 [info ] [MainThread]: 
[0m09:32:49.487376 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:32:49.487564 [info ] [MainThread]: 
[0m09:32:49.487756 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:32:49.494169 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.27839, "process_in_blocks": "0", "process_kernel_time": 0.300688, "process_mem_max_rss": "127090688", "process_out_blocks": "0", "process_user_time": 1.260434}
[0m09:32:49.494491 [debug] [MainThread]: Command `dbt run` failed at 09:32:49.494436 after 1.28 seconds
[0m09:32:49.494729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678a6b0>]}
[0m09:32:49.494948 [debug] [MainThread]: Flushing usage events
[0m09:32:50.429888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:20.743116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dc8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de59f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de6110>]}


============================== 09:34:20.747324 | 59f28542-bb11-4509-beaf-7908df8b5fbf ==============================
[0m09:34:20.747324 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:34:20.747667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:34:20.876966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112254880>]}
[0m09:34:20.912577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e6c700>]}
[0m09:34:20.913514 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:34:20.987167 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:34:21.103847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:34:21.104147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:34:21.127838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b10130>]}
[0m09:34:21.177229 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:34:21.180613 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:34:21.205416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa0cd0>]}
[0m09:34:21.205960 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:34:21.206278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa1030>]}
[0m09:34:21.207287 [info ] [MainThread]: 
[0m09:34:21.207518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:34:21.207688 [info ] [MainThread]: 
[0m09:34:21.207972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:34:21.208510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:34:21.341426 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:34:21.341755 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:34:21.341951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:21.397619 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.056 seconds
[0m09:34:21.398582 [debug] [ThreadPool]: On list_postgres: Close
[0m09:34:21.399288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:34:21.403687 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:34:21.403945 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:34:21.404119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:21.417184 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:34:21.417493 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:34:21.417704 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:34:21.436961 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m09:34:21.437844 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:34:21.438713 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:34:21.441893 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.442144 [debug] [MainThread]: On master: BEGIN
[0m09:34:21.442343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:34:21.452311 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:34:21.452641 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.452926 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:34:21.472661 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m09:34:21.473668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b32860>]}
[0m09:34:21.474047 [debug] [MainThread]: On master: ROLLBACK
[0m09:34:21.475076 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.475305 [debug] [MainThread]: On master: BEGIN
[0m09:34:21.476497 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:34:21.476717 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.476929 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.477130 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.477932 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:34:21.478148 [debug] [MainThread]: On master: Close
[0m09:34:21.480342 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:34:21.480776 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:34:21.481122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:34:21.481394 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:34:21.487836 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:34:21.488555 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:34:21.516908 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:34:21.518353 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:34:21.518579 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:34:21.518778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:21.533873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:34:21.534205 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:34:21.534523 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "dw"."igisbiz"."afndbascm"
),
fn as (
    select * from "dw"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:34:21.535344 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "dw.igisbiz.afndbascm"
LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                           ^

[0m09:34:21.535589 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:34:21.536078 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:34:21.541266 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:34:21.542779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dcba30>]}
[0m09:34:21.543252 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.06s]
[0m09:34:21.543629 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:34:21.543974 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:34:21.544900 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.545100 [debug] [MainThread]: On master: BEGIN
[0m09:34:21.545263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:34:21.558782 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:34:21.559208 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.559470 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.559649 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.560268 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:34:21.560577 [debug] [MainThread]: On master: Close
[0m09:34:21.560869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:21.561051 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:34:21.561250 [info ] [MainThread]: 
[0m09:34:21.561508 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m09:34:21.561956 [debug] [MainThread]: Command end result
[0m09:34:21.604709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:34:21.606284 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:34:21.610448 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:34:21.610688 [info ] [MainThread]: 
[0m09:34:21.610933 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:34:21.611132 [info ] [MainThread]: 
[0m09:34:21.611366 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:34:21.611568 [info ] [MainThread]: 
[0m09:34:21.611762 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:34:21.613767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9251252, "process_in_blocks": "0", "process_kernel_time": 0.241062, "process_mem_max_rss": "126205952", "process_out_blocks": "0", "process_user_time": 1.25674}
[0m09:34:21.614067 [debug] [MainThread]: Command `dbt run` failed at 09:34:21.614011 after 0.93 seconds
[0m09:34:21.614320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dc8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11303b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113039870>]}
[0m09:34:21.614557 [debug] [MainThread]: Flushing usage events
[0m09:34:22.437570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:35:10.258419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103734d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104441a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104442140>]}


============================== 09:35:10.262860 | 33912588-c1a8-40c9-820d-f0b450e998a3 ==============================
[0m09:35:10.262860 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:35:10.263228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:35:10.392340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048abaf0>]}
[0m09:35:10.425053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037fcf70>]}
[0m09:35:10.425978 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:35:10.518130 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:35:10.628234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:35:10.628787 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/schema.yml
[0m09:35:10.844827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105216260>]}
[0m09:35:10.923883 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:35:10.926973 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:35:10.943091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105319360>]}
[0m09:35:10.943460 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:35:10.943684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105318220>]}
[0m09:35:10.944585 [info ] [MainThread]: 
[0m09:35:10.944814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:35:10.944995 [info ] [MainThread]: 
[0m09:35:10.945296 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:35:10.945843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:35:11.275130 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:35:11.275858 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:35:11.276227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:11.410178 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.134 seconds
[0m09:35:11.411613 [debug] [ThreadPool]: On list_postgres: Close
[0m09:35:11.412721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:35:11.418553 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:35:11.418891 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:35:11.419133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:11.464348 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m09:35:11.464858 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:35:11.465223 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:35:11.514825 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.049 seconds
[0m09:35:11.516728 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:35:11.522035 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:35:11.528261 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.528863 [debug] [MainThread]: On master: BEGIN
[0m09:35:11.529235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:35:11.574807 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m09:35:11.575214 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.575534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:35:11.600407 [debug] [MainThread]: SQL status: SELECT 0 in 0.024 seconds
[0m09:35:11.602410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c5600>]}
[0m09:35:11.603118 [debug] [MainThread]: On master: ROLLBACK
[0m09:35:11.604255 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.604796 [debug] [MainThread]: On master: BEGIN
[0m09:35:11.606546 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:35:11.607025 [debug] [MainThread]: On master: COMMIT
[0m09:35:11.607467 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.607873 [debug] [MainThread]: On master: COMMIT
[0m09:35:11.609076 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:35:11.609694 [debug] [MainThread]: On master: Close
[0m09:35:11.613990 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:35:11.614778 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:35:11.615385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:35:11.615838 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:35:11.626990 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:35:11.628616 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:35:11.665115 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:35:11.666240 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:35:11.666590 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:35:11.666820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:11.681858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:35:11.682191 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:35:11.682545 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:35:11.684181 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column afn.frn_ccy_yn does not exist
LINE 119:     coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
                       ^

[0m09:35:11.684458 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:35:11.685051 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:35:11.696091 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column afn.frn_ccy_yn does not exist
  LINE 119:     coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
                         ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:35:11.697722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa3d90>]}
[0m09:35:11.698221 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.08s]
[0m09:35:11.698614 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:35:11.698953 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column afn.frn_ccy_yn does not exist
  LINE 119:     coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
                         ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:35:11.699917 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.700147 [debug] [MainThread]: On master: BEGIN
[0m09:35:11.700342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:35:11.713406 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:35:11.713730 [debug] [MainThread]: On master: COMMIT
[0m09:35:11.713929 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.714113 [debug] [MainThread]: On master: COMMIT
[0m09:35:11.714559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:35:11.714776 [debug] [MainThread]: On master: Close
[0m09:35:11.715073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:11.715341 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:35:11.715582 [info ] [MainThread]: 
[0m09:35:11.715806 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m09:35:11.716230 [debug] [MainThread]: Command end result
[0m09:35:11.730491 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:35:11.731832 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:35:11.736518 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:35:11.736724 [info ] [MainThread]: 
[0m09:35:11.736961 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:35:11.737159 [info ] [MainThread]: 
[0m09:35:11.737390 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column afn.frn_ccy_yn does not exist
  LINE 119:     coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
                         ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:35:11.737575 [info ] [MainThread]: 
[0m09:35:11.737769 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:35:11.739565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5407869, "process_in_blocks": "0", "process_kernel_time": 0.258839, "process_mem_max_rss": "130252800", "process_out_blocks": "0", "process_user_time": 1.458563}
[0m09:35:11.739822 [debug] [MainThread]: Command `dbt run` failed at 09:35:11.739772 after 1.54 seconds
[0m09:35:11.740056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103734d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101df86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516f340>]}
[0m09:35:11.740278 [debug] [MainThread]: Flushing usage events
[0m09:35:12.588197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:46.146787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106408c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e1930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e2050>]}


============================== 09:37:46.152410 | 46f09221-980a-43b0-9ec9-bf5b1ee7978f ==============================
[0m09:37:46.152410 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:37:46.152887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:37:46.291211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107690550>]}
[0m09:37:46.328667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064adfc0>]}
[0m09:37:46.329786 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:37:46.404928 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:37:46.560084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:37:46.560677 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:37:46.719534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200e0040>]}
[0m09:37:46.767812 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:37:46.770727 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:37:46.805964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200d7670>]}
[0m09:37:46.806371 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:37:46.806617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200d7610>]}
[0m09:37:46.807695 [info ] [MainThread]: 
[0m09:37:46.807968 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:37:46.808154 [info ] [MainThread]: 
[0m09:37:46.808473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:37:46.809017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:37:47.150112 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:37:47.150449 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:37:47.150660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:47.190688 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.040 seconds
[0m09:37:47.191629 [debug] [ThreadPool]: On list_postgres: Close
[0m09:37:47.192338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:37:47.196442 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:37:47.196744 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:37:47.196931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:47.209231 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:37:47.209585 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:37:47.209806 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:37:47.219836 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m09:37:47.220728 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:37:47.221509 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:37:47.224592 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.224908 [debug] [MainThread]: On master: BEGIN
[0m09:37:47.225103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:37:47.234133 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:37:47.234464 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.234723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:37:47.243725 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m09:37:47.244604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea3550>]}
[0m09:37:47.244935 [debug] [MainThread]: On master: ROLLBACK
[0m09:37:47.246398 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.246779 [debug] [MainThread]: On master: BEGIN
[0m09:37:47.247614 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:37:47.247857 [debug] [MainThread]: On master: COMMIT
[0m09:37:47.248061 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.248241 [debug] [MainThread]: On master: COMMIT
[0m09:37:47.248677 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:37:47.248909 [debug] [MainThread]: On master: Close
[0m09:37:47.251537 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:37:47.251947 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:37:47.252305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:37:47.252629 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:37:47.258432 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:37:47.259760 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:37:47.288667 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:37:47.289608 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:37:47.289946 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:37:47.290179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:47.303921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m09:37:47.304293 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:37:47.304616 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    -- coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
    'N' as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:37:47.314920 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "multi_clas_cls" specified more than once

[0m09:37:47.315309 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:37:47.315997 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:37:47.330858 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "multi_clas_cls" specified more than once
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:37:47.336975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ca530>]}
[0m09:37:47.337543 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.08s]
[0m09:37:47.337934 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:37:47.338284 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "multi_clas_cls" specified more than once
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:37:47.339266 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.339475 [debug] [MainThread]: On master: BEGIN
[0m09:37:47.339654 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:37:47.349179 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:37:47.349529 [debug] [MainThread]: On master: COMMIT
[0m09:37:47.349747 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.349934 [debug] [MainThread]: On master: COMMIT
[0m09:37:47.350445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:37:47.350724 [debug] [MainThread]: On master: Close
[0m09:37:47.351045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:47.351247 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:37:47.351565 [info ] [MainThread]: 
[0m09:37:47.351881 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m09:37:47.352329 [debug] [MainThread]: Command end result
[0m09:37:47.366389 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:37:47.367985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:37:47.373115 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:37:47.373410 [info ] [MainThread]: 
[0m09:37:47.373665 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:37:47.373872 [info ] [MainThread]: 
[0m09:37:47.374111 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "multi_clas_cls" specified more than once
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:37:47.374384 [info ] [MainThread]: 
[0m09:37:47.374642 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:37:47.384866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3126603, "process_in_blocks": "0", "process_kernel_time": 0.254336, "process_mem_max_rss": "130039808", "process_out_blocks": "0", "process_user_time": 1.415987}
[0m09:37:47.385259 [debug] [MainThread]: Command `dbt run` failed at 09:37:47.385198 after 1.31 seconds
[0m09:37:47.385520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106408c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120110580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e2980>]}
[0m09:37:47.385759 [debug] [MainThread]: Flushing usage events
[0m09:37:48.194944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:09.625793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112808ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113722c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137233a0>]}


============================== 09:38:09.631717 | 3360effa-da04-4a64-83d8-3dc79c2bf126 ==============================
[0m09:38:09.631717 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:38:09.632099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:38:09.771727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11429afb0>]}
[0m09:38:09.804070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142c32e0>]}
[0m09:38:09.804898 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:38:09.886478 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:38:09.994229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:38:09.994673 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:38:10.147796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b6fc40>]}
[0m09:38:10.194715 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:38:10.199311 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:38:10.218889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cb72e0>]}
[0m09:38:10.219276 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:38:10.219506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cb73a0>]}
[0m09:38:10.220550 [info ] [MainThread]: 
[0m09:38:10.220809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:38:10.220992 [info ] [MainThread]: 
[0m09:38:10.221309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:38:10.221849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:38:10.330650 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:38:10.330980 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:38:10.331177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:10.375235 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.044 seconds
[0m09:38:10.376141 [debug] [ThreadPool]: On list_postgres: Close
[0m09:38:10.376870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:38:10.380908 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:38:10.381199 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:38:10.381374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:10.391913 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:38:10.392246 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:38:10.392453 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:38:10.407439 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m09:38:10.408292 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:38:10.412635 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:38:10.415235 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.415446 [debug] [MainThread]: On master: BEGIN
[0m09:38:10.415614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:38:10.425578 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:38:10.425912 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.426208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:38:10.435002 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m09:38:10.435886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b2a830>]}
[0m09:38:10.436234 [debug] [MainThread]: On master: ROLLBACK
[0m09:38:10.436801 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.437065 [debug] [MainThread]: On master: BEGIN
[0m09:38:10.437828 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:38:10.438051 [debug] [MainThread]: On master: COMMIT
[0m09:38:10.438251 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.438434 [debug] [MainThread]: On master: COMMIT
[0m09:38:10.438903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:10.439142 [debug] [MainThread]: On master: Close
[0m09:38:10.441550 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:38:10.441964 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:38:10.442294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:38:10.442542 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:38:10.448499 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.449166 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:38:10.476674 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.479455 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.479680 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:38:10.479876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:10.491487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:38:10.491805 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.492129 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    -- coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
    'N' as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:38:10.546485 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 0.054 seconds
[0m09:38:10.554386 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.554733 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m09:38:10.555994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:10.566461 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:38:10.566923 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.567300 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:38:10.571754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:38:10.576458 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m09:38:10.579535 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.579816 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m09:38:10.580547 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:38:10.582270 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:38:10.583756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119825f0>]}
[0m09:38:10.584322 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 0.14s]
[0m09:38:10.584782 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:38:10.585534 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.585823 [debug] [MainThread]: On master: BEGIN
[0m09:38:10.586019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:38:10.598958 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:38:10.599324 [debug] [MainThread]: On master: COMMIT
[0m09:38:10.599536 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.599724 [debug] [MainThread]: On master: COMMIT
[0m09:38:10.600287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:10.600552 [debug] [MainThread]: On master: Close
[0m09:38:10.600939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:10.601184 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:38:10.601420 [info ] [MainThread]: 
[0m09:38:10.601651 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m09:38:10.602080 [debug] [MainThread]: Command end result
[0m09:38:10.615896 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:38:10.618520 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:38:10.622963 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:38:10.623253 [info ] [MainThread]: 
[0m09:38:10.623523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:38:10.623717 [info ] [MainThread]: 
[0m09:38:10.623920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:38:10.631084 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.05738, "process_in_blocks": "0", "process_kernel_time": 0.235457, "process_mem_max_rss": "129171456", "process_out_blocks": "0", "process_user_time": 1.367241}
[0m09:38:10.631413 [debug] [MainThread]: Command `dbt run` succeeded at 09:38:10.631355 after 1.06 seconds
[0m09:38:10.631662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112808ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128beef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11429a770>]}
[0m09:38:10.631897 [debug] [MainThread]: Flushing usage events
[0m09:38:11.458650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:40:18.171601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7b0a0>]}


============================== 09:40:18.175835 | 22ac461f-4504-4564-afac-6f023351382b ==============================
[0m09:40:18.175835 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:40:18.176213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:40:18.314467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e6fb0>]}
[0m09:40:18.348143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730f2e0>]}
[0m09:40:18.349051 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:40:18.432037 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:40:18.555183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:40:18.555622 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:40:18.710482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcbc40>]}
[0m09:40:18.757273 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:40:18.760224 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:40:18.776341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3b2e0>]}
[0m09:40:18.776667 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:40:18.776882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3b3a0>]}
[0m09:40:18.777832 [info ] [MainThread]: 
[0m09:40:18.778046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:40:18.778221 [info ] [MainThread]: 
[0m09:40:18.778517 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:40:18.779006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:40:18.901604 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:40:18.901938 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:40:18.902124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:40:18.949963 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.048 seconds
[0m09:40:18.950886 [debug] [ThreadPool]: On list_postgres: Close
[0m09:40:18.951544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:40:18.955461 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:40:18.955694 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:40:18.955866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:40:18.965370 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:40:18.965636 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:40:18.965826 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:40:18.977757 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m09:40:18.978580 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:40:18.979588 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:40:18.982359 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:18.982588 [debug] [MainThread]: On master: BEGIN
[0m09:40:18.982779 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:40:18.992600 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:40:18.992867 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:18.993106 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:40:19.041948 [debug] [MainThread]: SQL status: SELECT 0 in 0.049 seconds
[0m09:40:19.043426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3b880>]}
[0m09:40:19.043767 [debug] [MainThread]: On master: ROLLBACK
[0m09:40:19.044756 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:19.044945 [debug] [MainThread]: On master: BEGIN
[0m09:40:19.046066 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:40:19.046285 [debug] [MainThread]: On master: COMMIT
[0m09:40:19.046469 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:19.046634 [debug] [MainThread]: On master: COMMIT
[0m09:40:19.047318 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:40:19.047546 [debug] [MainThread]: On master: Close
[0m09:40:19.049380 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:40:19.049731 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:40:19.050029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:40:19.050251 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:40:19.055769 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:40:19.056456 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:40:19.084065 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:40:19.087418 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:40:19.087659 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:40:19.087870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:19.100076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:40:19.100451 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:40:19.100767 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn.FUND_CD is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn.FUND_CD
  );
  
[0m09:40:19.102379 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column mtfn.fund_cd does not exist
LINE 135:     on afn.FUND_CD = mtfn.FUND_CD
                               ^
HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".

[0m09:40:19.102709 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:40:19.103267 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:40:19.129567 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 135:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:40:19.131054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d65f0>]}
[0m09:40:19.131528 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.08s]
[0m09:40:19.131894 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:40:19.132250 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 135:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:40:19.133264 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:19.133498 [debug] [MainThread]: On master: BEGIN
[0m09:40:19.133685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:40:19.147675 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:40:19.148008 [debug] [MainThread]: On master: COMMIT
[0m09:40:19.148205 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:19.148377 [debug] [MainThread]: On master: COMMIT
[0m09:40:19.148849 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:40:19.149165 [debug] [MainThread]: On master: Close
[0m09:40:19.149471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:40:19.149655 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:40:19.149852 [info ] [MainThread]: 
[0m09:40:19.150058 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m09:40:19.150530 [debug] [MainThread]: Command end result
[0m09:40:19.164408 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:40:19.165715 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:40:19.169999 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:40:19.170267 [info ] [MainThread]: 
[0m09:40:19.170522 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:40:19.170729 [info ] [MainThread]: 
[0m09:40:19.170967 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 135:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:40:19.171160 [info ] [MainThread]: 
[0m09:40:19.171356 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:40:19.172955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0557215, "process_in_blocks": "0", "process_kernel_time": 0.223081, "process_mem_max_rss": "129957888", "process_out_blocks": "0", "process_user_time": 1.3477}
[0m09:40:19.173233 [debug] [MainThread]: Command `dbt run` failed at 09:40:19.173179 after 1.06 seconds
[0m09:40:19.173496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106908c10>]}
[0m09:40:19.173729 [debug] [MainThread]: Flushing usage events
[0m09:40:20.036759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:50:03.770584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e59f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e6110>]}


============================== 09:50:03.774873 | 7c505daf-41c8-4486-b998-960ba6f08dd7 ==============================
[0m09:50:03.774873 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:50:03.775232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:50:03.956968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795cfa0>]}
[0m09:50:03.990707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cb910>]}
[0m09:50:03.991666 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:50:04.081514 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:50:04.257095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:50:04.257529 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:50:04.407734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096dc100>]}
[0m09:50:04.456472 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:50:04.465251 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:50:04.491275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109707f40>]}
[0m09:50:04.491624 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:50:04.491850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109705bd0>]}
[0m09:50:04.492853 [info ] [MainThread]: 
[0m09:50:04.493100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:50:04.493324 [info ] [MainThread]: 
[0m09:50:04.493730 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:50:04.494249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:50:04.825960 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:50:04.826358 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:50:04.826604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:04.957816 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.131 seconds
[0m09:50:04.959019 [debug] [ThreadPool]: On list_postgres: Close
[0m09:50:04.959940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:50:04.965268 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:50:04.965671 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:50:04.965965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:04.982715 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:50:04.983131 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:50:04.983428 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:50:05.021628 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.038 seconds
[0m09:50:05.022966 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:50:05.024004 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:50:05.028311 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.028696 [debug] [MainThread]: On master: BEGIN
[0m09:50:05.028976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:05.046058 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m09:50:05.046480 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.046839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:50:05.060521 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m09:50:05.062554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c2f20>]}
[0m09:50:05.063035 [debug] [MainThread]: On master: ROLLBACK
[0m09:50:05.063912 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.064337 [debug] [MainThread]: On master: BEGIN
[0m09:50:05.065330 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:50:05.065751 [debug] [MainThread]: On master: COMMIT
[0m09:50:05.066064 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.066344 [debug] [MainThread]: On master: COMMIT
[0m09:50:05.067037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:50:05.067363 [debug] [MainThread]: On master: Close
[0m09:50:05.069935 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:50:05.070457 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:50:05.070924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:50:05.071328 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:50:05.079696 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:50:05.080703 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:50:05.112620 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:50:05.113472 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:50:05.113709 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:50:05.113918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:05.130035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:50:05.130382 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:50:05.130733 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct FUND_CD from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn.FUND_CD is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn.FUND_CD
  );
  
[0m09:50:05.132025 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fund_cd" does not exist
LINE 19:     select distinct FUND_CD from "postgres"."igisam"."mtfn"
                             ^

[0m09:50:05.132292 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:50:05.132825 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:50:05.157668 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "fund_cd" does not exist
  LINE 19:     select distinct FUND_CD from "postgres"."igisam"."mtfn"
                               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:50:05.159305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107537d90>]}
[0m09:50:05.159790 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.09s]
[0m09:50:05.160191 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:50:05.160532 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "fund_cd" does not exist
  LINE 19:     select distinct FUND_CD from "postgres"."igisam"."mtfn"
                               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:50:05.161564 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.161802 [debug] [MainThread]: On master: BEGIN
[0m09:50:05.162003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:50:05.175901 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:50:05.176277 [debug] [MainThread]: On master: COMMIT
[0m09:50:05.176493 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.176701 [debug] [MainThread]: On master: COMMIT
[0m09:50:05.177214 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:50:05.177583 [debug] [MainThread]: On master: Close
[0m09:50:05.177923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:05.178130 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:50:05.178354 [info ] [MainThread]: 
[0m09:50:05.178580 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m09:50:05.179022 [debug] [MainThread]: Command end result
[0m09:50:05.193413 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:50:05.196532 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:50:05.200528 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:50:05.200735 [info ] [MainThread]: 
[0m09:50:05.200979 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:50:05.201182 [info ] [MainThread]: 
[0m09:50:05.201648 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "fund_cd" does not exist
  LINE 19:     select distinct FUND_CD from "postgres"."igisam"."mtfn"
                               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:50:05.201902 [info ] [MainThread]: 
[0m09:50:05.202128 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:50:05.264105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5508816, "process_in_blocks": "0", "process_kernel_time": 0.282675, "process_mem_max_rss": "130416640", "process_out_blocks": "0", "process_user_time": 1.413983}
[0m09:50:05.264540 [debug] [MainThread]: Command `dbt run` failed at 09:50:05.264470 after 1.55 seconds
[0m09:50:05.264849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ac4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a316c0>]}
[0m09:50:05.265123 [debug] [MainThread]: Flushing usage events
[0m09:50:06.116465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:07.647053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103578d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042899f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428a110>]}


============================== 09:52:07.653882 | 9fa69073-deb9-4edf-a236-eeafbffd4c07 ==============================
[0m09:52:07.653882 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:52:07.654370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:52:07.780509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104718880>]}
[0m09:52:07.813181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103620700>]}
[0m09:52:07.814109 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:52:07.895836 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:52:08.010846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:52:08.011272 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:52:08.161227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e00a0>]}
[0m09:52:08.209122 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:52:08.212487 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:52:08.230759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058058a0>]}
[0m09:52:08.231075 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:52:08.231300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105993c40>]}
[0m09:52:08.232290 [info ] [MainThread]: 
[0m09:52:08.232520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:08.232697 [info ] [MainThread]: 
[0m09:52:08.233002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:52:08.233508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:52:08.365942 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:52:08.366253 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:52:08.366437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:08.414678 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.048 seconds
[0m09:52:08.415586 [debug] [ThreadPool]: On list_postgres: Close
[0m09:52:08.416223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:52:08.420116 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:52:08.420334 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:52:08.420514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:08.429486 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:52:08.429797 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:52:08.430014 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:52:08.446747 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m09:52:08.447677 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:52:08.452258 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:52:08.455409 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.455685 [debug] [MainThread]: On master: BEGIN
[0m09:52:08.455890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:08.464999 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:52:08.465315 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.465605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:52:08.478955 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m09:52:08.480403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105892e60>]}
[0m09:52:08.480746 [debug] [MainThread]: On master: ROLLBACK
[0m09:52:08.481321 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.481571 [debug] [MainThread]: On master: BEGIN
[0m09:52:08.482245 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:52:08.482465 [debug] [MainThread]: On master: COMMIT
[0m09:52:08.482672 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.482863 [debug] [MainThread]: On master: COMMIT
[0m09:52:08.483329 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:08.483548 [debug] [MainThread]: On master: Close
[0m09:52:08.486231 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:52:08.486625 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:52:08.486954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:52:08.487203 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:52:08.493891 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:52:08.494624 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:52:08.521995 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:52:08.522674 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:52:08.522900 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:52:08.523102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:08.537721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:52:08.538082 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:52:08.538408 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn.FUND_CD is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn.FUND_CD
  );
  
[0m09:52:08.540267 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column mtfn.fund_cd does not exist
LINE 138:     on afn.FUND_CD = mtfn.FUND_CD
                               ^
HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".

[0m09:52:08.540634 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:52:08.541343 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:52:08.548702 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 138:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:52:08.551413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de6b30>]}
[0m09:52:08.551844 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.06s]
[0m09:52:08.552209 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:52:08.552540 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 138:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:52:08.553431 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.553631 [debug] [MainThread]: On master: BEGIN
[0m09:52:08.553801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:08.565395 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:52:08.565702 [debug] [MainThread]: On master: COMMIT
[0m09:52:08.565889 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.566060 [debug] [MainThread]: On master: COMMIT
[0m09:52:08.566520 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:08.566822 [debug] [MainThread]: On master: Close
[0m09:52:08.567111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:08.567294 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:52:08.567489 [info ] [MainThread]: 
[0m09:52:08.567697 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m09:52:08.568114 [debug] [MainThread]: Command end result
[0m09:52:08.581661 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:52:08.589626 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:52:08.594033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:52:08.594298 [info ] [MainThread]: 
[0m09:52:08.594571 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:52:08.594786 [info ] [MainThread]: 
[0m09:52:08.595027 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 138:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:52:08.595226 [info ] [MainThread]: 
[0m09:52:08.595420 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:52:08.597245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0114151, "process_in_blocks": "0", "process_kernel_time": 0.231436, "process_mem_max_rss": "130662400", "process_out_blocks": "0", "process_user_time": 1.349929}
[0m09:52:08.597559 [debug] [MainThread]: Command `dbt run` failed at 09:52:08.597499 after 1.01 seconds
[0m09:52:08.597810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103578d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036e4c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4bc40>]}
[0m09:52:08.598046 [debug] [MainThread]: Flushing usage events
[0m09:52:09.417839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:20.673550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a08cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097219c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097220e0>]}


============================== 09:53:20.686513 | 5b85dba9-7eff-459f-b769-4d7492cf4053 ==============================
[0m09:53:20.686513 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:53:20.686889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'profiles_dir': '/Users/goonzardw/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:53:20.881986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967a2c0>]}
[0m09:53:20.917006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e48e0>]}
[0m09:53:20.923664 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:53:21.056686 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:53:21.332927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:21.333470 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:53:21.484977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7dc0d0>]}
[0m09:53:21.534657 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:53:21.541079 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:53:21.634814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d3340>]}
[0m09:53:21.635306 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:53:21.635608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d33d0>]}
[0m09:53:21.636947 [info ] [MainThread]: 
[0m09:53:21.637256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:53:21.637497 [info ] [MainThread]: 
[0m09:53:21.637886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:21.638544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:53:22.963488 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:53:22.963818 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:53:22.964018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:23.025272 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.061 seconds
[0m09:53:23.026393 [debug] [ThreadPool]: On list_postgres: Close
[0m09:53:23.027273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:53:23.032177 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:53:23.032550 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:53:23.032803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:23.050167 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:53:23.050516 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:53:23.050757 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:53:23.058463 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m09:53:23.059381 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:53:23.059971 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:53:23.063210 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.063494 [debug] [MainThread]: On master: BEGIN
[0m09:53:23.063689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:23.073576 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:53:23.073901 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.074168 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:23.083514 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m09:53:23.084935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d20e0>]}
[0m09:53:23.085282 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:23.089663 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.089996 [debug] [MainThread]: On master: BEGIN
[0m09:53:23.090817 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:53:23.091065 [debug] [MainThread]: On master: COMMIT
[0m09:53:23.091267 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.091448 [debug] [MainThread]: On master: COMMIT
[0m09:53:23.092276 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:53:23.092486 [debug] [MainThread]: On master: Close
[0m09:53:23.096666 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:53:23.097065 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:53:23.097377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:53:23.097601 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:53:23.103434 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:53:23.107129 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:53:23.134199 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:53:23.140074 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:23.140341 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:53:23.140550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:23.158899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m09:53:23.159301 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:23.159662 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn.FUND_CD is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m09:53:23.161451 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column mtfn.fund_cd does not exist
LINE 123:         when mtfn.FUND_CD is not null then 'Y'
                       ^
HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".

[0m09:53:23.161740 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:53:23.162360 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:53:23.183447 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 123:         when mtfn.FUND_CD is not null then 'Y'
                         ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:53:23.188886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e5990>]}
[0m09:53:23.189452 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.09s]
[0m09:53:23.189872 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:53:23.190383 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 123:         when mtfn.FUND_CD is not null then 'Y'
                         ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:53:23.191658 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.191965 [debug] [MainThread]: On master: BEGIN
[0m09:53:23.192180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:23.211320 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m09:53:23.211712 [debug] [MainThread]: On master: COMMIT
[0m09:53:23.211940 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.212145 [debug] [MainThread]: On master: COMMIT
[0m09:53:23.212649 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:53:23.212923 [debug] [MainThread]: On master: Close
[0m09:53:23.213249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:23.213453 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:53:23.213674 [info ] [MainThread]: 
[0m09:53:23.213902 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m09:53:23.214373 [debug] [MainThread]: Command end result
[0m09:53:23.231094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:53:23.232716 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:53:23.241379 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:53:23.241625 [info ] [MainThread]: 
[0m09:53:23.241891 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:53:23.242106 [info ] [MainThread]: 
[0m09:53:23.242355 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 123:         when mtfn.FUND_CD is not null then 'Y'
                         ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:53:23.242556 [info ] [MainThread]: 
[0m09:53:23.242763 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:53:23.245879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6528895, "process_in_blocks": "0", "process_kernel_time": 0.414593, "process_mem_max_rss": "131678208", "process_out_blocks": "0", "process_user_time": 1.688443}
[0m09:53:23.246242 [debug] [MainThread]: Command `dbt run` failed at 09:53:23.246182 after 2.65 seconds
[0m09:53:23.246520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a08cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b74d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a791c30>]}
[0m09:53:23.246773 [debug] [MainThread]: Flushing usage events
[0m09:53:24.092451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:33.425081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105908cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071159c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071160e0>]}


============================== 09:53:33.429078 | e9512e80-4a7d-45a3-805b-369a7b630ccb ==============================
[0m09:53:33.429078 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:53:33.429435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:53:33.547051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707a2c0>]}
[0m09:53:33.580574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107389540>]}
[0m09:53:33.581565 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:53:33.652628 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:53:33.768654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:33.769079 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:53:33.918416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eec0d0>]}
[0m09:53:33.964568 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:53:33.967599 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:53:33.985206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee3340>]}
[0m09:53:33.985531 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:53:33.985757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee33d0>]}
[0m09:53:33.986720 [info ] [MainThread]: 
[0m09:53:33.986931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:53:33.987109 [info ] [MainThread]: 
[0m09:53:33.987401 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:33.987883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:53:34.103249 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:53:34.103558 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:53:34.103740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:34.142174 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.038 seconds
[0m09:53:34.143146 [debug] [ThreadPool]: On list_postgres: Close
[0m09:53:34.143842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:53:34.148055 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:53:34.148313 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:53:34.148507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:34.162026 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:53:34.162308 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:53:34.162530 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:53:34.178118 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m09:53:34.179245 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:53:34.180185 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:53:34.183590 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.183867 [debug] [MainThread]: On master: BEGIN
[0m09:53:34.184082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:34.197926 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:53:34.198275 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.198578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:34.212355 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m09:53:34.213839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee33d0>]}
[0m09:53:34.214205 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:34.215172 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.215397 [debug] [MainThread]: On master: BEGIN
[0m09:53:34.216420 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:53:34.216639 [debug] [MainThread]: On master: COMMIT
[0m09:53:34.216855 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.217056 [debug] [MainThread]: On master: COMMIT
[0m09:53:34.217811 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:53:34.218024 [debug] [MainThread]: On master: Close
[0m09:53:34.222770 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:53:34.223225 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:53:34.223611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:53:34.223893 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:53:34.230791 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.231592 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:53:34.259591 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.260253 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.260494 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:53:34.260714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:34.276363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:53:34.276660 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.276980 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m09:53:34.369966 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 0.093 seconds
[0m09:53:34.379427 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.379831 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m09:53:34.380889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:34.383519 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.383857 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m09:53:34.384935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:34.398494 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:53:34.398925 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.399199 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:53:34.402894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:53:34.408513 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m09:53:34.411514 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.411801 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m09:53:34.420309 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m09:53:34.422361 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:53:34.423766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a08190>]}
[0m09:53:34.424293 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 0.20s]
[0m09:53:34.424719 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:53:34.425588 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.425827 [debug] [MainThread]: On master: BEGIN
[0m09:53:34.426025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:34.435154 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:53:34.435520 [debug] [MainThread]: On master: COMMIT
[0m09:53:34.435733 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.435925 [debug] [MainThread]: On master: COMMIT
[0m09:53:34.436417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:53:34.436739 [debug] [MainThread]: On master: Close
[0m09:53:34.437051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:34.437241 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:53:34.437443 [info ] [MainThread]: 
[0m09:53:34.437652 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m09:53:34.438057 [debug] [MainThread]: Command end result
[0m09:53:34.451541 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:53:34.458368 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:53:34.463025 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:53:34.463276 [info ] [MainThread]: 
[0m09:53:34.463546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:53:34.463740 [info ] [MainThread]: 
[0m09:53:34.463942 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:53:34.465177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0910641, "process_in_blocks": "0", "process_kernel_time": 0.20646, "process_mem_max_rss": "129695744", "process_out_blocks": "0", "process_user_time": 1.380888}
[0m09:53:34.465437 [debug] [MainThread]: Command `dbt run` succeeded at 09:53:34.465383 after 1.09 seconds
[0m09:53:34.465675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105908cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8fc10>]}
[0m09:53:34.465906 [debug] [MainThread]: Flushing usage events
[0m09:53:35.309764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:20.769608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ce59f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ce6110>]}


============================== 09:55:20.773987 | eb056a69-6074-4855-9e42-3145b6e92a9c ==============================
[0m09:55:20.773987 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:55:20.774340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:55:20.902015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119154880>]}
[0m09:55:20.934745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e40700>]}
[0m09:55:20.935670 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:55:21.012286 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:55:21.068491 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:55:21.068881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187a5600>]}
[0m09:55:21.742912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a885060>]}
[0m09:55:21.788646 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:55:21.791719 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:55:21.810895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c0a6e0>]}
[0m09:55:21.811214 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:55:21.811429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715d270>]}
[0m09:55:21.812368 [info ] [MainThread]: 
[0m09:55:21.812587 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:21.812764 [info ] [MainThread]: 
[0m09:55:21.813056 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:55:21.813536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:55:21.900304 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:55:21.900629 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:55:21.900823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:21.941957 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.041 seconds
[0m09:55:21.942861 [debug] [ThreadPool]: On list_postgres: Close
[0m09:55:21.943532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:55:21.947467 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:55:21.947706 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:55:21.947888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:21.958454 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:55:21.958786 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:55:21.959002 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:55:21.979530 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m09:55:21.980449 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:55:21.980985 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:55:21.984336 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:21.984624 [debug] [MainThread]: On master: BEGIN
[0m09:55:21.984829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:21.997768 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:55:21.998088 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:21.998382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:55:22.006190 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m09:55:22.007584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c0b700>]}
[0m09:55:22.007930 [debug] [MainThread]: On master: ROLLBACK
[0m09:55:22.008498 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:22.008712 [debug] [MainThread]: On master: BEGIN
[0m09:55:22.009414 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:55:22.009621 [debug] [MainThread]: On master: COMMIT
[0m09:55:22.009817 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:22.010003 [debug] [MainThread]: On master: COMMIT
[0m09:55:22.010451 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:55:22.010698 [debug] [MainThread]: On master: Close
[0m09:55:22.013334 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:55:22.013722 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:55:22.014048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:55:22.014288 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:55:22.020823 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.021570 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:55:22.048827 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.049746 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.050126 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:55:22.050353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:22.065526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:55:22.065951 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.066309 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m09:55:22.157002 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 0.090 seconds
[0m09:55:22.164393 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.164748 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m09:55:22.165621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:55:22.167911 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.168195 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m09:55:22.169170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:55:22.180208 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:55:22.180550 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.180789 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:55:22.185110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:55:22.190028 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m09:55:22.192798 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.193065 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m09:55:22.198962 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m09:55:22.200769 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:55:22.202222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e8700>]}
[0m09:55:22.202737 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 0.19s]
[0m09:55:22.203127 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:55:22.203830 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:22.204047 [debug] [MainThread]: On master: BEGIN
[0m09:55:22.204231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:22.215973 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:55:22.216331 [debug] [MainThread]: On master: COMMIT
[0m09:55:22.216536 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:22.216717 [debug] [MainThread]: On master: COMMIT
[0m09:55:22.217224 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:55:22.217559 [debug] [MainThread]: On master: Close
[0m09:55:22.217885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:22.218084 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:55:22.218302 [info ] [MainThread]: 
[0m09:55:22.218517 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m09:55:22.218922 [debug] [MainThread]: Command end result
[0m09:55:22.249194 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:55:22.251073 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:55:22.255161 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:55:22.255416 [info ] [MainThread]: 
[0m09:55:22.255692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:55:22.255889 [info ] [MainThread]: 
[0m09:55:22.256083 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:55:22.257744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5506041, "process_in_blocks": "0", "process_kernel_time": 0.232094, "process_mem_max_rss": "133070848", "process_out_blocks": "0", "process_user_time": 1.804252}
[0m09:55:22.258035 [debug] [MainThread]: Command `dbt run` succeeded at 09:55:22.257979 after 1.55 seconds
[0m09:55:22.258291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e40700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c08430>]}
[0m09:55:22.258516 [debug] [MainThread]: Flushing usage events
[0m09:55:23.239554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:14.140569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee5a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee6140>]}


============================== 10:34:14.145727 | 7a40f67d-a598-4a3a-ba2e-ad1532ee42a3 ==============================
[0m10:34:14.145727 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:34:14.146132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:34:14.394942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109328520>]}
[0m10:34:14.430508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108912f50>]}
[0m10:34:14.431474 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:34:14.559484 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:34:14.896860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m10:34:14.897491 [debug] [MainThread]: Partial parsing: added file: fund_dbt_project://macros/code_name.sql
[0m10:34:14.898012 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/schema.yml
[0m10:34:14.898426 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m10:34:15.129596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd40a0>]}
[0m10:34:15.213827 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:34:15.227409 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:34:15.304945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00aef0>]}
[0m10:34:15.305489 [info ] [MainThread]: Found 1 model, 4 sources, 434 macros
[0m10:34:15.305777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065488e0>]}
[0m10:34:15.307123 [info ] [MainThread]: 
[0m10:34:15.307483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:34:15.307717 [info ] [MainThread]: 
[0m10:34:15.308083 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:34:15.308725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:34:16.485771 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:34:16.486167 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:34:16.486427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:16.735006 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.248 seconds
[0m10:34:16.736224 [debug] [ThreadPool]: On list_postgres: Close
[0m10:34:16.737144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m10:34:16.742756 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:34:16.743141 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m10:34:16.743401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:34:16.761329 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m10:34:16.761747 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:34:16.762046 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m10:34:16.789228 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.027 seconds
[0m10:34:16.790688 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m10:34:16.791732 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m10:34:16.796422 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:16.796803 [debug] [MainThread]: On master: BEGIN
[0m10:34:16.797061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:16.813502 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:34:16.813911 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:16.814391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:34:16.892072 [debug] [MainThread]: SQL status: SELECT 0 in 0.077 seconds
[0m10:34:16.893149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a038be0>]}
[0m10:34:16.893505 [debug] [MainThread]: On master: ROLLBACK
[0m10:34:16.894437 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:16.894806 [debug] [MainThread]: On master: BEGIN
[0m10:34:16.897102 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:34:16.897436 [debug] [MainThread]: On master: COMMIT
[0m10:34:16.897666 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:16.897860 [debug] [MainThread]: On master: COMMIT
[0m10:34:16.901350 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:34:16.901597 [debug] [MainThread]: On master: Close
[0m10:34:16.927689 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m10:34:16.928155 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m10:34:16.928541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m10:34:16.928833 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m10:34:17.000633 [debug] [Thread-1 (]: Compilation Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  'afn' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:34:17.004844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2bdf0>]}
[0m10:34:17.005729 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.07s]
[0m10:34:17.006604 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m10:34:17.007516 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  'afn' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m10:34:17.009901 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:17.010334 [debug] [MainThread]: On master: BEGIN
[0m10:34:17.010660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:34:17.035489 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m10:34:17.036107 [debug] [MainThread]: On master: COMMIT
[0m10:34:17.036506 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:17.036859 [debug] [MainThread]: On master: COMMIT
[0m10:34:17.037737 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:34:17.038315 [debug] [MainThread]: On master: Close
[0m10:34:17.038879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:17.039251 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m10:34:17.039716 [info ] [MainThread]: 
[0m10:34:17.040258 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m10:34:17.041175 [debug] [MainThread]: Command end result
[0m10:34:17.064066 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:34:17.068896 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:34:17.077049 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m10:34:17.077415 [info ] [MainThread]: 
[0m10:34:17.077760 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:34:17.078039 [info ] [MainThread]: 
[0m10:34:17.078364 [error] [MainThread]:   Compilation Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  'afn' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:34:17.078618 [info ] [MainThread]: 
[0m10:34:17.078881 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:34:17.089402 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0179377, "process_in_blocks": "0", "process_kernel_time": 0.594787, "process_mem_max_rss": "129810432", "process_out_blocks": "0", "process_user_time": 2.065192}
[0m10:34:17.089920 [debug] [MainThread]: Command `dbt run` failed at 10:34:17.089830 after 3.02 seconds
[0m10:34:17.090253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f123e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e18310>]}
[0m10:34:17.090578 [debug] [MainThread]: Flushing usage events
[0m10:34:18.050082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:51.485592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e1ff0>]}


============================== 10:34:51.490318 | 54ed63bb-48aa-4da5-adac-21b7223e8601 ==============================
[0m10:34:51.490318 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:34:51.490817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:34:51.510284 [info ] [MainThread]: dbt version: 1.9.4
[0m10:34:51.510628 [info ] [MainThread]: python version: 3.10.3
[0m10:34:51.510827 [info ] [MainThread]: python path: /Users/goonzardw/Developer/bi/dbt3/.venv/bin/python3
[0m10:34:51.511009 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m10:34:51.565630 [info ] [MainThread]: Using profiles dir at /Users/goonzardw/.dbt
[0m10:34:51.565953 [info ] [MainThread]: Using profiles.yml file at /Users/goonzardw/.dbt/profiles.yml
[0m10:34:51.566142 [info ] [MainThread]: Using dbt_project.yml file at /Users/goonzardw/Developer/bi/dbt3/dbt_project.yml
[0m10:34:51.567714 [info ] [MainThread]: adapter type: postgres
[0m10:34:51.568081 [info ] [MainThread]: adapter version: 1.9.0
[0m10:34:51.626447 [info ] [MainThread]: Configuration:
[0m10:34:51.626788 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:34:51.626969 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:34:51.627141 [info ] [MainThread]: Required dependencies:
[0m10:34:51.627498 [debug] [MainThread]: Executing "git --help"
[0m10:34:51.651181 [debug] [MainThread]: STDOUT: "b"\xec\x82\xac\xec\x9a\xa9\xeb\xb2\x95: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\n\xeb\x8b\xa4\xec\x9d\x8c\xec\x9d\x80 \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\x83\x81\xed\x99\xa9\xec\x97\x90\xec\x84\x9c \xec\x9e\x90\xec\xa3\xbc \xec\x82\xac\xec\x9a\xa9\xed\x95\x98\xeb\x8a\x94 \xea\xb9\x83 \xeb\xaa\x85\xeb\xa0\xb9\xec\x9e\x85\xeb\x8b\x88\xeb\x8b\xa4:\n\n\xec\x9e\x91\xec\x97\x85 \xea\xb3\xb5\xea\xb0\x84 \xec\x8b\x9c\xec\x9e\x91 (\xec\xb0\xb8\xea\xb3\xa0: git help tutorial)\n   clone     \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xb3\xb5\xec\xa0\x9c\xed\x95\xb4 \xec\x83\x88 \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac\xeb\xa1\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   init      \xeb\xb9\x88 \xea\xb9\x83 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98 \xea\xb8\xb0\xec\xa1\xb4 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\x8b\xa4\xec\x8b\x9c \xec\xb4\x88\xea\xb8\xb0\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xeb\xb3\x80\xea\xb2\xbd \xec\x82\xac\xed\x95\xad\xec\x97\x90 \xeb\x8c\x80\xed\x95\x9c \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help everyday)\n   add       \xed\x8c\x8c\xec\x9d\xbc \xeb\x82\xb4\xec\x9a\xa9\xec\x9d\x84 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90 \xec\xb6\x94\xea\xb0\x80\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   mv        \xed\x8c\x8c\xec\x9d\xbc, \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac, \xec\x8b\xac\xeb\xb3\xbc\xeb\xa6\xad \xeb\xa7\x81\xed\x81\xac\xeb\xa5\xbc \xec\x98\xae\xea\xb8\xb0\xea\xb1\xb0\xeb\x82\x98 \xec\x9d\xb4\xeb\xa6\x84\xec\x9d\x84 \xeb\xb0\x94\xea\xbf\x89\xeb\x8b\x88\xeb\x8b\xa4\n   restore   Restore working tree files\n   rm        \xed\x8c\x8c\xec\x9d\xbc\xec\x9d\x84 \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94\xec\x97\x90\xec\x84\x9c \xec\xa0\x9c\xea\xb1\xb0\xed\x95\x98\xea\xb3\xa0 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90\xec\x84\x9c\xeb\x8f\x84 \xec\xa0\x9c\xea\xb1\xb0\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xea\xb3\xbc \xec\x83\x81\xed\x83\x9c \xeb\xb3\xb4\xea\xb8\xb0 (\xec\xb0\xb8\xea\xb3\xa0: git help revisions)\n   bisect    \xec\x9d\xb4\xec\xa7\x84 \xed\x83\x90\xec\x83\x89\xec\x9c\xbc\xeb\xa1\x9c \xeb\xb2\x84\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xec\x96\xb4\xeb\x82\xb8 \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xec\xb0\xbe\xec\x8a\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   diff      \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\xbb\xa4\xeb\xb0\x8b \xec\x82\xac\xec\x9d\xb4, \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\x9e\x91\xec\x97\x85 \xeb\x82\xb4\xec\x9a\xa9 \xec\x82\xac\xec\x9d\xb4 \xeb\x93\xb1\xec\x9d\x98 \xeb\xb0\x94\xeb\x80\x90 \xec\xa0\x90\xec\x9d\x84 \xeb\xb4\x85\xeb\x8b\x88\xeb\x8b\xa4\n   grep      \xed\x8c\xa8\xed\x84\xb4\xea\xb3\xbc \xec\x9d\xbc\xec\xb9\x98\xed\x95\x98\xeb\x8a\x94 \xec\xa4\x84\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   log       \xec\xbb\xa4\xeb\xb0\x8b \xea\xb8\xb0\xeb\xa1\x9d\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   show      \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\xa2\x85\xeb\xa5\x98\xec\x9d\x98 \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   status    \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94 \xec\x83\x81\xed\x83\x9c\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x82\xa4\xec\x9a\xb0\xea\xb3\xa0, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb3\xa0, \xec\xa1\xb0\xec\x9e\x91\xed\x95\x98\xea\xb8\xb0\n   branch    \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xeb\xaa\xa9\xeb\xa1\x9d\xec\x9d\x84 \xec\xb6\x9c\xeb\xa0\xa5\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   commit    \xeb\xb0\x94\xeb\x80\x90 \xec\x82\xac\xed\x95\xad\xec\x9d\x84 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90 \xea\xb8\xb0\xeb\xa1\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   merge     \xec\x97\xac\xeb\x9f\xac \xea\xb0\x9c\xec\x9d\x98 \xea\xb0\x9c\xeb\xb0\x9c \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x95\x98\xeb\x82\x98\xeb\xa1\x9c \xed\x95\xa9\xec\xb9\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   rebase    \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xb2\xa0\xec\x9d\xb4\xec\x8a\xa4 \xeb\x81\x9d\xec\x9d\x98 \xec\xb5\x9c\xec\x83\x81\xec\x9c\x84\xec\x97\x90\xec\x84\x9c \xec\xa0\x81\xec\x9a\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   reset     \xed\x98\x84\xec\x9e\xac HEAD\xeb\xa5\xbc \xec\xa7\x80\xec\xa0\x95\xed\x95\x9c \xec\x83\x81\xed\x83\x9c\xeb\xa1\x9c \xec\x9e\xac\xec\x84\xa4\xec\xa0\x95\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   switch    Switch branches\n   tag       \xed\x83\x9c\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, GPG \xec\x84\x9c\xeb\xaa\x85\xec\x9d\x84 \xea\xb2\x80\xec\xa6\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xed\x98\x91\xeb\x8f\x99 \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help workflows)\n   fetch     \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90\xec\x84\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xec\x99\x80 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4\xeb\xa5\xbc \xeb\x8b\xa4\xec\x9a\xb4\xeb\xa1\x9c\xeb\x93\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   pull      \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c \xeb\x98\x90\xeb\x8a\x94 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xa1\x9c\xec\xbb\xac \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xec\x97\x90\xec\x84\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xa4\xea\xb1\xb0\xeb\x82\x98 \xed\x86\xb5\xed\x95\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   push      \xec\x9b\x90\xea\xb2\xa9 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4 \xeb\xb0\x8f \xea\xb7\xb8\xec\x99\x80 \xea\xb4\x80\xeb\xa0\xa8\xeb\x90\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xec\x97\x85\xeb\x8d\xb0\xec\x9d\xb4\xed\x8a\xb8\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:34:51.651956 [debug] [MainThread]: STDERR: "b''"
[0m10:34:51.652194 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:34:51.652423 [info ] [MainThread]: Connection:
[0m10:34:51.652654 [info ] [MainThread]:   host: localhost
[0m10:34:51.652826 [info ] [MainThread]:   port: 5432
[0m10:34:51.652994 [info ] [MainThread]:   user: postgres
[0m10:34:51.653156 [info ] [MainThread]:   database: postgres
[0m10:34:51.653319 [info ] [MainThread]:   schema: bi
[0m10:34:51.653484 [info ] [MainThread]:   connect_timeout: 10
[0m10:34:51.653652 [info ] [MainThread]:   role: None
[0m10:34:51.653813 [info ] [MainThread]:   search_path: None
[0m10:34:51.653973 [info ] [MainThread]:   keepalives_idle: 0
[0m10:34:51.654136 [info ] [MainThread]:   sslmode: None
[0m10:34:51.654297 [info ] [MainThread]:   sslcert: None
[0m10:34:51.654456 [info ] [MainThread]:   sslkey: None
[0m10:34:51.654614 [info ] [MainThread]:   sslrootcert: None
[0m10:34:51.654776 [info ] [MainThread]:   application_name: dbt
[0m10:34:51.654936 [info ] [MainThread]:   retries: 1
[0m10:34:51.655354 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:34:51.732453 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:34:51.822620 [debug] [MainThread]: Using postgres connection "debug"
[0m10:34:51.823023 [debug] [MainThread]: On debug: select 1 as id
[0m10:34:51.823223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:51.864318 [debug] [MainThread]: SQL status: SELECT 1 in 0.041 seconds
[0m10:34:51.865067 [debug] [MainThread]: On debug: Close
[0m10:34:51.865330 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:34:51.865562 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:34:51.870209 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.48398805, "process_in_blocks": "0", "process_kernel_time": 0.206575, "process_mem_max_rss": "118276096", "process_out_blocks": "0", "process_user_time": 0.942278}
[0m10:34:51.870588 [debug] [MainThread]: Command `dbt debug` succeeded at 10:34:51.870509 after 0.48 seconds
[0m10:34:51.870826 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:34:51.871126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066935b0>]}
[0m10:34:51.871517 [debug] [MainThread]: Flushing usage events
[0m10:34:52.728580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:36:47.908018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b99f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ba110>]}


============================== 10:36:47.919233 | 50eab89e-029d-4eda-afea-9261f8294fd1 ==============================
[0m10:36:47.919233 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:36:47.919719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:36:48.060161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108748880>]}
[0m10:36:48.095736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764c700>]}
[0m10:36:48.096620 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:36:48.183226 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:36:48.346121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:36:48.346577 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m10:36:48.506288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109198220>]}
[0m10:36:48.556195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:36:48.572893 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:36:48.591097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109182530>]}
[0m10:36:48.591471 [info ] [MainThread]: Found 1 model, 4 sources, 434 macros
[0m10:36:48.591698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109181a80>]}
[0m10:36:48.592670 [info ] [MainThread]: 
[0m10:36:48.592886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:36:48.593059 [info ] [MainThread]: 
[0m10:36:48.593357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:36:48.593840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:36:48.720198 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:36:48.720559 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:36:48.720746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:48.780983 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.060 seconds
[0m10:36:48.781934 [debug] [ThreadPool]: On list_postgres: Close
[0m10:36:48.782642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m10:36:48.787070 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:36:48.787351 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m10:36:48.787538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:48.803333 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m10:36:48.803650 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:36:48.803881 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m10:36:48.869993 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.066 seconds
[0m10:36:48.871198 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m10:36:48.871985 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m10:36:48.876065 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:48.876427 [debug] [MainThread]: On master: BEGIN
[0m10:36:48.876680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:36:48.891218 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m10:36:48.891576 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:48.891848 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:36:48.932833 [debug] [MainThread]: SQL status: SELECT 0 in 0.041 seconds
[0m10:36:48.934098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fd9030>]}
[0m10:36:48.934503 [debug] [MainThread]: On master: ROLLBACK
[0m10:36:48.935091 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:48.935439 [debug] [MainThread]: On master: BEGIN
[0m10:36:48.936098 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:36:48.936373 [debug] [MainThread]: On master: COMMIT
[0m10:36:48.936602 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:48.936806 [debug] [MainThread]: On master: COMMIT
[0m10:36:48.937212 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:36:48.937432 [debug] [MainThread]: On master: Close
[0m10:36:48.939650 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m10:36:48.940123 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m10:36:48.940507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m10:36:48.940781 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m10:36:48.947929 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m10:36:48.953471 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m10:36:48.981584 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m10:36:48.983569 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:48.983858 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m10:36:48.984268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:49.021377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m10:36:49.021774 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:49.022151 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m10:36:49.647335 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 0.624 seconds
[0m10:36:49.659177 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:49.659519 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m10:36:49.660455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:36:49.662407 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:49.662650 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m10:36:49.663475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:36:49.677198 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:36:49.677574 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:49.677826 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:36:49.683376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:36:49.689752 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m10:36:49.693637 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:49.693997 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m10:36:49.704588 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m10:36:49.706684 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m10:36:49.712397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874abf0>]}
[0m10:36:49.713023 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 0.77s]
[0m10:36:49.713458 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m10:36:49.714225 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:49.714471 [debug] [MainThread]: On master: BEGIN
[0m10:36:49.714673 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:36:49.724738 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:36:49.725109 [debug] [MainThread]: On master: COMMIT
[0m10:36:49.725335 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:49.725541 [debug] [MainThread]: On master: COMMIT
[0m10:36:49.726163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:36:49.726523 [debug] [MainThread]: On master: Close
[0m10:36:49.726875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:49.727085 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m10:36:49.727318 [info ] [MainThread]: 
[0m10:36:49.727552 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m10:36:49.728000 [debug] [MainThread]: Command end result
[0m10:36:49.744651 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:36:49.746431 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:36:49.751805 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m10:36:49.752075 [info ] [MainThread]: 
[0m10:36:49.752367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:36:49.752582 [info ] [MainThread]: 
[0m10:36:49.752807 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:36:49.754682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.909344, "process_in_blocks": "0", "process_kernel_time": 0.250612, "process_mem_max_rss": "130859008", "process_out_blocks": "0", "process_user_time": 1.441583}
[0m10:36:49.755119 [debug] [MainThread]: Command `dbt run` succeeded at 10:36:49.755041 after 1.91 seconds
[0m10:36:49.755484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091df190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109181d80>]}
[0m10:36:49.755794 [debug] [MainThread]: Flushing usage events
[0m10:36:50.702892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:38:21.524320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104020cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051219c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051220e0>]}


============================== 10:38:21.529042 | 86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e ==============================
[0m10:38:21.529042 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:38:21.529414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'debug': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:38:21.671929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10507a2c0>]}
[0m10:38:21.705795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055048e0>]}
[0m10:38:21.706686 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:38:21.787221 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:38:21.913339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:38:21.913774 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m10:38:22.072897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e81c0>]}
[0m10:38:22.122566 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:38:22.127135 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:38:22.161741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060dc040>]}
[0m10:38:22.162136 [info ] [MainThread]: Found 1 model, 4 sources, 434 macros
[0m10:38:22.162370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552d7e0>]}
[0m10:38:22.163394 [info ] [MainThread]: 
[0m10:38:22.163629 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:38:22.163810 [info ] [MainThread]: 
[0m10:38:22.164119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:38:22.164627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:38:22.275927 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:38:22.276239 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:38:22.276425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:22.331068 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.055 seconds
[0m10:38:22.332023 [debug] [ThreadPool]: On list_postgres: Close
[0m10:38:22.332708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m10:38:22.336837 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:38:22.337083 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m10:38:22.337266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:22.348301 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m10:38:22.348607 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:38:22.348825 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m10:38:22.369441 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m10:38:22.370385 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m10:38:22.371187 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m10:38:22.374500 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:22.374834 [debug] [MainThread]: On master: BEGIN
[0m10:38:22.375043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:22.392073 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m10:38:22.392449 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:22.392754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:38:22.414551 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m10:38:22.415633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f33520>]}
[0m10:38:22.416019 [debug] [MainThread]: On master: ROLLBACK
[0m10:38:22.420052 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:22.420330 [debug] [MainThread]: On master: BEGIN
[0m10:38:22.421154 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:38:22.421395 [debug] [MainThread]: On master: COMMIT
[0m10:38:22.421624 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:22.421836 [debug] [MainThread]: On master: COMMIT
[0m10:38:22.422834 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:38:22.423085 [debug] [MainThread]: On master: Close
[0m10:38:22.425258 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m10:38:22.425697 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m10:38:22.426059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m10:38:22.426326 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m10:38:22.434276 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m10:38:22.437695 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m10:38:22.466270 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m10:38:22.475166 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:22.475532 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m10:38:22.475767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:22.494676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:38:22.495050 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:22.495439 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m10:38:24.336284 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 1.840 seconds
[0m10:38:24.347591 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:24.347946 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m10:38:24.348826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:38:24.350716 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:24.350960 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m10:38:24.351799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:38:24.365510 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:38:24.365860 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:24.366115 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:38:24.371769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:38:24.377588 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m10:38:24.381399 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:24.381830 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m10:38:24.389907 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m10:38:24.392036 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m10:38:24.394474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060726b0>]}
[0m10:38:24.395114 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 1.97s]
[0m10:38:24.395553 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m10:38:24.396287 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:24.396520 [debug] [MainThread]: On master: BEGIN
[0m10:38:24.396719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:24.409847 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:38:24.410201 [debug] [MainThread]: On master: COMMIT
[0m10:38:24.410417 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:24.410608 [debug] [MainThread]: On master: COMMIT
[0m10:38:24.410992 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:38:24.411240 [debug] [MainThread]: On master: Close
[0m10:38:24.411679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:24.411976 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m10:38:24.412200 [info ] [MainThread]: 
[0m10:38:24.412428 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m10:38:24.412868 [debug] [MainThread]: Command end result
[0m10:38:24.431207 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:38:24.441855 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:38:24.467382 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m10:38:24.467821 [info ] [MainThread]: 
[0m10:38:24.468182 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:38:24.468444 [info ] [MainThread]: 
[0m10:38:24.468714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:38:24.470975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0064657, "process_in_blocks": "0", "process_kernel_time": 0.245157, "process_mem_max_rss": "131104768", "process_out_blocks": "0", "process_user_time": 1.427975}
[0m10:38:24.471399 [debug] [MainThread]: Command `dbt run` succeeded at 10:38:24.471319 after 3.01 seconds
[0m10:38:24.471744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104020cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c91990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106568f70>]}
[0m10:38:24.472079 [debug] [MainThread]: Flushing usage events
[0m10:38:25.344518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:02.587070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e60ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aee5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aee60b0>]}


============================== 10:44:02.591960 | 64f8c766-40e7-46c4-9a96-0f077e4869a5 ==============================
[0m10:44:02.591960 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:44:02.592371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:44:02.739803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766a350>]}
[0m10:44:02.773403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b32f370>]}
[0m10:44:02.774380 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:44:02.881764 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:44:03.008966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:44:03.009409 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m10:44:03.173251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd9c160>]}
[0m10:44:03.226089 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:44:03.233261 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:44:03.253331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbc15a0>]}
[0m10:44:03.253715 [info ] [MainThread]: Found 1 model, 4 sources, 434 macros
[0m10:44:03.253944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbc1540>]}
[0m10:44:03.255018 [info ] [MainThread]: 
[0m10:44:03.255240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:44:03.255417 [info ] [MainThread]: 
[0m10:44:03.255736 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:44:03.256236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:44:03.440056 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:44:03.440366 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:44:03.440567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:03.530871 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.090 seconds
[0m10:44:03.531909 [debug] [ThreadPool]: On list_postgres: Close
[0m10:44:03.532904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_bi_staging'
[0m10:44:03.537629 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:44:03.537950 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m10:44:03.538157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:03.553591 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m10:44:03.553979 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:44:03.554225 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m10:44:03.582458 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.028 seconds
[0m10:44:03.583668 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m10:44:03.584609 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m10:44:03.588377 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:03.588678 [debug] [MainThread]: On master: BEGIN
[0m10:44:03.588902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:03.604554 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:44:03.604870 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:03.605169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:44:03.633099 [debug] [MainThread]: SQL status: SELECT 0 in 0.028 seconds
[0m10:44:03.634325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbe4520>]}
[0m10:44:03.634751 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:03.635497 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:03.635773 [debug] [MainThread]: On master: BEGIN
[0m10:44:03.636590 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:44:03.636898 [debug] [MainThread]: On master: COMMIT
[0m10:44:03.637158 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:03.637399 [debug] [MainThread]: On master: COMMIT
[0m10:44:03.637922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:03.638180 [debug] [MainThread]: On master: Close
[0m10:44:03.640559 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m10:44:03.640995 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m10:44:03.641361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres, now model.fund_dbt_project.stg_fund_master)
[0m10:44:03.641653 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m10:44:03.652833 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m10:44:03.653767 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m10:44:03.682468 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m10:44:03.683376 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:03.683686 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m10:44:03.683903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:03.702508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:44:03.702890 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:03.703303 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m10:44:12.761643 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.057 seconds
[0m10:44:12.773769 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:12.774135 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m10:44:12.775114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:12.777057 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:12.777297 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m10:44:12.778205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:12.792160 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:44:12.792525 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:12.792772 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:44:12.797634 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:44:12.802320 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m10:44:12.805321 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:12.805634 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m10:44:12.816771 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m10:44:12.818750 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m10:44:12.820330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b39c580>]}
[0m10:44:12.820846 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.18s]
[0m10:44:12.821258 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m10:44:12.822033 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:12.822318 [debug] [MainThread]: On master: BEGIN
[0m10:44:12.822537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:12.835219 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:44:12.835642 [debug] [MainThread]: On master: COMMIT
[0m10:44:12.835873 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:12.836077 [debug] [MainThread]: On master: COMMIT
[0m10:44:12.836581 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:12.836825 [debug] [MainThread]: On master: Close
[0m10:44:12.837213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:12.837543 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m10:44:12.837754 [debug] [MainThread]: Connection 'list_postgres_bi_staging' was properly closed.
[0m10:44:12.837988 [info ] [MainThread]: 
[0m10:44:12.838226 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.58 seconds (9.58s).
[0m10:44:12.838679 [debug] [MainThread]: Command end result
[0m10:44:12.855436 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:44:12.857187 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:44:12.863648 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m10:44:12.863895 [info ] [MainThread]: 
[0m10:44:12.864186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:12.864401 [info ] [MainThread]: 
[0m10:44:12.864620 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:44:12.866492 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.361502, "process_in_blocks": "0", "process_kernel_time": 0.254575, "process_mem_max_rss": "131497984", "process_out_blocks": "0", "process_user_time": 1.447818}
[0m10:44:12.867030 [debug] [MainThread]: Command `dbt run` succeeded at 10:44:12.866918 after 10.36 seconds
[0m10:44:12.867418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e60ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd4d030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766a350>]}
[0m10:44:12.867821 [debug] [MainThread]: Flushing usage events
[0m10:44:13.749258 [debug] [MainThread]: An error was encountered while trying to flush usage events
