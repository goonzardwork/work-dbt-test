{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-09T08:16:19.279604Z", "invocation_id": "7eb3cd9e-d1cb-46c7-a302-23606f6d422e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-09T08:16:18.902667Z", "completed_at": "2025-05-09T08:16:18.913976Z"}, {"name": "execute", "started_at": "2025-05-09T08:16:18.914451Z", "completed_at": "2025-05-09T08:16:19.051872Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15047788619995117, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.fund_dbt_project.stg_fund_ledger", "compiled": true, "compiled_code": "with raw as (\n  select\n    \"proc_dt\",\n    \"fund_cd\",\n    \"acct_cd\",\n    \"dc_div\",\n    \"pre_bal\"::numeric,\n    \"debt_amt\"::numeric,\n    \"credit_amt\"::numeric\n  from \"postgres\".\"igisam\".\"fngl\"\n  where \"proc_dt\" = current_date - interval '1 day'  -- \ud83d\udfe1 YESTERDAY ONLY\n)\n\nselect * from raw", "relation_name": "\"postgres\".\"bi\".\"stg_fund_ledger\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-09T08:16:19.073501Z", "completed_at": "2025-05-09T08:16:19.081659Z"}, {"name": "execute", "started_at": "2025-05-09T08:16:19.082072Z", "completed_at": "2025-05-09T08:16:19.211025Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13886284828186035, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.fund_dbt_project.stg_fund_master", "compiled": true, "compiled_code": "with afn as (\n    select * from \"postgres\".\"igisbiz\".\"afndbascm\"\n),\nfn as (\n    select * from \"postgres\".\"igisam\".\"fn\"\n),\nmtfn as (\n    select distinct \"FUND_CD\" from \"postgres\".\"igisam\".\"mtfn\"\n)\n\nselect\n    -- FUND identifiers and names\n    afn.FUND_CD,\n    afn.FUND_NM,\n    afn.FUND_NUM,\n    afn.FUND_NM_FULL,\n    afn.FUND_ANM,\n    afn.FUND_ENM,\n    afn.FUND_ENG_ANM,\n\n    -- Status and classification\n    afn.MNGT_STAT,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'MNGT_STAT'\n      and code.code_id = afn.MNGT_STAT\n    limit 1\n)\n as MNGT_STAT_TXT,\n    coalesce(afn.BLND_YN, 'N') as BLND_YN,\n    afn.FUND_CLS,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'FUND_CLS'\n      and code.code_id = afn.FUND_CLS\n    limit 1\n)\n as FUND_CLS_TXT,\n    afn.FUND_KICD,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'AUREM_FUND_KICD'\n      and code.code_id = afn.FUND_KICD\n    limit 1\n)\n as FUND_KICD_TXT,\n    afn.INVT_TYPE,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'INVT_TYPE'\n      and code.code_id = afn.INVT_TYPE\n    limit 1\n)\n as INVT_TYPE_TXT,\n    afn.INVT_ASET_TYPE,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'INVT_ASET_TYPE'\n      and code.code_id = afn.INVT_ASET_TYPE\n    limit 1\n)\n as INVT_ASET_TYPE_TXT,\n    afn.INVT_TRGT_LCTN_AREA,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'\n      and code.code_id = afn.INVT_TRGT_LCTN_AREA\n    limit 1\n)\n as INVT_TRGT_LCTN_AREA_TXT,\n    afn.INVT_STTG,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'INVT_STTG'\n      and code.code_id = afn.INVT_STTG\n    limit 1\n)\n as INVT_STTG_TXT,\n\n    -- Investment characteristics\n    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,\n    afn.INVT_TRGT_ASET,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'\n      and code.code_id = afn.INVT_TRGT_ASET\n    limit 1\n)\n as INVT_TRGT_ASET_TXT,\n    afn.DMAB_CLS,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'DMAB_CLS'\n      and code.code_id = afn.DMAB_CLS\n    limit 1\n)\n as DMAB_CLS_TXT,\n    afn.PO_PE_CLS,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'PO_PE_CLS'\n      and code.code_id = afn.PO_PE_CLS\n    limit 1\n)\n as PO_PE_CLS_TXT,\n    afn.MOJA_CLS,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'MOJA_CLS'\n      and code.code_id = afn.MOJA_CLS\n    limit 1\n)\n as MOJA_CLS_TXT,\n    afn.MULTI_CLAS_CLS,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'MULTI_CLAS_CLS'\n      and code.code_id = afn.MULTI_CLAS_CLS\n    limit 1\n)\n as MULTI_CLAS_CLS_TXT,\n\n    -- Fund structure\n    afn.FUND_STRR,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'FUND_STRR'\n      and code.code_id = afn.FUND_STRR\n    limit 1\n)\n as FUND_STRR_TXT,\n    afn.LOAN_INVT_TYPE,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'LOAN_INVT_TYPE'\n      and code.code_id = afn.LOAN_INVT_TYPE\n    limit 1\n)\n as LOAN_INVT_TYPE_TXT,\n\n    -- Service providers\n    afn.AGCO,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'OTHR_AGCO_CLS'\n      and code.code_id = afn.AGCO\n    limit 1\n)\n as AGCO_TXT,\n    afn.CNCO,\n    \n(\n    select code_nm\n    from \"postgres\".\"igisdms\".\"mdbmcodef\" code\n    where code.code_grp_id = 'CNCO_CODE'\n      and code.code_id = afn.CNCO\n    limit 1\n)\n as CNCO_NM,\n\n    -- Key dates\n    afn.CNRC_STTL_DT,\n    afn.FST_ESDT,\n    afn.MNGT_BGDT,\n    afn.MTRT_PRDT,\n    afn.MNGT_EXDT,\n    afn.FUND_LQDT,\n\n    -- Status flags\n    afn.FUND_CANC_YN,\n    afn.THCO_FUND_FOF_INCU_YN,\n    afn.SD_YN,\n    afn.SD_STTL_DT,\n    afn.CPCL_MNNR_YN,\n\n    -- Management details\n    afn.INVT_INCR_EMPL_NO,\n    afn.INVT_PTPR_EMPL_NO,\n    afn.MANG_INCR_EMPL_NO,\n    afn.MANG_PTPR_EMPL_NO,\n    afn.MANG_DEPT_CD,\n\n    -- Compliance and codes\n    afn.ACNG_AUDT_YN,\n    afn.FSS_ISCD,\n    afn.KOFIA_ISCD,\n    afn.KSD_FUND_CD,\n    afn.KSD_ISCD,\n\n    -- Fund classification depth\n    afn.ACNG_PRD,\n    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,\n    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,\n    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,\n    afn.FUND_13_DIV, afn.FUND_14_DIV,\n\n    -- Risk, currency, and flags\n    afn.STND_CRNC,\n    afn.FUND_RISK_GRAD,\n    afn.CPLX_FUND_YN,\n    afn.FX_HEDG_MTHD,\n    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,\n    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,\n    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,\n    coalesce(afn.USE_YN, 'N') as USE_YN,\n    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,\n    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,\n    afn.UNUL_MATR,\n    case \n        when mtfn.\"FUND_CD\" is not null then 'Y'\n        else 'N'\n    end as FRN_CCY_YN,\n\n    -- FN-sourced fields\n    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,\n    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,\n    fn.NEXT_STTL_DT,\n    fn.PRE_STTL_DT,\n    fn.STTL_PRD\n\nfrom afn\nleft join fn\n    on afn.FUND_CD = fn.FUND_CD\nleft join \"postgres\".\"igisam\".\"mtfn\" mtfn\n    on afn.FUND_CD = mtfn.\"FUND_CD\"", "relation_name": "\"postgres\".\"bi\".\"stg_fund_master\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-09T08:16:19.214147Z", "completed_at": "2025-05-09T08:16:19.226143Z"}, {"name": "execute", "started_at": "2025-05-09T08:16:19.226683Z", "completed_at": "2025-05-09T08:16:19.263408Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.050254106521606445, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.fund_dbt_project.mart_fund_ledger_11304", "compiled": true, "compiled_code": "with filtered as (\n  select\n    proc_dt,\n    fund_cd,\n    acct_cd,\n    dc_div,\n    pre_bal,\n    debt_amt,\n    credit_amt\n  from \"postgres\".\"bi\".\"stg_fund_ledger\"\n  where acct_cd in ('11304')\n),\n\ncalc as (\n  select\n    proc_dt,\n    fund_cd,\n    acct_cd,\n    case\n      when dc_div = 'D' then pre_bal + debt_amt - credit_amt\n      when dc_div = 'C' then pre_bal + credit_amt - debt_amt\n      else null\n    end as value\n  from filtered\n)\n\nselect * from calc", "relation_name": "\"postgres\".\"bi\".\"mart_fund_ledger_11304\"", "batch_results": null}], "elapsed_time": 2.277456760406494, "args": {"macro_debugging": false, "static_parser": true, "require_batched_execution_for_custom_microbatch_strategy": false, "strict_mode": false, "printer_width": 80, "select": [], "log_path": "/Users/goonzardw/Developer/bi/dbt3/logs", "require_yaml_configuration_for_mf_time_spines": false, "warn_error_options": {"include": [], "exclude": []}, "require_resource_names_without_spaces": false, "log_level_file": "debug", "partial_parse_file_diff": true, "defer": false, "which": "run", "require_nested_cumulative_type_params": false, "use_colors": true, "project_dir": "/Users/goonzardw/Developer/bi/dbt3", "send_anonymous_usage_stats": true, "show_resource_report": false, "use_colors_file": true, "skip_nodes_if_on_run_start_fails": false, "write_json": true, "quiet": false, "indirect_selection": "eager", "state_modified_compare_vars": false, "version_check": true, "partial_parse": true, "favor_state": false, "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": false, "populate_cache": true, "log_level": "info", "empty": false, "cache_selected_only": false, "exclude": [], "log_format": "default", "state_modified_compare_more_unrendered_values": false, "vars": {}, "print": true, "introspect": true, "invocation_command": "dbt run", "profiles_dir": "/Users/goonzardw/.dbt", "log_format_file": "debug", "log_file_max_bytes": 10485760}}