[0m09:24:20.003507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118908ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119817940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119817220>]}


============================== 09:24:20.037755 | 4fe23692-bbce-4ef8-bcee-45c1a5b8f28c ==============================
[0m09:24:20.037755 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:24:20.038158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:24:20.191019 [info ] [MainThread]: dbt version: 1.9.4
[0m09:24:20.191575 [info ] [MainThread]: python version: 3.10.3
[0m09:24:20.191887 [info ] [MainThread]: python path: /Users/goonzardw/Developer/bi/dbt3/.venv/bin/python3
[0m09:24:20.192159 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m09:24:21.858981 [info ] [MainThread]: Using profiles dir at /Users/goonzardw/.dbt
[0m09:24:21.859436 [info ] [MainThread]: Using profiles.yml file at /Users/goonzardw/.dbt/profiles.yml
[0m09:24:21.859704 [info ] [MainThread]: Using dbt_project.yml file at /Users/goonzardw/Developer/bi/dbt3/dbt_project.yml
[0m09:24:21.863250 [info ] [MainThread]: adapter type: postgres
[0m09:24:21.863656 [info ] [MainThread]: adapter version: 1.9.0
[0m09:24:21.927603 [info ] [MainThread]: Configuration:
[0m09:24:21.927944 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:24:21.928282 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:24:21.928499 [info ] [MainThread]: Required dependencies:
[0m09:24:21.928802 [debug] [MainThread]: Executing "git --help"
[0m09:24:21.957658 [debug] [MainThread]: STDOUT: "b"\xec\x82\xac\xec\x9a\xa9\xeb\xb2\x95: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\n\xeb\x8b\xa4\xec\x9d\x8c\xec\x9d\x80 \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\x83\x81\xed\x99\xa9\xec\x97\x90\xec\x84\x9c \xec\x9e\x90\xec\xa3\xbc \xec\x82\xac\xec\x9a\xa9\xed\x95\x98\xeb\x8a\x94 \xea\xb9\x83 \xeb\xaa\x85\xeb\xa0\xb9\xec\x9e\x85\xeb\x8b\x88\xeb\x8b\xa4:\n\n\xec\x9e\x91\xec\x97\x85 \xea\xb3\xb5\xea\xb0\x84 \xec\x8b\x9c\xec\x9e\x91 (\xec\xb0\xb8\xea\xb3\xa0: git help tutorial)\n   clone     \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xb3\xb5\xec\xa0\x9c\xed\x95\xb4 \xec\x83\x88 \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac\xeb\xa1\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   init      \xeb\xb9\x88 \xea\xb9\x83 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98 \xea\xb8\xb0\xec\xa1\xb4 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\x8b\xa4\xec\x8b\x9c \xec\xb4\x88\xea\xb8\xb0\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xeb\xb3\x80\xea\xb2\xbd \xec\x82\xac\xed\x95\xad\xec\x97\x90 \xeb\x8c\x80\xed\x95\x9c \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help everyday)\n   add       \xed\x8c\x8c\xec\x9d\xbc \xeb\x82\xb4\xec\x9a\xa9\xec\x9d\x84 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90 \xec\xb6\x94\xea\xb0\x80\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   mv        \xed\x8c\x8c\xec\x9d\xbc, \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac, \xec\x8b\xac\xeb\xb3\xbc\xeb\xa6\xad \xeb\xa7\x81\xed\x81\xac\xeb\xa5\xbc \xec\x98\xae\xea\xb8\xb0\xea\xb1\xb0\xeb\x82\x98 \xec\x9d\xb4\xeb\xa6\x84\xec\x9d\x84 \xeb\xb0\x94\xea\xbf\x89\xeb\x8b\x88\xeb\x8b\xa4\n   restore   Restore working tree files\n   rm        \xed\x8c\x8c\xec\x9d\xbc\xec\x9d\x84 \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94\xec\x97\x90\xec\x84\x9c \xec\xa0\x9c\xea\xb1\xb0\xed\x95\x98\xea\xb3\xa0 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90\xec\x84\x9c\xeb\x8f\x84 \xec\xa0\x9c\xea\xb1\xb0\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xea\xb3\xbc \xec\x83\x81\xed\x83\x9c \xeb\xb3\xb4\xea\xb8\xb0 (\xec\xb0\xb8\xea\xb3\xa0: git help revisions)\n   bisect    \xec\x9d\xb4\xec\xa7\x84 \xed\x83\x90\xec\x83\x89\xec\x9c\xbc\xeb\xa1\x9c \xeb\xb2\x84\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xec\x96\xb4\xeb\x82\xb8 \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xec\xb0\xbe\xec\x8a\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   diff      \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\xbb\xa4\xeb\xb0\x8b \xec\x82\xac\xec\x9d\xb4, \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\x9e\x91\xec\x97\x85 \xeb\x82\xb4\xec\x9a\xa9 \xec\x82\xac\xec\x9d\xb4 \xeb\x93\xb1\xec\x9d\x98 \xeb\xb0\x94\xeb\x80\x90 \xec\xa0\x90\xec\x9d\x84 \xeb\xb4\x85\xeb\x8b\x88\xeb\x8b\xa4\n   grep      \xed\x8c\xa8\xed\x84\xb4\xea\xb3\xbc \xec\x9d\xbc\xec\xb9\x98\xed\x95\x98\xeb\x8a\x94 \xec\xa4\x84\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   log       \xec\xbb\xa4\xeb\xb0\x8b \xea\xb8\xb0\xeb\xa1\x9d\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   show      \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\xa2\x85\xeb\xa5\x98\xec\x9d\x98 \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   status    \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94 \xec\x83\x81\xed\x83\x9c\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x82\xa4\xec\x9a\xb0\xea\xb3\xa0, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb3\xa0, \xec\xa1\xb0\xec\x9e\x91\xed\x95\x98\xea\xb8\xb0\n   branch    \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xeb\xaa\xa9\xeb\xa1\x9d\xec\x9d\x84 \xec\xb6\x9c\xeb\xa0\xa5\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   commit    \xeb\xb0\x94\xeb\x80\x90 \xec\x82\xac\xed\x95\xad\xec\x9d\x84 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90 \xea\xb8\xb0\xeb\xa1\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   merge     \xec\x97\xac\xeb\x9f\xac \xea\xb0\x9c\xec\x9d\x98 \xea\xb0\x9c\xeb\xb0\x9c \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x95\x98\xeb\x82\x98\xeb\xa1\x9c \xed\x95\xa9\xec\xb9\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   rebase    \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xb2\xa0\xec\x9d\xb4\xec\x8a\xa4 \xeb\x81\x9d\xec\x9d\x98 \xec\xb5\x9c\xec\x83\x81\xec\x9c\x84\xec\x97\x90\xec\x84\x9c \xec\xa0\x81\xec\x9a\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   reset     \xed\x98\x84\xec\x9e\xac HEAD\xeb\xa5\xbc \xec\xa7\x80\xec\xa0\x95\xed\x95\x9c \xec\x83\x81\xed\x83\x9c\xeb\xa1\x9c \xec\x9e\xac\xec\x84\xa4\xec\xa0\x95\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   switch    Switch branches\n   tag       \xed\x83\x9c\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, GPG \xec\x84\x9c\xeb\xaa\x85\xec\x9d\x84 \xea\xb2\x80\xec\xa6\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xed\x98\x91\xeb\x8f\x99 \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help workflows)\n   fetch     \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90\xec\x84\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xec\x99\x80 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4\xeb\xa5\xbc \xeb\x8b\xa4\xec\x9a\xb4\xeb\xa1\x9c\xeb\x93\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   pull      \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c \xeb\x98\x90\xeb\x8a\x94 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xa1\x9c\xec\xbb\xac \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xec\x97\x90\xec\x84\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xa4\xea\xb1\xb0\xeb\x82\x98 \xed\x86\xb5\xed\x95\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   push      \xec\x9b\x90\xea\xb2\xa9 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4 \xeb\xb0\x8f \xea\xb7\xb8\xec\x99\x80 \xea\xb4\x80\xeb\xa0\xa8\xeb\x90\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xec\x97\x85\xeb\x8d\xb0\xec\x9d\xb4\xed\x8a\xb8\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:24:21.958591 [debug] [MainThread]: STDERR: "b''"
[0m09:24:21.958854 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:24:21.959072 [info ] [MainThread]: Connection:
[0m09:24:21.959288 [info ] [MainThread]:   host: localhost
[0m09:24:21.959456 [info ] [MainThread]:   port: 5432
[0m09:24:21.959615 [info ] [MainThread]:   user: postgres
[0m09:24:21.959775 [info ] [MainThread]:   database: postgres
[0m09:24:21.959933 [info ] [MainThread]:   schema: bi
[0m09:24:21.960090 [info ] [MainThread]:   connect_timeout: 10
[0m09:24:21.960249 [info ] [MainThread]:   role: None
[0m09:24:21.960400 [info ] [MainThread]:   search_path: None
[0m09:24:21.960556 [info ] [MainThread]:   keepalives_idle: 0
[0m09:24:21.960711 [info ] [MainThread]:   sslmode: None
[0m09:24:21.960862 [info ] [MainThread]:   sslcert: None
[0m09:24:21.961013 [info ] [MainThread]:   sslkey: None
[0m09:24:21.961160 [info ] [MainThread]:   sslrootcert: None
[0m09:24:21.961311 [info ] [MainThread]:   application_name: dbt
[0m09:24:21.961460 [info ] [MainThread]:   retries: 1
[0m09:24:21.961844 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:24:22.054710 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:24:25.617403 [debug] [MainThread]: Using postgres connection "debug"
[0m09:24:25.617724 [debug] [MainThread]: On debug: select 1 as id
[0m09:24:25.617919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:25.910137 [debug] [MainThread]: SQL status: SELECT 1 in 0.290 seconds
[0m09:24:25.912769 [debug] [MainThread]: On debug: Close
[0m09:24:25.913576 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:24:25.914214 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:24:25.933816 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 6.0213947, "process_in_blocks": "0", "process_kernel_time": 0.407616, "process_mem_max_rss": "131268608", "process_out_blocks": "0", "process_user_time": 1.137933}
[0m09:24:25.934578 [debug] [MainThread]: Command `dbt debug` succeeded at 09:24:25.934444 after 6.02 seconds
[0m09:24:25.935050 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:24:25.935507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118908ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198ebd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189d1ae0>]}
[0m09:24:25.936016 [debug] [MainThread]: Flushing usage events
[0m09:24:26.782984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:34.827876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118308ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a219c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a220e0>]}


============================== 09:24:34.832235 | 795c50eb-0208-4fb4-89a8-11b35c5bb027 ==============================
[0m09:24:34.832235 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:24:34.832589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:24:34.947344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab8efb0>]}
[0m09:24:34.980038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abb72e0>]}
[0m09:24:34.980710 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:24:35.057655 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:24:35.058413 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:24:35.058683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac83700>]}
[0m09:24:36.605376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d960070>]}
[0m09:24:36.652335 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:24:36.658974 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:24:36.727875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d910580>]}
[0m09:24:36.728262 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:24:36.728489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107422050>]}
[0m09:24:36.729403 [info ] [MainThread]: 
[0m09:24:36.729630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:24:36.729814 [info ] [MainThread]: 
[0m09:24:36.730121 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:24:36.730636 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:24:36.842868 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:24:36.843164 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:24:36.843348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:36.898894 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.055 seconds
[0m09:24:36.899925 [debug] [ThreadPool]: On list_postgres: Close
[0m09:24:36.900430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_bi_staging)
[0m09:24:36.900808 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "bi_staging"
"
[0m09:24:36.904741 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_staging"
[0m09:24:36.904990 [debug] [ThreadPool]: On create_postgres_bi_staging: BEGIN
[0m09:24:36.905180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:36.915009 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:24:36.915324 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_staging"
[0m09:24:36.915546 [debug] [ThreadPool]: On create_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "create_postgres_bi_staging"} */
create schema if not exists "bi_staging"
[0m09:24:36.926106 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.010 seconds
[0m09:24:36.926793 [debug] [ThreadPool]: On create_postgres_bi_staging: COMMIT
[0m09:24:36.927028 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_staging"
[0m09:24:36.927237 [debug] [ThreadPool]: On create_postgres_bi_staging: COMMIT
[0m09:24:36.937253 [debug] [ThreadPool]: SQL status: COMMIT in 0.010 seconds
[0m09:24:36.937489 [debug] [ThreadPool]: On create_postgres_bi_staging: Close
[0m09:24:36.938238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_bi_staging, now list_postgres_bi_staging)
[0m09:24:36.942856 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:24:36.943151 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:24:36.943351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:36.955172 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:24:36.955508 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:24:36.955750 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:24:36.997077 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.041 seconds
[0m09:24:36.998210 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:24:36.998934 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:24:37.002940 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.003332 [debug] [MainThread]: On master: BEGIN
[0m09:24:37.003589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:37.014195 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:24:37.014527 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.014839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:24:37.058128 [debug] [MainThread]: SQL status: SELECT 0 in 0.043 seconds
[0m09:24:37.059286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d9da650>]}
[0m09:24:37.059717 [debug] [MainThread]: On master: ROLLBACK
[0m09:24:37.061272 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.061714 [debug] [MainThread]: On master: BEGIN
[0m09:24:37.063220 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:24:37.063510 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.063791 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.064049 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.064850 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:24:37.065138 [debug] [MainThread]: On master: Close
[0m09:24:37.077008 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:24:37.077691 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:24:37.078220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:24:37.078600 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:24:37.087272 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:24:37.088202 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:24:37.120367 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:24:37.121372 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:24:37.121623 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:24:37.121844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:37.139899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m09:24:37.140285 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:24:37.140665 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "dw"."igisbiz"."afndbascm"
),
fn as (
    select * from "dw"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:24:37.141656 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "dw.igisbiz.afndbascm"
LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                           ^

[0m09:24:37.142041 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:24:37.142583 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:24:37.154295 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:24:37.157248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795c50eb-0208-4fb4-89a8-11b35c5bb027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198cb9d0>]}
[0m09:24:37.157778 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.08s]
[0m09:24:37.158192 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:24:37.158580 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:24:37.159774 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.160022 [debug] [MainThread]: On master: BEGIN
[0m09:24:37.160216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:37.174330 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:24:37.174668 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.174880 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:37.175074 [debug] [MainThread]: On master: COMMIT
[0m09:24:37.175696 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:24:37.176043 [debug] [MainThread]: On master: Close
[0m09:24:37.176429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:37.176684 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:24:37.176919 [info ] [MainThread]: 
[0m09:24:37.177160 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m09:24:37.177632 [debug] [MainThread]: Command end result
[0m09:24:37.200939 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:24:37.202619 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:24:37.207532 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:24:37.207830 [info ] [MainThread]: 
[0m09:24:37.208089 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:24:37.208304 [info ] [MainThread]: 
[0m09:24:37.208555 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:24:37.208753 [info ] [MainThread]: 
[0m09:24:37.209366 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:24:37.211040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4475546, "process_in_blocks": "0", "process_kernel_time": 0.236021, "process_mem_max_rss": "133480448", "process_out_blocks": "0", "process_user_time": 1.8206}
[0m09:24:37.211379 [debug] [MainThread]: Command `dbt run` failed at 09:24:37.211318 after 2.45 seconds
[0m09:24:37.211654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118308ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abb72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db34b80>]}
[0m09:24:37.211903 [debug] [MainThread]: Flushing usage events
[0m09:24:38.060224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:48.269925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a21a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a22140>]}


============================== 09:32:48.274978 | 4b96db50-529c-4503-816f-9e3dc95b7ca2 ==============================
[0m09:32:48.274978 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:32:48.275333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:32:48.454240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7c520>]}
[0m09:32:48.486780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104552f50>]}
[0m09:32:48.487641 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:32:48.578421 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:32:48.754924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:32:48.755243 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:32:48.777780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106160130>]}
[0m09:32:48.825998 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:32:48.832506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:32:48.859929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f1c30>]}
[0m09:32:48.860311 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:32:48.860545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d3fa00>]}
[0m09:32:48.861520 [info ] [MainThread]: 
[0m09:32:48.861755 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:32:48.861934 [info ] [MainThread]: 
[0m09:32:48.862250 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:32:48.862734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:32:49.154810 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:32:49.155224 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:32:49.155496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:32:49.238578 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.083 seconds
[0m09:32:49.239680 [debug] [ThreadPool]: On list_postgres: Close
[0m09:32:49.240525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:32:49.245818 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:32:49.246121 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:32:49.246348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:32:49.259071 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:32:49.259424 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:32:49.259665 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:32:49.282522 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m09:32:49.283544 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:32:49.284604 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:32:49.288233 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.288575 [debug] [MainThread]: On master: BEGIN
[0m09:32:49.288803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:32:49.299321 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:32:49.299656 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.299967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:32:49.314160 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m09:32:49.315204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106183cd0>]}
[0m09:32:49.315616 [debug] [MainThread]: On master: ROLLBACK
[0m09:32:49.316238 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.316501 [debug] [MainThread]: On master: BEGIN
[0m09:32:49.317429 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:32:49.317773 [debug] [MainThread]: On master: COMMIT
[0m09:32:49.318058 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.318303 [debug] [MainThread]: On master: COMMIT
[0m09:32:49.318910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:32:49.319280 [debug] [MainThread]: On master: Close
[0m09:32:49.321673 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:32:49.322167 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:32:49.322546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:32:49.322841 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:32:49.329684 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:32:49.330499 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:32:49.359195 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:32:49.365649 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:32:49.365984 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:32:49.366202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:32:49.381797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:32:49.382143 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:32:49.382467 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "dw"."igisbiz"."afndbascm"
),
fn as (
    select * from "dw"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:32:49.383535 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "dw.igisbiz.afndbascm"
LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                           ^

[0m09:32:49.383871 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:32:49.384564 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:32:49.413968 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:32:49.415712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b96db50-529c-4503-816f-9e3dc95b7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cb700>]}
[0m09:32:49.416246 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.09s]
[0m09:32:49.416673 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:32:49.417032 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:32:49.418307 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.418554 [debug] [MainThread]: On master: BEGIN
[0m09:32:49.418749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:32:49.432808 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:32:49.433192 [debug] [MainThread]: On master: COMMIT
[0m09:32:49.433421 [debug] [MainThread]: Using postgres connection "master"
[0m09:32:49.433649 [debug] [MainThread]: On master: COMMIT
[0m09:32:49.434372 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:32:49.434799 [debug] [MainThread]: On master: Close
[0m09:32:49.435176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:32:49.435386 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:32:49.435610 [info ] [MainThread]: 
[0m09:32:49.435850 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m09:32:49.436303 [debug] [MainThread]: Command end result
[0m09:32:49.480807 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:32:49.482116 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:32:49.486437 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:32:49.486681 [info ] [MainThread]: 
[0m09:32:49.486927 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:32:49.487139 [info ] [MainThread]: 
[0m09:32:49.487376 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:32:49.487564 [info ] [MainThread]: 
[0m09:32:49.487756 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:32:49.494169 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.27839, "process_in_blocks": "0", "process_kernel_time": 0.300688, "process_mem_max_rss": "127090688", "process_out_blocks": "0", "process_user_time": 1.260434}
[0m09:32:49.494491 [debug] [MainThread]: Command `dbt run` failed at 09:32:49.494436 after 1.28 seconds
[0m09:32:49.494729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678a6b0>]}
[0m09:32:49.494948 [debug] [MainThread]: Flushing usage events
[0m09:32:50.429888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:20.743116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dc8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de59f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de6110>]}


============================== 09:34:20.747324 | 59f28542-bb11-4509-beaf-7908df8b5fbf ==============================
[0m09:34:20.747324 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:34:20.747667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:34:20.876966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112254880>]}
[0m09:34:20.912577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e6c700>]}
[0m09:34:20.913514 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:34:20.987167 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:34:21.103847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:34:21.104147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:34:21.127838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b10130>]}
[0m09:34:21.177229 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:34:21.180613 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:34:21.205416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa0cd0>]}
[0m09:34:21.205960 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:34:21.206278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa1030>]}
[0m09:34:21.207287 [info ] [MainThread]: 
[0m09:34:21.207518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:34:21.207688 [info ] [MainThread]: 
[0m09:34:21.207972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:34:21.208510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:34:21.341426 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:34:21.341755 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:34:21.341951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:21.397619 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.056 seconds
[0m09:34:21.398582 [debug] [ThreadPool]: On list_postgres: Close
[0m09:34:21.399288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:34:21.403687 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:34:21.403945 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:34:21.404119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:21.417184 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:34:21.417493 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:34:21.417704 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:34:21.436961 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m09:34:21.437844 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:34:21.438713 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:34:21.441893 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.442144 [debug] [MainThread]: On master: BEGIN
[0m09:34:21.442343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:34:21.452311 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:34:21.452641 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.452926 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:34:21.472661 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m09:34:21.473668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b32860>]}
[0m09:34:21.474047 [debug] [MainThread]: On master: ROLLBACK
[0m09:34:21.475076 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.475305 [debug] [MainThread]: On master: BEGIN
[0m09:34:21.476497 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:34:21.476717 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.476929 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.477130 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.477932 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:34:21.478148 [debug] [MainThread]: On master: Close
[0m09:34:21.480342 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:34:21.480776 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:34:21.481122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:34:21.481394 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:34:21.487836 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:34:21.488555 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:34:21.516908 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:34:21.518353 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:34:21.518579 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:34:21.518778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:21.533873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:34:21.534205 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:34:21.534523 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "dw"."igisbiz"."afndbascm"
),
fn as (
    select * from "dw"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:34:21.535344 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "dw.igisbiz.afndbascm"
LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                           ^

[0m09:34:21.535589 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:34:21.536078 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:34:21.541266 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:34:21.542779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f28542-bb11-4509-beaf-7908df8b5fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dcba30>]}
[0m09:34:21.543252 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.06s]
[0m09:34:21.543629 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:34:21.543974 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:34:21.544900 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.545100 [debug] [MainThread]: On master: BEGIN
[0m09:34:21.545263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:34:21.558782 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:34:21.559208 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.559470 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:21.559649 [debug] [MainThread]: On master: COMMIT
[0m09:34:21.560268 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:34:21.560577 [debug] [MainThread]: On master: Close
[0m09:34:21.560869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:21.561051 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:34:21.561250 [info ] [MainThread]: 
[0m09:34:21.561508 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m09:34:21.561956 [debug] [MainThread]: Command end result
[0m09:34:21.604709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:34:21.606284 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:34:21.610448 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:34:21.610688 [info ] [MainThread]: 
[0m09:34:21.610933 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:34:21.611132 [info ] [MainThread]: 
[0m09:34:21.611366 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  cross-database references are not implemented: "dw.igisbiz.afndbascm"
  LINE 13:     select * from "dw"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:34:21.611568 [info ] [MainThread]: 
[0m09:34:21.611762 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:34:21.613767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9251252, "process_in_blocks": "0", "process_kernel_time": 0.241062, "process_mem_max_rss": "126205952", "process_out_blocks": "0", "process_user_time": 1.25674}
[0m09:34:21.614067 [debug] [MainThread]: Command `dbt run` failed at 09:34:21.614011 after 0.93 seconds
[0m09:34:21.614320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dc8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11303b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113039870>]}
[0m09:34:21.614557 [debug] [MainThread]: Flushing usage events
[0m09:34:22.437570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:35:10.258419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103734d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104441a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104442140>]}


============================== 09:35:10.262860 | 33912588-c1a8-40c9-820d-f0b450e998a3 ==============================
[0m09:35:10.262860 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:35:10.263228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:35:10.392340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048abaf0>]}
[0m09:35:10.425053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037fcf70>]}
[0m09:35:10.425978 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:35:10.518130 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:35:10.628234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:35:10.628787 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/schema.yml
[0m09:35:10.844827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105216260>]}
[0m09:35:10.923883 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:35:10.926973 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:35:10.943091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105319360>]}
[0m09:35:10.943460 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:35:10.943684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105318220>]}
[0m09:35:10.944585 [info ] [MainThread]: 
[0m09:35:10.944814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:35:10.944995 [info ] [MainThread]: 
[0m09:35:10.945296 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:35:10.945843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:35:11.275130 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:35:11.275858 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:35:11.276227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:11.410178 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.134 seconds
[0m09:35:11.411613 [debug] [ThreadPool]: On list_postgres: Close
[0m09:35:11.412721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:35:11.418553 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:35:11.418891 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:35:11.419133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:11.464348 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m09:35:11.464858 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:35:11.465223 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:35:11.514825 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.049 seconds
[0m09:35:11.516728 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:35:11.522035 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:35:11.528261 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.528863 [debug] [MainThread]: On master: BEGIN
[0m09:35:11.529235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:35:11.574807 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m09:35:11.575214 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.575534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:35:11.600407 [debug] [MainThread]: SQL status: SELECT 0 in 0.024 seconds
[0m09:35:11.602410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c5600>]}
[0m09:35:11.603118 [debug] [MainThread]: On master: ROLLBACK
[0m09:35:11.604255 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.604796 [debug] [MainThread]: On master: BEGIN
[0m09:35:11.606546 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:35:11.607025 [debug] [MainThread]: On master: COMMIT
[0m09:35:11.607467 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.607873 [debug] [MainThread]: On master: COMMIT
[0m09:35:11.609076 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:35:11.609694 [debug] [MainThread]: On master: Close
[0m09:35:11.613990 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:35:11.614778 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:35:11.615385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:35:11.615838 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:35:11.626990 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:35:11.628616 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:35:11.665115 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:35:11.666240 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:35:11.666590 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:35:11.666820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:11.681858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:35:11.682191 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:35:11.682545 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:35:11.684181 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column afn.frn_ccy_yn does not exist
LINE 119:     coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
                       ^

[0m09:35:11.684458 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:35:11.685051 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:35:11.696091 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column afn.frn_ccy_yn does not exist
  LINE 119:     coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
                         ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:35:11.697722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33912588-c1a8-40c9-820d-f0b450e998a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa3d90>]}
[0m09:35:11.698221 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.08s]
[0m09:35:11.698614 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:35:11.698953 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column afn.frn_ccy_yn does not exist
  LINE 119:     coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
                         ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:35:11.699917 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.700147 [debug] [MainThread]: On master: BEGIN
[0m09:35:11.700342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:35:11.713406 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:35:11.713730 [debug] [MainThread]: On master: COMMIT
[0m09:35:11.713929 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:11.714113 [debug] [MainThread]: On master: COMMIT
[0m09:35:11.714559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:35:11.714776 [debug] [MainThread]: On master: Close
[0m09:35:11.715073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:11.715341 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:35:11.715582 [info ] [MainThread]: 
[0m09:35:11.715806 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m09:35:11.716230 [debug] [MainThread]: Command end result
[0m09:35:11.730491 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:35:11.731832 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:35:11.736518 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:35:11.736724 [info ] [MainThread]: 
[0m09:35:11.736961 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:35:11.737159 [info ] [MainThread]: 
[0m09:35:11.737390 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column afn.frn_ccy_yn does not exist
  LINE 119:     coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
                         ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:35:11.737575 [info ] [MainThread]: 
[0m09:35:11.737769 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:35:11.739565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5407869, "process_in_blocks": "0", "process_kernel_time": 0.258839, "process_mem_max_rss": "130252800", "process_out_blocks": "0", "process_user_time": 1.458563}
[0m09:35:11.739822 [debug] [MainThread]: Command `dbt run` failed at 09:35:11.739772 after 1.54 seconds
[0m09:35:11.740056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103734d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101df86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516f340>]}
[0m09:35:11.740278 [debug] [MainThread]: Flushing usage events
[0m09:35:12.588197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:37:46.146787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106408c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e1930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e2050>]}


============================== 09:37:46.152410 | 46f09221-980a-43b0-9ec9-bf5b1ee7978f ==============================
[0m09:37:46.152410 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:37:46.152887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:37:46.291211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107690550>]}
[0m09:37:46.328667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064adfc0>]}
[0m09:37:46.329786 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:37:46.404928 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:37:46.560084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:37:46.560677 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:37:46.719534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200e0040>]}
[0m09:37:46.767812 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:37:46.770727 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:37:46.805964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200d7670>]}
[0m09:37:46.806371 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:37:46.806617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200d7610>]}
[0m09:37:46.807695 [info ] [MainThread]: 
[0m09:37:46.807968 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:37:46.808154 [info ] [MainThread]: 
[0m09:37:46.808473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:37:46.809017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:37:47.150112 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:37:47.150449 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:37:47.150660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:37:47.190688 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.040 seconds
[0m09:37:47.191629 [debug] [ThreadPool]: On list_postgres: Close
[0m09:37:47.192338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:37:47.196442 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:37:47.196744 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:37:47.196931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:37:47.209231 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:37:47.209585 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:37:47.209806 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:37:47.219836 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m09:37:47.220728 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:37:47.221509 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:37:47.224592 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.224908 [debug] [MainThread]: On master: BEGIN
[0m09:37:47.225103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:37:47.234133 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:37:47.234464 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.234723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:37:47.243725 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m09:37:47.244604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea3550>]}
[0m09:37:47.244935 [debug] [MainThread]: On master: ROLLBACK
[0m09:37:47.246398 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.246779 [debug] [MainThread]: On master: BEGIN
[0m09:37:47.247614 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:37:47.247857 [debug] [MainThread]: On master: COMMIT
[0m09:37:47.248061 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.248241 [debug] [MainThread]: On master: COMMIT
[0m09:37:47.248677 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:37:47.248909 [debug] [MainThread]: On master: Close
[0m09:37:47.251537 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:37:47.251947 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:37:47.252305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:37:47.252629 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:37:47.258432 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:37:47.259760 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:37:47.288667 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:37:47.289608 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:37:47.289946 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:37:47.290179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:37:47.303921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m09:37:47.304293 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:37:47.304616 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    -- coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
    'N' as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:37:47.314920 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "multi_clas_cls" specified more than once

[0m09:37:47.315309 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:37:47.315997 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:37:47.330858 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "multi_clas_cls" specified more than once
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:37:47.336975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46f09221-980a-43b0-9ec9-bf5b1ee7978f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ca530>]}
[0m09:37:47.337543 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.08s]
[0m09:37:47.337934 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:37:47.338284 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "multi_clas_cls" specified more than once
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:37:47.339266 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.339475 [debug] [MainThread]: On master: BEGIN
[0m09:37:47.339654 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:37:47.349179 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:37:47.349529 [debug] [MainThread]: On master: COMMIT
[0m09:37:47.349747 [debug] [MainThread]: Using postgres connection "master"
[0m09:37:47.349934 [debug] [MainThread]: On master: COMMIT
[0m09:37:47.350445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:37:47.350724 [debug] [MainThread]: On master: Close
[0m09:37:47.351045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:37:47.351247 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:37:47.351565 [info ] [MainThread]: 
[0m09:37:47.351881 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m09:37:47.352329 [debug] [MainThread]: Command end result
[0m09:37:47.366389 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:37:47.367985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:37:47.373115 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:37:47.373410 [info ] [MainThread]: 
[0m09:37:47.373665 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:37:47.373872 [info ] [MainThread]: 
[0m09:37:47.374111 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "multi_clas_cls" specified more than once
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:37:47.374384 [info ] [MainThread]: 
[0m09:37:47.374642 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:37:47.384866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3126603, "process_in_blocks": "0", "process_kernel_time": 0.254336, "process_mem_max_rss": "130039808", "process_out_blocks": "0", "process_user_time": 1.415987}
[0m09:37:47.385259 [debug] [MainThread]: Command `dbt run` failed at 09:37:47.385198 after 1.31 seconds
[0m09:37:47.385520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106408c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120110580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e2980>]}
[0m09:37:47.385759 [debug] [MainThread]: Flushing usage events
[0m09:37:48.194944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:09.625793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112808ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113722c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137233a0>]}


============================== 09:38:09.631717 | 3360effa-da04-4a64-83d8-3dc79c2bf126 ==============================
[0m09:38:09.631717 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:38:09.632099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:38:09.771727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11429afb0>]}
[0m09:38:09.804070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142c32e0>]}
[0m09:38:09.804898 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:38:09.886478 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:38:09.994229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:38:09.994673 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:38:10.147796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b6fc40>]}
[0m09:38:10.194715 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:38:10.199311 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:38:10.218889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cb72e0>]}
[0m09:38:10.219276 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:38:10.219506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cb73a0>]}
[0m09:38:10.220550 [info ] [MainThread]: 
[0m09:38:10.220809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:38:10.220992 [info ] [MainThread]: 
[0m09:38:10.221309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:38:10.221849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:38:10.330650 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:38:10.330980 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:38:10.331177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:10.375235 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.044 seconds
[0m09:38:10.376141 [debug] [ThreadPool]: On list_postgres: Close
[0m09:38:10.376870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:38:10.380908 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:38:10.381199 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:38:10.381374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:10.391913 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:38:10.392246 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:38:10.392453 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:38:10.407439 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m09:38:10.408292 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:38:10.412635 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:38:10.415235 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.415446 [debug] [MainThread]: On master: BEGIN
[0m09:38:10.415614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:38:10.425578 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:38:10.425912 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.426208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:38:10.435002 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m09:38:10.435886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b2a830>]}
[0m09:38:10.436234 [debug] [MainThread]: On master: ROLLBACK
[0m09:38:10.436801 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.437065 [debug] [MainThread]: On master: BEGIN
[0m09:38:10.437828 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:38:10.438051 [debug] [MainThread]: On master: COMMIT
[0m09:38:10.438251 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.438434 [debug] [MainThread]: On master: COMMIT
[0m09:38:10.438903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:10.439142 [debug] [MainThread]: On master: Close
[0m09:38:10.441550 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:38:10.441964 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:38:10.442294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:38:10.442542 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:38:10.448499 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.449166 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:38:10.476674 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.479455 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.479680 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:38:10.479876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:10.491487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:38:10.491805 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.492129 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    -- coalesce(afn.FRN_CCY_YN, 'N') as FRN_CCY_YN,
    'N' as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
  );
  
[0m09:38:10.546485 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 0.054 seconds
[0m09:38:10.554386 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.554733 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m09:38:10.555994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:38:10.566461 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:38:10.566923 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.567300 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:38:10.571754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:38:10.576458 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m09:38:10.579535 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:38:10.579816 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m09:38:10.580547 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:38:10.582270 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:38:10.583756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3360effa-da04-4a64-83d8-3dc79c2bf126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119825f0>]}
[0m09:38:10.584322 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 0.14s]
[0m09:38:10.584782 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:38:10.585534 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.585823 [debug] [MainThread]: On master: BEGIN
[0m09:38:10.586019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:38:10.598958 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:38:10.599324 [debug] [MainThread]: On master: COMMIT
[0m09:38:10.599536 [debug] [MainThread]: Using postgres connection "master"
[0m09:38:10.599724 [debug] [MainThread]: On master: COMMIT
[0m09:38:10.600287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:38:10.600552 [debug] [MainThread]: On master: Close
[0m09:38:10.600939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:10.601184 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:38:10.601420 [info ] [MainThread]: 
[0m09:38:10.601651 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m09:38:10.602080 [debug] [MainThread]: Command end result
[0m09:38:10.615896 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:38:10.618520 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:38:10.622963 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:38:10.623253 [info ] [MainThread]: 
[0m09:38:10.623523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:38:10.623717 [info ] [MainThread]: 
[0m09:38:10.623920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:38:10.631084 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.05738, "process_in_blocks": "0", "process_kernel_time": 0.235457, "process_mem_max_rss": "129171456", "process_out_blocks": "0", "process_user_time": 1.367241}
[0m09:38:10.631413 [debug] [MainThread]: Command `dbt run` succeeded at 09:38:10.631355 after 1.06 seconds
[0m09:38:10.631662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112808ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128beef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11429a770>]}
[0m09:38:10.631897 [debug] [MainThread]: Flushing usage events
[0m09:38:11.458650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:40:18.171601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7b0a0>]}


============================== 09:40:18.175835 | 22ac461f-4504-4564-afac-6f023351382b ==============================
[0m09:40:18.175835 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:40:18.176213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:40:18.314467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e6fb0>]}
[0m09:40:18.348143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730f2e0>]}
[0m09:40:18.349051 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:40:18.432037 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:40:18.555183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:40:18.555622 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:40:18.710482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcbc40>]}
[0m09:40:18.757273 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:40:18.760224 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:40:18.776341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3b2e0>]}
[0m09:40:18.776667 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:40:18.776882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3b3a0>]}
[0m09:40:18.777832 [info ] [MainThread]: 
[0m09:40:18.778046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:40:18.778221 [info ] [MainThread]: 
[0m09:40:18.778517 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:40:18.779006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:40:18.901604 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:40:18.901938 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:40:18.902124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:40:18.949963 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.048 seconds
[0m09:40:18.950886 [debug] [ThreadPool]: On list_postgres: Close
[0m09:40:18.951544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:40:18.955461 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:40:18.955694 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:40:18.955866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:40:18.965370 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:40:18.965636 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:40:18.965826 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:40:18.977757 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m09:40:18.978580 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:40:18.979588 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:40:18.982359 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:18.982588 [debug] [MainThread]: On master: BEGIN
[0m09:40:18.982779 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:40:18.992600 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:40:18.992867 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:18.993106 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:40:19.041948 [debug] [MainThread]: SQL status: SELECT 0 in 0.049 seconds
[0m09:40:19.043426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3b880>]}
[0m09:40:19.043767 [debug] [MainThread]: On master: ROLLBACK
[0m09:40:19.044756 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:19.044945 [debug] [MainThread]: On master: BEGIN
[0m09:40:19.046066 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:40:19.046285 [debug] [MainThread]: On master: COMMIT
[0m09:40:19.046469 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:19.046634 [debug] [MainThread]: On master: COMMIT
[0m09:40:19.047318 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:40:19.047546 [debug] [MainThread]: On master: Close
[0m09:40:19.049380 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:40:19.049731 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:40:19.050029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:40:19.050251 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:40:19.055769 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:40:19.056456 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:40:19.084065 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:40:19.087418 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:40:19.087659 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:40:19.087870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:19.100076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:40:19.100451 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:40:19.100767 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn.FUND_CD is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn.FUND_CD
  );
  
[0m09:40:19.102379 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column mtfn.fund_cd does not exist
LINE 135:     on afn.FUND_CD = mtfn.FUND_CD
                               ^
HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".

[0m09:40:19.102709 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:40:19.103267 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:40:19.129567 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 135:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:40:19.131054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22ac461f-4504-4564-afac-6f023351382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d65f0>]}
[0m09:40:19.131528 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.08s]
[0m09:40:19.131894 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:40:19.132250 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 135:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:40:19.133264 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:19.133498 [debug] [MainThread]: On master: BEGIN
[0m09:40:19.133685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:40:19.147675 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:40:19.148008 [debug] [MainThread]: On master: COMMIT
[0m09:40:19.148205 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:19.148377 [debug] [MainThread]: On master: COMMIT
[0m09:40:19.148849 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:40:19.149165 [debug] [MainThread]: On master: Close
[0m09:40:19.149471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:40:19.149655 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:40:19.149852 [info ] [MainThread]: 
[0m09:40:19.150058 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m09:40:19.150530 [debug] [MainThread]: Command end result
[0m09:40:19.164408 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:40:19.165715 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:40:19.169999 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:40:19.170267 [info ] [MainThread]: 
[0m09:40:19.170522 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:40:19.170729 [info ] [MainThread]: 
[0m09:40:19.170967 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 135:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:40:19.171160 [info ] [MainThread]: 
[0m09:40:19.171356 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:40:19.172955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0557215, "process_in_blocks": "0", "process_kernel_time": 0.223081, "process_mem_max_rss": "129957888", "process_out_blocks": "0", "process_user_time": 1.3477}
[0m09:40:19.173233 [debug] [MainThread]: Command `dbt run` failed at 09:40:19.173179 after 1.06 seconds
[0m09:40:19.173496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106908c10>]}
[0m09:40:19.173729 [debug] [MainThread]: Flushing usage events
[0m09:40:20.036759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:50:03.770584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e59f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e6110>]}


============================== 09:50:03.774873 | 7c505daf-41c8-4486-b998-960ba6f08dd7 ==============================
[0m09:50:03.774873 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:50:03.775232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:50:03.956968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795cfa0>]}
[0m09:50:03.990707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cb910>]}
[0m09:50:03.991666 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:50:04.081514 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:50:04.257095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:50:04.257529 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:50:04.407734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096dc100>]}
[0m09:50:04.456472 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:50:04.465251 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:50:04.491275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109707f40>]}
[0m09:50:04.491624 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:50:04.491850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109705bd0>]}
[0m09:50:04.492853 [info ] [MainThread]: 
[0m09:50:04.493100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:50:04.493324 [info ] [MainThread]: 
[0m09:50:04.493730 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:50:04.494249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:50:04.825960 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:50:04.826358 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:50:04.826604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:04.957816 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.131 seconds
[0m09:50:04.959019 [debug] [ThreadPool]: On list_postgres: Close
[0m09:50:04.959940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:50:04.965268 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:50:04.965671 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:50:04.965965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:04.982715 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:50:04.983131 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:50:04.983428 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:50:05.021628 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.038 seconds
[0m09:50:05.022966 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:50:05.024004 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:50:05.028311 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.028696 [debug] [MainThread]: On master: BEGIN
[0m09:50:05.028976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:05.046058 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m09:50:05.046480 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.046839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:50:05.060521 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m09:50:05.062554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c2f20>]}
[0m09:50:05.063035 [debug] [MainThread]: On master: ROLLBACK
[0m09:50:05.063912 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.064337 [debug] [MainThread]: On master: BEGIN
[0m09:50:05.065330 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:50:05.065751 [debug] [MainThread]: On master: COMMIT
[0m09:50:05.066064 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.066344 [debug] [MainThread]: On master: COMMIT
[0m09:50:05.067037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:50:05.067363 [debug] [MainThread]: On master: Close
[0m09:50:05.069935 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:50:05.070457 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:50:05.070924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:50:05.071328 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:50:05.079696 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:50:05.080703 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:50:05.112620 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:50:05.113472 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:50:05.113709 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:50:05.113918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:05.130035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:50:05.130382 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:50:05.130733 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct FUND_CD from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn.FUND_CD is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn.FUND_CD
  );
  
[0m09:50:05.132025 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fund_cd" does not exist
LINE 19:     select distinct FUND_CD from "postgres"."igisam"."mtfn"
                             ^

[0m09:50:05.132292 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:50:05.132825 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:50:05.157668 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "fund_cd" does not exist
  LINE 19:     select distinct FUND_CD from "postgres"."igisam"."mtfn"
                               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:50:05.159305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c505daf-41c8-4486-b998-960ba6f08dd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107537d90>]}
[0m09:50:05.159790 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.09s]
[0m09:50:05.160191 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:50:05.160532 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "fund_cd" does not exist
  LINE 19:     select distinct FUND_CD from "postgres"."igisam"."mtfn"
                               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:50:05.161564 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.161802 [debug] [MainThread]: On master: BEGIN
[0m09:50:05.162003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:50:05.175901 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:50:05.176277 [debug] [MainThread]: On master: COMMIT
[0m09:50:05.176493 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:05.176701 [debug] [MainThread]: On master: COMMIT
[0m09:50:05.177214 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:50:05.177583 [debug] [MainThread]: On master: Close
[0m09:50:05.177923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:05.178130 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:50:05.178354 [info ] [MainThread]: 
[0m09:50:05.178580 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m09:50:05.179022 [debug] [MainThread]: Command end result
[0m09:50:05.193413 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:50:05.196532 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:50:05.200528 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:50:05.200735 [info ] [MainThread]: 
[0m09:50:05.200979 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:50:05.201182 [info ] [MainThread]: 
[0m09:50:05.201648 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "fund_cd" does not exist
  LINE 19:     select distinct FUND_CD from "postgres"."igisam"."mtfn"
                               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:50:05.201902 [info ] [MainThread]: 
[0m09:50:05.202128 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:50:05.264105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5508816, "process_in_blocks": "0", "process_kernel_time": 0.282675, "process_mem_max_rss": "130416640", "process_out_blocks": "0", "process_user_time": 1.413983}
[0m09:50:05.264540 [debug] [MainThread]: Command `dbt run` failed at 09:50:05.264470 after 1.55 seconds
[0m09:50:05.264849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ac4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a316c0>]}
[0m09:50:05.265123 [debug] [MainThread]: Flushing usage events
[0m09:50:06.116465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:07.647053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103578d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042899f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428a110>]}


============================== 09:52:07.653882 | 9fa69073-deb9-4edf-a236-eeafbffd4c07 ==============================
[0m09:52:07.653882 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:52:07.654370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:52:07.780509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104718880>]}
[0m09:52:07.813181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103620700>]}
[0m09:52:07.814109 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:52:07.895836 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:52:08.010846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:52:08.011272 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:52:08.161227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e00a0>]}
[0m09:52:08.209122 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:52:08.212487 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:52:08.230759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058058a0>]}
[0m09:52:08.231075 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:52:08.231300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105993c40>]}
[0m09:52:08.232290 [info ] [MainThread]: 
[0m09:52:08.232520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:08.232697 [info ] [MainThread]: 
[0m09:52:08.233002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:52:08.233508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:52:08.365942 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:52:08.366253 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:52:08.366437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:08.414678 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.048 seconds
[0m09:52:08.415586 [debug] [ThreadPool]: On list_postgres: Close
[0m09:52:08.416223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:52:08.420116 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:52:08.420334 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:52:08.420514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:08.429486 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:52:08.429797 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:52:08.430014 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:52:08.446747 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m09:52:08.447677 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:52:08.452258 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:52:08.455409 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.455685 [debug] [MainThread]: On master: BEGIN
[0m09:52:08.455890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:08.464999 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:52:08.465315 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.465605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:52:08.478955 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m09:52:08.480403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105892e60>]}
[0m09:52:08.480746 [debug] [MainThread]: On master: ROLLBACK
[0m09:52:08.481321 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.481571 [debug] [MainThread]: On master: BEGIN
[0m09:52:08.482245 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:52:08.482465 [debug] [MainThread]: On master: COMMIT
[0m09:52:08.482672 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.482863 [debug] [MainThread]: On master: COMMIT
[0m09:52:08.483329 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:08.483548 [debug] [MainThread]: On master: Close
[0m09:52:08.486231 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:52:08.486625 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:52:08.486954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:52:08.487203 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:52:08.493891 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:52:08.494624 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:52:08.521995 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:52:08.522674 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:52:08.522900 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:52:08.523102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:08.537721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:52:08.538082 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:52:08.538408 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn.FUND_CD is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn.FUND_CD
  );
  
[0m09:52:08.540267 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column mtfn.fund_cd does not exist
LINE 138:     on afn.FUND_CD = mtfn.FUND_CD
                               ^
HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".

[0m09:52:08.540634 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:52:08.541343 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:52:08.548702 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 138:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:52:08.551413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa69073-deb9-4edf-a236-eeafbffd4c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de6b30>]}
[0m09:52:08.551844 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.06s]
[0m09:52:08.552209 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:52:08.552540 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 138:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:52:08.553431 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.553631 [debug] [MainThread]: On master: BEGIN
[0m09:52:08.553801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:08.565395 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:52:08.565702 [debug] [MainThread]: On master: COMMIT
[0m09:52:08.565889 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:08.566060 [debug] [MainThread]: On master: COMMIT
[0m09:52:08.566520 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:08.566822 [debug] [MainThread]: On master: Close
[0m09:52:08.567111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:08.567294 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:52:08.567489 [info ] [MainThread]: 
[0m09:52:08.567697 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m09:52:08.568114 [debug] [MainThread]: Command end result
[0m09:52:08.581661 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:52:08.589626 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:52:08.594033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:52:08.594298 [info ] [MainThread]: 
[0m09:52:08.594571 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:52:08.594786 [info ] [MainThread]: 
[0m09:52:08.595027 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 138:     on afn.FUND_CD = mtfn.FUND_CD
                                 ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:52:08.595226 [info ] [MainThread]: 
[0m09:52:08.595420 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:52:08.597245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0114151, "process_in_blocks": "0", "process_kernel_time": 0.231436, "process_mem_max_rss": "130662400", "process_out_blocks": "0", "process_user_time": 1.349929}
[0m09:52:08.597559 [debug] [MainThread]: Command `dbt run` failed at 09:52:08.597499 after 1.01 seconds
[0m09:52:08.597810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103578d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036e4c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4bc40>]}
[0m09:52:08.598046 [debug] [MainThread]: Flushing usage events
[0m09:52:09.417839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:20.673550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a08cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097219c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097220e0>]}


============================== 09:53:20.686513 | 5b85dba9-7eff-459f-b769-4d7492cf4053 ==============================
[0m09:53:20.686513 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:53:20.686889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'profiles_dir': '/Users/goonzardw/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:53:20.881986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967a2c0>]}
[0m09:53:20.917006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e48e0>]}
[0m09:53:20.923664 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:53:21.056686 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:53:21.332927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:21.333470 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:53:21.484977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7dc0d0>]}
[0m09:53:21.534657 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:53:21.541079 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:53:21.634814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d3340>]}
[0m09:53:21.635306 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:53:21.635608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d33d0>]}
[0m09:53:21.636947 [info ] [MainThread]: 
[0m09:53:21.637256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:53:21.637497 [info ] [MainThread]: 
[0m09:53:21.637886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:21.638544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:53:22.963488 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:53:22.963818 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:53:22.964018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:23.025272 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.061 seconds
[0m09:53:23.026393 [debug] [ThreadPool]: On list_postgres: Close
[0m09:53:23.027273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:53:23.032177 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:53:23.032550 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:53:23.032803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:23.050167 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:53:23.050516 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:53:23.050757 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:53:23.058463 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m09:53:23.059381 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:53:23.059971 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:53:23.063210 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.063494 [debug] [MainThread]: On master: BEGIN
[0m09:53:23.063689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:23.073576 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:53:23.073901 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.074168 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:23.083514 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m09:53:23.084935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d20e0>]}
[0m09:53:23.085282 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:23.089663 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.089996 [debug] [MainThread]: On master: BEGIN
[0m09:53:23.090817 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:53:23.091065 [debug] [MainThread]: On master: COMMIT
[0m09:53:23.091267 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.091448 [debug] [MainThread]: On master: COMMIT
[0m09:53:23.092276 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:53:23.092486 [debug] [MainThread]: On master: Close
[0m09:53:23.096666 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:53:23.097065 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:53:23.097377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:53:23.097601 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:53:23.103434 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:53:23.107129 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:53:23.134199 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:53:23.140074 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:23.140341 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:53:23.140550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:23.158899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m09:53:23.159301 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:23.159662 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn.FUND_CD is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m09:53:23.161451 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column mtfn.fund_cd does not exist
LINE 123:         when mtfn.FUND_CD is not null then 'Y'
                       ^
HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".

[0m09:53:23.161740 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m09:53:23.162360 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:53:23.183447 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 123:         when mtfn.FUND_CD is not null then 'Y'
                         ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:53:23.188886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b85dba9-7eff-459f-b769-4d7492cf4053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e5990>]}
[0m09:53:23.189452 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.09s]
[0m09:53:23.189872 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:53:23.190383 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 123:         when mtfn.FUND_CD is not null then 'Y'
                         ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m09:53:23.191658 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.191965 [debug] [MainThread]: On master: BEGIN
[0m09:53:23.192180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:23.211320 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m09:53:23.211712 [debug] [MainThread]: On master: COMMIT
[0m09:53:23.211940 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:23.212145 [debug] [MainThread]: On master: COMMIT
[0m09:53:23.212649 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:53:23.212923 [debug] [MainThread]: On master: Close
[0m09:53:23.213249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:23.213453 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:53:23.213674 [info ] [MainThread]: 
[0m09:53:23.213902 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m09:53:23.214373 [debug] [MainThread]: Command end result
[0m09:53:23.231094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:53:23.232716 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:53:23.241379 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:53:23.241625 [info ] [MainThread]: 
[0m09:53:23.241891 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:53:23.242106 [info ] [MainThread]: 
[0m09:53:23.242355 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column mtfn.fund_cd does not exist
  LINE 123:         when mtfn.FUND_CD is not null then 'Y'
                         ^
  HINT:  Perhaps you meant to reference the column "afn.fund_cd" or the column "fn.fund_cd".
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m09:53:23.242556 [info ] [MainThread]: 
[0m09:53:23.242763 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:53:23.245879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6528895, "process_in_blocks": "0", "process_kernel_time": 0.414593, "process_mem_max_rss": "131678208", "process_out_blocks": "0", "process_user_time": 1.688443}
[0m09:53:23.246242 [debug] [MainThread]: Command `dbt run` failed at 09:53:23.246182 after 2.65 seconds
[0m09:53:23.246520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a08cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b74d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a791c30>]}
[0m09:53:23.246773 [debug] [MainThread]: Flushing usage events
[0m09:53:24.092451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:33.425081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105908cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071159c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071160e0>]}


============================== 09:53:33.429078 | e9512e80-4a7d-45a3-805b-369a7b630ccb ==============================
[0m09:53:33.429078 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:53:33.429435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:53:33.547051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707a2c0>]}
[0m09:53:33.580574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107389540>]}
[0m09:53:33.581565 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:53:33.652628 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:53:33.768654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:33.769079 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m09:53:33.918416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eec0d0>]}
[0m09:53:33.964568 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:53:33.967599 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:53:33.985206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee3340>]}
[0m09:53:33.985531 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:53:33.985757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee33d0>]}
[0m09:53:33.986720 [info ] [MainThread]: 
[0m09:53:33.986931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:53:33.987109 [info ] [MainThread]: 
[0m09:53:33.987401 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:33.987883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:53:34.103249 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:53:34.103558 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:53:34.103740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:34.142174 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.038 seconds
[0m09:53:34.143146 [debug] [ThreadPool]: On list_postgres: Close
[0m09:53:34.143842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:53:34.148055 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:53:34.148313 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:53:34.148507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:34.162026 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:53:34.162308 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:53:34.162530 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:53:34.178118 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m09:53:34.179245 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:53:34.180185 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:53:34.183590 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.183867 [debug] [MainThread]: On master: BEGIN
[0m09:53:34.184082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:34.197926 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m09:53:34.198275 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.198578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:34.212355 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m09:53:34.213839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee33d0>]}
[0m09:53:34.214205 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:34.215172 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.215397 [debug] [MainThread]: On master: BEGIN
[0m09:53:34.216420 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:53:34.216639 [debug] [MainThread]: On master: COMMIT
[0m09:53:34.216855 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.217056 [debug] [MainThread]: On master: COMMIT
[0m09:53:34.217811 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:53:34.218024 [debug] [MainThread]: On master: Close
[0m09:53:34.222770 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:53:34.223225 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:53:34.223611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:53:34.223893 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:53:34.230791 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.231592 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:53:34.259591 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.260253 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.260494 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:53:34.260714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:34.276363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:53:34.276660 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.276980 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m09:53:34.369966 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 0.093 seconds
[0m09:53:34.379427 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.379831 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m09:53:34.380889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:34.383519 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.383857 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m09:53:34.384935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:34.398494 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:53:34.398925 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.399199 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:53:34.402894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:53:34.408513 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m09:53:34.411514 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:53:34.411801 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m09:53:34.420309 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m09:53:34.422361 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:53:34.423766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9512e80-4a7d-45a3-805b-369a7b630ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a08190>]}
[0m09:53:34.424293 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 0.20s]
[0m09:53:34.424719 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:53:34.425588 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.425827 [debug] [MainThread]: On master: BEGIN
[0m09:53:34.426025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:34.435154 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:53:34.435520 [debug] [MainThread]: On master: COMMIT
[0m09:53:34.435733 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:34.435925 [debug] [MainThread]: On master: COMMIT
[0m09:53:34.436417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:53:34.436739 [debug] [MainThread]: On master: Close
[0m09:53:34.437051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:34.437241 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:53:34.437443 [info ] [MainThread]: 
[0m09:53:34.437652 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m09:53:34.438057 [debug] [MainThread]: Command end result
[0m09:53:34.451541 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:53:34.458368 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:53:34.463025 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:53:34.463276 [info ] [MainThread]: 
[0m09:53:34.463546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:53:34.463740 [info ] [MainThread]: 
[0m09:53:34.463942 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:53:34.465177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0910641, "process_in_blocks": "0", "process_kernel_time": 0.20646, "process_mem_max_rss": "129695744", "process_out_blocks": "0", "process_user_time": 1.380888}
[0m09:53:34.465437 [debug] [MainThread]: Command `dbt run` succeeded at 09:53:34.465383 after 1.09 seconds
[0m09:53:34.465675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105908cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8fc10>]}
[0m09:53:34.465906 [debug] [MainThread]: Flushing usage events
[0m09:53:35.309764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:20.769608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ce59f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ce6110>]}


============================== 09:55:20.773987 | eb056a69-6074-4855-9e42-3145b6e92a9c ==============================
[0m09:55:20.773987 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:55:20.774340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:55:20.902015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119154880>]}
[0m09:55:20.934745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e40700>]}
[0m09:55:20.935670 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:55:21.012286 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:55:21.068491 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:55:21.068881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187a5600>]}
[0m09:55:21.742912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a885060>]}
[0m09:55:21.788646 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:55:21.791719 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:55:21.810895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c0a6e0>]}
[0m09:55:21.811214 [info ] [MainThread]: Found 1 model, 3 sources, 433 macros
[0m09:55:21.811429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715d270>]}
[0m09:55:21.812368 [info ] [MainThread]: 
[0m09:55:21.812587 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:21.812764 [info ] [MainThread]: 
[0m09:55:21.813056 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:55:21.813536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:55:21.900304 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:55:21.900629 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:55:21.900823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:21.941957 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.041 seconds
[0m09:55:21.942861 [debug] [ThreadPool]: On list_postgres: Close
[0m09:55:21.943532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m09:55:21.947467 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:55:21.947706 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m09:55:21.947888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:21.958454 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:55:21.958786 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m09:55:21.959002 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m09:55:21.979530 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m09:55:21.980449 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m09:55:21.980985 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m09:55:21.984336 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:21.984624 [debug] [MainThread]: On master: BEGIN
[0m09:55:21.984829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:21.997768 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:55:21.998088 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:21.998382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:55:22.006190 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m09:55:22.007584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c0b700>]}
[0m09:55:22.007930 [debug] [MainThread]: On master: ROLLBACK
[0m09:55:22.008498 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:22.008712 [debug] [MainThread]: On master: BEGIN
[0m09:55:22.009414 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:55:22.009621 [debug] [MainThread]: On master: COMMIT
[0m09:55:22.009817 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:22.010003 [debug] [MainThread]: On master: COMMIT
[0m09:55:22.010451 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:55:22.010698 [debug] [MainThread]: On master: Close
[0m09:55:22.013334 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m09:55:22.013722 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m09:55:22.014048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m09:55:22.014288 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m09:55:22.020823 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.021570 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m09:55:22.048827 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.049746 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.050126 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m09:55:22.050353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:22.065526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:55:22.065951 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.066309 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    afn.MNGT_STAT as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m09:55:22.157002 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 0.090 seconds
[0m09:55:22.164393 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.164748 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m09:55:22.165621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:55:22.167911 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.168195 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m09:55:22.169170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:55:22.180208 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:55:22.180550 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.180789 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m09:55:22.185110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:55:22.190028 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m09:55:22.192798 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m09:55:22.193065 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m09:55:22.198962 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m09:55:22.200769 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m09:55:22.202222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb056a69-6074-4855-9e42-3145b6e92a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e8700>]}
[0m09:55:22.202737 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 0.19s]
[0m09:55:22.203127 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m09:55:22.203830 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:22.204047 [debug] [MainThread]: On master: BEGIN
[0m09:55:22.204231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:22.215973 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:55:22.216331 [debug] [MainThread]: On master: COMMIT
[0m09:55:22.216536 [debug] [MainThread]: Using postgres connection "master"
[0m09:55:22.216717 [debug] [MainThread]: On master: COMMIT
[0m09:55:22.217224 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:55:22.217559 [debug] [MainThread]: On master: Close
[0m09:55:22.217885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:22.218084 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m09:55:22.218302 [info ] [MainThread]: 
[0m09:55:22.218517 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m09:55:22.218922 [debug] [MainThread]: Command end result
[0m09:55:22.249194 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m09:55:22.251073 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m09:55:22.255161 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m09:55:22.255416 [info ] [MainThread]: 
[0m09:55:22.255692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:55:22.255889 [info ] [MainThread]: 
[0m09:55:22.256083 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:55:22.257744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5506041, "process_in_blocks": "0", "process_kernel_time": 0.232094, "process_mem_max_rss": "133070848", "process_out_blocks": "0", "process_user_time": 1.804252}
[0m09:55:22.258035 [debug] [MainThread]: Command `dbt run` succeeded at 09:55:22.257979 after 1.55 seconds
[0m09:55:22.258291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e40700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c08430>]}
[0m09:55:22.258516 [debug] [MainThread]: Flushing usage events
[0m09:55:23.239554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:14.140569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee5a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee6140>]}


============================== 10:34:14.145727 | 7a40f67d-a598-4a3a-ba2e-ad1532ee42a3 ==============================
[0m10:34:14.145727 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:34:14.146132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:34:14.394942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109328520>]}
[0m10:34:14.430508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108912f50>]}
[0m10:34:14.431474 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:34:14.559484 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:34:14.896860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m10:34:14.897491 [debug] [MainThread]: Partial parsing: added file: fund_dbt_project://macros/code_name.sql
[0m10:34:14.898012 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/schema.yml
[0m10:34:14.898426 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m10:34:15.129596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd40a0>]}
[0m10:34:15.213827 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:34:15.227409 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:34:15.304945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00aef0>]}
[0m10:34:15.305489 [info ] [MainThread]: Found 1 model, 4 sources, 434 macros
[0m10:34:15.305777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065488e0>]}
[0m10:34:15.307123 [info ] [MainThread]: 
[0m10:34:15.307483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:34:15.307717 [info ] [MainThread]: 
[0m10:34:15.308083 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:34:15.308725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:34:16.485771 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:34:16.486167 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:34:16.486427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:16.735006 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.248 seconds
[0m10:34:16.736224 [debug] [ThreadPool]: On list_postgres: Close
[0m10:34:16.737144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m10:34:16.742756 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:34:16.743141 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m10:34:16.743401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:34:16.761329 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m10:34:16.761747 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:34:16.762046 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m10:34:16.789228 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.027 seconds
[0m10:34:16.790688 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m10:34:16.791732 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m10:34:16.796422 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:16.796803 [debug] [MainThread]: On master: BEGIN
[0m10:34:16.797061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:16.813502 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:34:16.813911 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:16.814391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:34:16.892072 [debug] [MainThread]: SQL status: SELECT 0 in 0.077 seconds
[0m10:34:16.893149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a038be0>]}
[0m10:34:16.893505 [debug] [MainThread]: On master: ROLLBACK
[0m10:34:16.894437 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:16.894806 [debug] [MainThread]: On master: BEGIN
[0m10:34:16.897102 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:34:16.897436 [debug] [MainThread]: On master: COMMIT
[0m10:34:16.897666 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:16.897860 [debug] [MainThread]: On master: COMMIT
[0m10:34:16.901350 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:34:16.901597 [debug] [MainThread]: On master: Close
[0m10:34:16.927689 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m10:34:16.928155 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m10:34:16.928541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m10:34:16.928833 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m10:34:17.000633 [debug] [Thread-1 (]: Compilation Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  'afn' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:34:17.004844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a40f67d-a598-4a3a-ba2e-ad1532ee42a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2bdf0>]}
[0m10:34:17.005729 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.07s]
[0m10:34:17.006604 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m10:34:17.007516 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  'afn' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m10:34:17.009901 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:17.010334 [debug] [MainThread]: On master: BEGIN
[0m10:34:17.010660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:34:17.035489 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m10:34:17.036107 [debug] [MainThread]: On master: COMMIT
[0m10:34:17.036506 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:17.036859 [debug] [MainThread]: On master: COMMIT
[0m10:34:17.037737 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:34:17.038315 [debug] [MainThread]: On master: Close
[0m10:34:17.038879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:17.039251 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m10:34:17.039716 [info ] [MainThread]: 
[0m10:34:17.040258 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m10:34:17.041175 [debug] [MainThread]: Command end result
[0m10:34:17.064066 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:34:17.068896 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:34:17.077049 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m10:34:17.077415 [info ] [MainThread]: 
[0m10:34:17.077760 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:34:17.078039 [info ] [MainThread]: 
[0m10:34:17.078364 [error] [MainThread]:   Compilation Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  'afn' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:34:17.078618 [info ] [MainThread]: 
[0m10:34:17.078881 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:34:17.089402 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0179377, "process_in_blocks": "0", "process_kernel_time": 0.594787, "process_mem_max_rss": "129810432", "process_out_blocks": "0", "process_user_time": 2.065192}
[0m10:34:17.089920 [debug] [MainThread]: Command `dbt run` failed at 10:34:17.089830 after 3.02 seconds
[0m10:34:17.090253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f123e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e18310>]}
[0m10:34:17.090578 [debug] [MainThread]: Flushing usage events
[0m10:34:18.050082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:51.485592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e1ff0>]}


============================== 10:34:51.490318 | 54ed63bb-48aa-4da5-adac-21b7223e8601 ==============================
[0m10:34:51.490318 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:34:51.490817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:34:51.510284 [info ] [MainThread]: dbt version: 1.9.4
[0m10:34:51.510628 [info ] [MainThread]: python version: 3.10.3
[0m10:34:51.510827 [info ] [MainThread]: python path: /Users/goonzardw/Developer/bi/dbt3/.venv/bin/python3
[0m10:34:51.511009 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m10:34:51.565630 [info ] [MainThread]: Using profiles dir at /Users/goonzardw/.dbt
[0m10:34:51.565953 [info ] [MainThread]: Using profiles.yml file at /Users/goonzardw/.dbt/profiles.yml
[0m10:34:51.566142 [info ] [MainThread]: Using dbt_project.yml file at /Users/goonzardw/Developer/bi/dbt3/dbt_project.yml
[0m10:34:51.567714 [info ] [MainThread]: adapter type: postgres
[0m10:34:51.568081 [info ] [MainThread]: adapter version: 1.9.0
[0m10:34:51.626447 [info ] [MainThread]: Configuration:
[0m10:34:51.626788 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:34:51.626969 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:34:51.627141 [info ] [MainThread]: Required dependencies:
[0m10:34:51.627498 [debug] [MainThread]: Executing "git --help"
[0m10:34:51.651181 [debug] [MainThread]: STDOUT: "b"\xec\x82\xac\xec\x9a\xa9\xeb\xb2\x95: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\n\xeb\x8b\xa4\xec\x9d\x8c\xec\x9d\x80 \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\x83\x81\xed\x99\xa9\xec\x97\x90\xec\x84\x9c \xec\x9e\x90\xec\xa3\xbc \xec\x82\xac\xec\x9a\xa9\xed\x95\x98\xeb\x8a\x94 \xea\xb9\x83 \xeb\xaa\x85\xeb\xa0\xb9\xec\x9e\x85\xeb\x8b\x88\xeb\x8b\xa4:\n\n\xec\x9e\x91\xec\x97\x85 \xea\xb3\xb5\xea\xb0\x84 \xec\x8b\x9c\xec\x9e\x91 (\xec\xb0\xb8\xea\xb3\xa0: git help tutorial)\n   clone     \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xb3\xb5\xec\xa0\x9c\xed\x95\xb4 \xec\x83\x88 \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac\xeb\xa1\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   init      \xeb\xb9\x88 \xea\xb9\x83 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98 \xea\xb8\xb0\xec\xa1\xb4 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\x8b\xa4\xec\x8b\x9c \xec\xb4\x88\xea\xb8\xb0\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xeb\xb3\x80\xea\xb2\xbd \xec\x82\xac\xed\x95\xad\xec\x97\x90 \xeb\x8c\x80\xed\x95\x9c \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help everyday)\n   add       \xed\x8c\x8c\xec\x9d\xbc \xeb\x82\xb4\xec\x9a\xa9\xec\x9d\x84 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90 \xec\xb6\x94\xea\xb0\x80\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   mv        \xed\x8c\x8c\xec\x9d\xbc, \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac, \xec\x8b\xac\xeb\xb3\xbc\xeb\xa6\xad \xeb\xa7\x81\xed\x81\xac\xeb\xa5\xbc \xec\x98\xae\xea\xb8\xb0\xea\xb1\xb0\xeb\x82\x98 \xec\x9d\xb4\xeb\xa6\x84\xec\x9d\x84 \xeb\xb0\x94\xea\xbf\x89\xeb\x8b\x88\xeb\x8b\xa4\n   restore   Restore working tree files\n   rm        \xed\x8c\x8c\xec\x9d\xbc\xec\x9d\x84 \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94\xec\x97\x90\xec\x84\x9c \xec\xa0\x9c\xea\xb1\xb0\xed\x95\x98\xea\xb3\xa0 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90\xec\x84\x9c\xeb\x8f\x84 \xec\xa0\x9c\xea\xb1\xb0\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xea\xb3\xbc \xec\x83\x81\xed\x83\x9c \xeb\xb3\xb4\xea\xb8\xb0 (\xec\xb0\xb8\xea\xb3\xa0: git help revisions)\n   bisect    \xec\x9d\xb4\xec\xa7\x84 \xed\x83\x90\xec\x83\x89\xec\x9c\xbc\xeb\xa1\x9c \xeb\xb2\x84\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xec\x96\xb4\xeb\x82\xb8 \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xec\xb0\xbe\xec\x8a\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   diff      \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\xbb\xa4\xeb\xb0\x8b \xec\x82\xac\xec\x9d\xb4, \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\x9e\x91\xec\x97\x85 \xeb\x82\xb4\xec\x9a\xa9 \xec\x82\xac\xec\x9d\xb4 \xeb\x93\xb1\xec\x9d\x98 \xeb\xb0\x94\xeb\x80\x90 \xec\xa0\x90\xec\x9d\x84 \xeb\xb4\x85\xeb\x8b\x88\xeb\x8b\xa4\n   grep      \xed\x8c\xa8\xed\x84\xb4\xea\xb3\xbc \xec\x9d\xbc\xec\xb9\x98\xed\x95\x98\xeb\x8a\x94 \xec\xa4\x84\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   log       \xec\xbb\xa4\xeb\xb0\x8b \xea\xb8\xb0\xeb\xa1\x9d\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   show      \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\xa2\x85\xeb\xa5\x98\xec\x9d\x98 \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   status    \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94 \xec\x83\x81\xed\x83\x9c\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x82\xa4\xec\x9a\xb0\xea\xb3\xa0, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb3\xa0, \xec\xa1\xb0\xec\x9e\x91\xed\x95\x98\xea\xb8\xb0\n   branch    \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xeb\xaa\xa9\xeb\xa1\x9d\xec\x9d\x84 \xec\xb6\x9c\xeb\xa0\xa5\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   commit    \xeb\xb0\x94\xeb\x80\x90 \xec\x82\xac\xed\x95\xad\xec\x9d\x84 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90 \xea\xb8\xb0\xeb\xa1\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   merge     \xec\x97\xac\xeb\x9f\xac \xea\xb0\x9c\xec\x9d\x98 \xea\xb0\x9c\xeb\xb0\x9c \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x95\x98\xeb\x82\x98\xeb\xa1\x9c \xed\x95\xa9\xec\xb9\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   rebase    \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xb2\xa0\xec\x9d\xb4\xec\x8a\xa4 \xeb\x81\x9d\xec\x9d\x98 \xec\xb5\x9c\xec\x83\x81\xec\x9c\x84\xec\x97\x90\xec\x84\x9c \xec\xa0\x81\xec\x9a\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   reset     \xed\x98\x84\xec\x9e\xac HEAD\xeb\xa5\xbc \xec\xa7\x80\xec\xa0\x95\xed\x95\x9c \xec\x83\x81\xed\x83\x9c\xeb\xa1\x9c \xec\x9e\xac\xec\x84\xa4\xec\xa0\x95\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   switch    Switch branches\n   tag       \xed\x83\x9c\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, GPG \xec\x84\x9c\xeb\xaa\x85\xec\x9d\x84 \xea\xb2\x80\xec\xa6\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xed\x98\x91\xeb\x8f\x99 \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help workflows)\n   fetch     \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90\xec\x84\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xec\x99\x80 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4\xeb\xa5\xbc \xeb\x8b\xa4\xec\x9a\xb4\xeb\xa1\x9c\xeb\x93\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   pull      \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c \xeb\x98\x90\xeb\x8a\x94 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xa1\x9c\xec\xbb\xac \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xec\x97\x90\xec\x84\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xa4\xea\xb1\xb0\xeb\x82\x98 \xed\x86\xb5\xed\x95\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   push      \xec\x9b\x90\xea\xb2\xa9 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4 \xeb\xb0\x8f \xea\xb7\xb8\xec\x99\x80 \xea\xb4\x80\xeb\xa0\xa8\xeb\x90\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xec\x97\x85\xeb\x8d\xb0\xec\x9d\xb4\xed\x8a\xb8\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:34:51.651956 [debug] [MainThread]: STDERR: "b''"
[0m10:34:51.652194 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:34:51.652423 [info ] [MainThread]: Connection:
[0m10:34:51.652654 [info ] [MainThread]:   host: localhost
[0m10:34:51.652826 [info ] [MainThread]:   port: 5432
[0m10:34:51.652994 [info ] [MainThread]:   user: postgres
[0m10:34:51.653156 [info ] [MainThread]:   database: postgres
[0m10:34:51.653319 [info ] [MainThread]:   schema: bi
[0m10:34:51.653484 [info ] [MainThread]:   connect_timeout: 10
[0m10:34:51.653652 [info ] [MainThread]:   role: None
[0m10:34:51.653813 [info ] [MainThread]:   search_path: None
[0m10:34:51.653973 [info ] [MainThread]:   keepalives_idle: 0
[0m10:34:51.654136 [info ] [MainThread]:   sslmode: None
[0m10:34:51.654297 [info ] [MainThread]:   sslcert: None
[0m10:34:51.654456 [info ] [MainThread]:   sslkey: None
[0m10:34:51.654614 [info ] [MainThread]:   sslrootcert: None
[0m10:34:51.654776 [info ] [MainThread]:   application_name: dbt
[0m10:34:51.654936 [info ] [MainThread]:   retries: 1
[0m10:34:51.655354 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:34:51.732453 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:34:51.822620 [debug] [MainThread]: Using postgres connection "debug"
[0m10:34:51.823023 [debug] [MainThread]: On debug: select 1 as id
[0m10:34:51.823223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:51.864318 [debug] [MainThread]: SQL status: SELECT 1 in 0.041 seconds
[0m10:34:51.865067 [debug] [MainThread]: On debug: Close
[0m10:34:51.865330 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:34:51.865562 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:34:51.870209 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.48398805, "process_in_blocks": "0", "process_kernel_time": 0.206575, "process_mem_max_rss": "118276096", "process_out_blocks": "0", "process_user_time": 0.942278}
[0m10:34:51.870588 [debug] [MainThread]: Command `dbt debug` succeeded at 10:34:51.870509 after 0.48 seconds
[0m10:34:51.870826 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:34:51.871126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066935b0>]}
[0m10:34:51.871517 [debug] [MainThread]: Flushing usage events
[0m10:34:52.728580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:36:47.908018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b99f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ba110>]}


============================== 10:36:47.919233 | 50eab89e-029d-4eda-afea-9261f8294fd1 ==============================
[0m10:36:47.919233 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:36:47.919719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:36:48.060161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108748880>]}
[0m10:36:48.095736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764c700>]}
[0m10:36:48.096620 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:36:48.183226 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:36:48.346121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:36:48.346577 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m10:36:48.506288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109198220>]}
[0m10:36:48.556195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:36:48.572893 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:36:48.591097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109182530>]}
[0m10:36:48.591471 [info ] [MainThread]: Found 1 model, 4 sources, 434 macros
[0m10:36:48.591698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109181a80>]}
[0m10:36:48.592670 [info ] [MainThread]: 
[0m10:36:48.592886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:36:48.593059 [info ] [MainThread]: 
[0m10:36:48.593357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:36:48.593840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:36:48.720198 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:36:48.720559 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:36:48.720746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:48.780983 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.060 seconds
[0m10:36:48.781934 [debug] [ThreadPool]: On list_postgres: Close
[0m10:36:48.782642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m10:36:48.787070 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:36:48.787351 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m10:36:48.787538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:48.803333 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m10:36:48.803650 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:36:48.803881 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m10:36:48.869993 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.066 seconds
[0m10:36:48.871198 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m10:36:48.871985 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m10:36:48.876065 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:48.876427 [debug] [MainThread]: On master: BEGIN
[0m10:36:48.876680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:36:48.891218 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m10:36:48.891576 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:48.891848 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:36:48.932833 [debug] [MainThread]: SQL status: SELECT 0 in 0.041 seconds
[0m10:36:48.934098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fd9030>]}
[0m10:36:48.934503 [debug] [MainThread]: On master: ROLLBACK
[0m10:36:48.935091 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:48.935439 [debug] [MainThread]: On master: BEGIN
[0m10:36:48.936098 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:36:48.936373 [debug] [MainThread]: On master: COMMIT
[0m10:36:48.936602 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:48.936806 [debug] [MainThread]: On master: COMMIT
[0m10:36:48.937212 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:36:48.937432 [debug] [MainThread]: On master: Close
[0m10:36:48.939650 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m10:36:48.940123 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m10:36:48.940507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m10:36:48.940781 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m10:36:48.947929 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m10:36:48.953471 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m10:36:48.981584 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m10:36:48.983569 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:48.983858 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m10:36:48.984268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:36:49.021377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m10:36:49.021774 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:49.022151 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    afn.FUND_CLS as FUND_CLS_TXT,
    afn.FUND_KICD,
    afn.FUND_KICD as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m10:36:49.647335 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 0.624 seconds
[0m10:36:49.659177 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:49.659519 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m10:36:49.660455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:36:49.662407 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:49.662650 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m10:36:49.663475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:36:49.677198 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:36:49.677574 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:49.677826 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:36:49.683376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:36:49.689752 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m10:36:49.693637 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:36:49.693997 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m10:36:49.704588 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m10:36:49.706684 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m10:36:49.712397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50eab89e-029d-4eda-afea-9261f8294fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874abf0>]}
[0m10:36:49.713023 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 0.77s]
[0m10:36:49.713458 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m10:36:49.714225 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:49.714471 [debug] [MainThread]: On master: BEGIN
[0m10:36:49.714673 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:36:49.724738 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:36:49.725109 [debug] [MainThread]: On master: COMMIT
[0m10:36:49.725335 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:49.725541 [debug] [MainThread]: On master: COMMIT
[0m10:36:49.726163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:36:49.726523 [debug] [MainThread]: On master: Close
[0m10:36:49.726875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:49.727085 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m10:36:49.727318 [info ] [MainThread]: 
[0m10:36:49.727552 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m10:36:49.728000 [debug] [MainThread]: Command end result
[0m10:36:49.744651 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:36:49.746431 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:36:49.751805 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m10:36:49.752075 [info ] [MainThread]: 
[0m10:36:49.752367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:36:49.752582 [info ] [MainThread]: 
[0m10:36:49.752807 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:36:49.754682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.909344, "process_in_blocks": "0", "process_kernel_time": 0.250612, "process_mem_max_rss": "130859008", "process_out_blocks": "0", "process_user_time": 1.441583}
[0m10:36:49.755119 [debug] [MainThread]: Command `dbt run` succeeded at 10:36:49.755041 after 1.91 seconds
[0m10:36:49.755484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091df190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109181d80>]}
[0m10:36:49.755794 [debug] [MainThread]: Flushing usage events
[0m10:36:50.702892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:38:21.524320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104020cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051219c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051220e0>]}


============================== 10:38:21.529042 | 86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e ==============================
[0m10:38:21.529042 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:38:21.529414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'debug': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:38:21.671929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10507a2c0>]}
[0m10:38:21.705795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055048e0>]}
[0m10:38:21.706686 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:38:21.787221 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:38:21.913339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:38:21.913774 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m10:38:22.072897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e81c0>]}
[0m10:38:22.122566 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:38:22.127135 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:38:22.161741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060dc040>]}
[0m10:38:22.162136 [info ] [MainThread]: Found 1 model, 4 sources, 434 macros
[0m10:38:22.162370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552d7e0>]}
[0m10:38:22.163394 [info ] [MainThread]: 
[0m10:38:22.163629 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:38:22.163810 [info ] [MainThread]: 
[0m10:38:22.164119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:38:22.164627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:38:22.275927 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:38:22.276239 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:38:22.276425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:22.331068 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.055 seconds
[0m10:38:22.332023 [debug] [ThreadPool]: On list_postgres: Close
[0m10:38:22.332708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m10:38:22.336837 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:38:22.337083 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m10:38:22.337266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:22.348301 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m10:38:22.348607 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:38:22.348825 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m10:38:22.369441 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.020 seconds
[0m10:38:22.370385 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m10:38:22.371187 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m10:38:22.374500 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:22.374834 [debug] [MainThread]: On master: BEGIN
[0m10:38:22.375043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:22.392073 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m10:38:22.392449 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:22.392754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:38:22.414551 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m10:38:22.415633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f33520>]}
[0m10:38:22.416019 [debug] [MainThread]: On master: ROLLBACK
[0m10:38:22.420052 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:22.420330 [debug] [MainThread]: On master: BEGIN
[0m10:38:22.421154 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:38:22.421395 [debug] [MainThread]: On master: COMMIT
[0m10:38:22.421624 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:22.421836 [debug] [MainThread]: On master: COMMIT
[0m10:38:22.422834 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:38:22.423085 [debug] [MainThread]: On master: Close
[0m10:38:22.425258 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m10:38:22.425697 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m10:38:22.426059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m10:38:22.426326 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m10:38:22.434276 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m10:38:22.437695 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m10:38:22.466270 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m10:38:22.475166 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:22.475532 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m10:38:22.475767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:22.494676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:38:22.495050 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:22.495439 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    afn.INVT_TYPE as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    afn.INVT_ASET_TYPE as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    afn.INVT_TRGT_LCTN_AREA as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    afn.INVT_STTG as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    afn.INVT_TRGT_ASET as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    afn.DMAB_CLS as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    afn.PO_PE_CLS as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    afn.MOJA_CLS as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    afn.MULTI_CLAS_CLS as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    afn.FUND_STRR as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    afn.LOAN_INVT_TYPE as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    afn.AGCO as AGCO_TXT,
    afn.CNCO,
    afn.CNCO as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m10:38:24.336284 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 1.840 seconds
[0m10:38:24.347591 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:24.347946 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m10:38:24.348826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:38:24.350716 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:24.350960 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m10:38:24.351799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:38:24.365510 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:38:24.365860 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:24.366115 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:38:24.371769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:38:24.377588 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m10:38:24.381399 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:38:24.381830 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m10:38:24.389907 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m10:38:24.392036 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m10:38:24.394474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86847a9a-8ce5-41bd-8fbc-4d8f01c5e79e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060726b0>]}
[0m10:38:24.395114 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 1.97s]
[0m10:38:24.395553 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m10:38:24.396287 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:24.396520 [debug] [MainThread]: On master: BEGIN
[0m10:38:24.396719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:24.409847 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:38:24.410201 [debug] [MainThread]: On master: COMMIT
[0m10:38:24.410417 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:24.410608 [debug] [MainThread]: On master: COMMIT
[0m10:38:24.410992 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:38:24.411240 [debug] [MainThread]: On master: Close
[0m10:38:24.411679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:24.411976 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m10:38:24.412200 [info ] [MainThread]: 
[0m10:38:24.412428 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m10:38:24.412868 [debug] [MainThread]: Command end result
[0m10:38:24.431207 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:38:24.441855 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:38:24.467382 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m10:38:24.467821 [info ] [MainThread]: 
[0m10:38:24.468182 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:38:24.468444 [info ] [MainThread]: 
[0m10:38:24.468714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:38:24.470975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0064657, "process_in_blocks": "0", "process_kernel_time": 0.245157, "process_mem_max_rss": "131104768", "process_out_blocks": "0", "process_user_time": 1.427975}
[0m10:38:24.471399 [debug] [MainThread]: Command `dbt run` succeeded at 10:38:24.471319 after 3.01 seconds
[0m10:38:24.471744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104020cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c91990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106568f70>]}
[0m10:38:24.472079 [debug] [MainThread]: Flushing usage events
[0m10:38:25.344518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:02.587070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e60ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aee5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aee60b0>]}


============================== 10:44:02.591960 | 64f8c766-40e7-46c4-9a96-0f077e4869a5 ==============================
[0m10:44:02.591960 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:44:02.592371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:44:02.739803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766a350>]}
[0m10:44:02.773403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b32f370>]}
[0m10:44:02.774380 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:44:02.881764 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:44:03.008966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:44:03.009409 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m10:44:03.173251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd9c160>]}
[0m10:44:03.226089 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:44:03.233261 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:44:03.253331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbc15a0>]}
[0m10:44:03.253715 [info ] [MainThread]: Found 1 model, 4 sources, 434 macros
[0m10:44:03.253944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbc1540>]}
[0m10:44:03.255018 [info ] [MainThread]: 
[0m10:44:03.255240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:44:03.255417 [info ] [MainThread]: 
[0m10:44:03.255736 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:44:03.256236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:44:03.440056 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:44:03.440366 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:44:03.440567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:03.530871 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.090 seconds
[0m10:44:03.531909 [debug] [ThreadPool]: On list_postgres: Close
[0m10:44:03.532904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_bi_staging'
[0m10:44:03.537629 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:44:03.537950 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m10:44:03.538157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:03.553591 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m10:44:03.553979 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m10:44:03.554225 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m10:44:03.582458 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.028 seconds
[0m10:44:03.583668 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m10:44:03.584609 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m10:44:03.588377 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:03.588678 [debug] [MainThread]: On master: BEGIN
[0m10:44:03.588902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:03.604554 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:44:03.604870 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:03.605169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:44:03.633099 [debug] [MainThread]: SQL status: SELECT 0 in 0.028 seconds
[0m10:44:03.634325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbe4520>]}
[0m10:44:03.634751 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:03.635497 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:03.635773 [debug] [MainThread]: On master: BEGIN
[0m10:44:03.636590 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:44:03.636898 [debug] [MainThread]: On master: COMMIT
[0m10:44:03.637158 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:03.637399 [debug] [MainThread]: On master: COMMIT
[0m10:44:03.637922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:03.638180 [debug] [MainThread]: On master: Close
[0m10:44:03.640559 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m10:44:03.640995 [info ] [Thread-1 (]: 1 of 1 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m10:44:03.641361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres, now model.fund_dbt_project.stg_fund_master)
[0m10:44:03.641653 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m10:44:03.652833 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m10:44:03.653767 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m10:44:03.682468 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m10:44:03.683376 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:03.683686 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m10:44:03.683903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:03.702508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:44:03.702890 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:03.703303 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m10:44:12.761643 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.057 seconds
[0m10:44:12.773769 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:12.774135 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m10:44:12.775114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:12.777057 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:12.777297 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m10:44:12.778205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:12.792160 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:44:12.792525 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:12.792772 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m10:44:12.797634 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:44:12.802320 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m10:44:12.805321 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m10:44:12.805634 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m10:44:12.816771 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m10:44:12.818750 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m10:44:12.820330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f8c766-40e7-46c4-9a96-0f077e4869a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b39c580>]}
[0m10:44:12.820846 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.18s]
[0m10:44:12.821258 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m10:44:12.822033 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:12.822318 [debug] [MainThread]: On master: BEGIN
[0m10:44:12.822537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:12.835219 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:44:12.835642 [debug] [MainThread]: On master: COMMIT
[0m10:44:12.835873 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:12.836077 [debug] [MainThread]: On master: COMMIT
[0m10:44:12.836581 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:12.836825 [debug] [MainThread]: On master: Close
[0m10:44:12.837213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:12.837543 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m10:44:12.837754 [debug] [MainThread]: Connection 'list_postgres_bi_staging' was properly closed.
[0m10:44:12.837988 [info ] [MainThread]: 
[0m10:44:12.838226 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.58 seconds (9.58s).
[0m10:44:12.838679 [debug] [MainThread]: Command end result
[0m10:44:12.855436 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m10:44:12.857187 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m10:44:12.863648 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m10:44:12.863895 [info ] [MainThread]: 
[0m10:44:12.864186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:12.864401 [info ] [MainThread]: 
[0m10:44:12.864620 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:44:12.866492 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.361502, "process_in_blocks": "0", "process_kernel_time": 0.254575, "process_mem_max_rss": "131497984", "process_out_blocks": "0", "process_user_time": 1.447818}
[0m10:44:12.867030 [debug] [MainThread]: Command `dbt run` succeeded at 10:44:12.866918 after 10.36 seconds
[0m10:44:12.867418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e60ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd4d030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766a350>]}
[0m10:44:12.867821 [debug] [MainThread]: Flushing usage events
[0m10:44:13.749258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:26.818841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105817850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105817130>]}


============================== 15:29:26.862688 | 56521baf-4524-4634-8618-f56f26234f4d ==============================
[0m15:29:26.862688 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:29:26.863067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:26.939669 [info ] [MainThread]: dbt version: 1.9.4
[0m15:29:26.940006 [info ] [MainThread]: python version: 3.10.3
[0m15:29:26.940205 [info ] [MainThread]: python path: /Users/goonzardw/Developer/bi/dbt3/.venv/bin/python3
[0m15:29:26.940382 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m15:29:27.156812 [info ] [MainThread]: Using profiles dir at /Users/goonzardw/.dbt
[0m15:29:27.157156 [info ] [MainThread]: Using profiles.yml file at /Users/goonzardw/.dbt/profiles.yml
[0m15:29:27.157348 [info ] [MainThread]: Using dbt_project.yml file at /Users/goonzardw/Developer/bi/dbt3/dbt_project.yml
[0m15:29:27.158808 [info ] [MainThread]: adapter type: postgres
[0m15:29:27.159002 [info ] [MainThread]: adapter version: 1.9.0
[0m15:29:27.217827 [info ] [MainThread]: Configuration:
[0m15:29:27.218196 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:29:27.218383 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:29:27.218552 [info ] [MainThread]: Required dependencies:
[0m15:29:27.218995 [debug] [MainThread]: Executing "git --help"
[0m15:29:27.244795 [debug] [MainThread]: STDOUT: "b"\xec\x82\xac\xec\x9a\xa9\xeb\xb2\x95: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\n\xeb\x8b\xa4\xec\x9d\x8c\xec\x9d\x80 \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\x83\x81\xed\x99\xa9\xec\x97\x90\xec\x84\x9c \xec\x9e\x90\xec\xa3\xbc \xec\x82\xac\xec\x9a\xa9\xed\x95\x98\xeb\x8a\x94 \xea\xb9\x83 \xeb\xaa\x85\xeb\xa0\xb9\xec\x9e\x85\xeb\x8b\x88\xeb\x8b\xa4:\n\n\xec\x9e\x91\xec\x97\x85 \xea\xb3\xb5\xea\xb0\x84 \xec\x8b\x9c\xec\x9e\x91 (\xec\xb0\xb8\xea\xb3\xa0: git help tutorial)\n   clone     \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xb3\xb5\xec\xa0\x9c\xed\x95\xb4 \xec\x83\x88 \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac\xeb\xa1\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   init      \xeb\xb9\x88 \xea\xb9\x83 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98 \xea\xb8\xb0\xec\xa1\xb4 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\x8b\xa4\xec\x8b\x9c \xec\xb4\x88\xea\xb8\xb0\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xeb\xb3\x80\xea\xb2\xbd \xec\x82\xac\xed\x95\xad\xec\x97\x90 \xeb\x8c\x80\xed\x95\x9c \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help everyday)\n   add       \xed\x8c\x8c\xec\x9d\xbc \xeb\x82\xb4\xec\x9a\xa9\xec\x9d\x84 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90 \xec\xb6\x94\xea\xb0\x80\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   mv        \xed\x8c\x8c\xec\x9d\xbc, \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac, \xec\x8b\xac\xeb\xb3\xbc\xeb\xa6\xad \xeb\xa7\x81\xed\x81\xac\xeb\xa5\xbc \xec\x98\xae\xea\xb8\xb0\xea\xb1\xb0\xeb\x82\x98 \xec\x9d\xb4\xeb\xa6\x84\xec\x9d\x84 \xeb\xb0\x94\xea\xbf\x89\xeb\x8b\x88\xeb\x8b\xa4\n   restore   Restore working tree files\n   rm        \xed\x8c\x8c\xec\x9d\xbc\xec\x9d\x84 \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94\xec\x97\x90\xec\x84\x9c \xec\xa0\x9c\xea\xb1\xb0\xed\x95\x98\xea\xb3\xa0 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90\xec\x84\x9c\xeb\x8f\x84 \xec\xa0\x9c\xea\xb1\xb0\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xea\xb3\xbc \xec\x83\x81\xed\x83\x9c \xeb\xb3\xb4\xea\xb8\xb0 (\xec\xb0\xb8\xea\xb3\xa0: git help revisions)\n   bisect    \xec\x9d\xb4\xec\xa7\x84 \xed\x83\x90\xec\x83\x89\xec\x9c\xbc\xeb\xa1\x9c \xeb\xb2\x84\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xec\x96\xb4\xeb\x82\xb8 \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xec\xb0\xbe\xec\x8a\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   diff      \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\xbb\xa4\xeb\xb0\x8b \xec\x82\xac\xec\x9d\xb4, \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\x9e\x91\xec\x97\x85 \xeb\x82\xb4\xec\x9a\xa9 \xec\x82\xac\xec\x9d\xb4 \xeb\x93\xb1\xec\x9d\x98 \xeb\xb0\x94\xeb\x80\x90 \xec\xa0\x90\xec\x9d\x84 \xeb\xb4\x85\xeb\x8b\x88\xeb\x8b\xa4\n   grep      \xed\x8c\xa8\xed\x84\xb4\xea\xb3\xbc \xec\x9d\xbc\xec\xb9\x98\xed\x95\x98\xeb\x8a\x94 \xec\xa4\x84\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   log       \xec\xbb\xa4\xeb\xb0\x8b \xea\xb8\xb0\xeb\xa1\x9d\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   show      \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\xa2\x85\xeb\xa5\x98\xec\x9d\x98 \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   status    \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94 \xec\x83\x81\xed\x83\x9c\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x82\xa4\xec\x9a\xb0\xea\xb3\xa0, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb3\xa0, \xec\xa1\xb0\xec\x9e\x91\xed\x95\x98\xea\xb8\xb0\n   branch    \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xeb\xaa\xa9\xeb\xa1\x9d\xec\x9d\x84 \xec\xb6\x9c\xeb\xa0\xa5\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   commit    \xeb\xb0\x94\xeb\x80\x90 \xec\x82\xac\xed\x95\xad\xec\x9d\x84 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90 \xea\xb8\xb0\xeb\xa1\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   merge     \xec\x97\xac\xeb\x9f\xac \xea\xb0\x9c\xec\x9d\x98 \xea\xb0\x9c\xeb\xb0\x9c \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x95\x98\xeb\x82\x98\xeb\xa1\x9c \xed\x95\xa9\xec\xb9\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   rebase    \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xb2\xa0\xec\x9d\xb4\xec\x8a\xa4 \xeb\x81\x9d\xec\x9d\x98 \xec\xb5\x9c\xec\x83\x81\xec\x9c\x84\xec\x97\x90\xec\x84\x9c \xec\xa0\x81\xec\x9a\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   reset     \xed\x98\x84\xec\x9e\xac HEAD\xeb\xa5\xbc \xec\xa7\x80\xec\xa0\x95\xed\x95\x9c \xec\x83\x81\xed\x83\x9c\xeb\xa1\x9c \xec\x9e\xac\xec\x84\xa4\xec\xa0\x95\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   switch    Switch branches\n   tag       \xed\x83\x9c\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, GPG \xec\x84\x9c\xeb\xaa\x85\xec\x9d\x84 \xea\xb2\x80\xec\xa6\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xed\x98\x91\xeb\x8f\x99 \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help workflows)\n   fetch     \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90\xec\x84\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xec\x99\x80 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4\xeb\xa5\xbc \xeb\x8b\xa4\xec\x9a\xb4\xeb\xa1\x9c\xeb\x93\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   pull      \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c \xeb\x98\x90\xeb\x8a\x94 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xa1\x9c\xec\xbb\xac \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xec\x97\x90\xec\x84\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xa4\xea\xb1\xb0\xeb\x82\x98 \xed\x86\xb5\xed\x95\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   push      \xec\x9b\x90\xea\xb2\xa9 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4 \xeb\xb0\x8f \xea\xb7\xb8\xec\x99\x80 \xea\xb4\x80\xeb\xa0\xa8\xeb\x90\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xec\x97\x85\xeb\x8d\xb0\xec\x9d\xb4\xed\x8a\xb8\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:29:27.245601 [debug] [MainThread]: STDERR: "b''"
[0m15:29:27.245828 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:29:27.246039 [info ] [MainThread]: Connection:
[0m15:29:27.246263 [info ] [MainThread]:   host: localhost
[0m15:29:27.246434 [info ] [MainThread]:   port: 5432
[0m15:29:27.246596 [info ] [MainThread]:   user: postgres
[0m15:29:27.246760 [info ] [MainThread]:   database: postgres
[0m15:29:27.246918 [info ] [MainThread]:   schema: bi
[0m15:29:27.247077 [info ] [MainThread]:   connect_timeout: 10
[0m15:29:27.247237 [info ] [MainThread]:   role: None
[0m15:29:27.247396 [info ] [MainThread]:   search_path: None
[0m15:29:27.247553 [info ] [MainThread]:   keepalives_idle: 0
[0m15:29:27.247709 [info ] [MainThread]:   sslmode: None
[0m15:29:27.247867 [info ] [MainThread]:   sslcert: None
[0m15:29:27.248024 [info ] [MainThread]:   sslkey: None
[0m15:29:27.248180 [info ] [MainThread]:   sslrootcert: None
[0m15:29:27.248334 [info ] [MainThread]:   application_name: dbt
[0m15:29:27.248488 [info ] [MainThread]:   retries: 1
[0m15:29:27.248909 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:27.385025 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:29:28.640905 [debug] [MainThread]: Using postgres connection "debug"
[0m15:29:28.641215 [debug] [MainThread]: On debug: select 1 as id
[0m15:29:28.641391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:28.965766 [debug] [MainThread]: SQL status: SELECT 1 in 0.324 seconds
[0m15:29:28.966470 [debug] [MainThread]: On debug: Close
[0m15:29:28.966709 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:29:28.966925 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:29:28.989823 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.249756, "process_in_blocks": "0", "process_kernel_time": 0.447539, "process_mem_max_rss": "118980608", "process_out_blocks": "0", "process_user_time": 1.202857}
[0m15:29:28.990254 [debug] [MainThread]: Command `dbt debug` succeeded at 15:29:28.990181 after 2.25 seconds
[0m15:29:28.990496 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:29:28.990733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8b3d0>]}
[0m15:29:28.991191 [debug] [MainThread]: Flushing usage events
[0m15:29:29.899380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:33.626932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d159f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d16110>]}


============================== 15:29:33.630607 | 68dc32a6-a5fa-47ae-80ce-9a2a8da9040b ==============================
[0m15:29:33.630607 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:29:33.630972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:29:33.764334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68dc32a6-a5fa-47ae-80ce-9a2a8da9040b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a8880>]}
[0m15:29:33.800598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68dc32a6-a5fa-47ae-80ce-9a2a8da9040b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6c700>]}
[0m15:29:33.801300 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:33.896392 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:29:34.243486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:29:34.243900 [debug] [MainThread]: Partial parsing: added file: fund_dbt_project://models/staging/stg_fund_revenue.sql
[0m15:29:34.244220 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/schema.yml
[0m15:29:34.461616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68dc32a6-a5fa-47ae-80ce-9a2a8da9040b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce7490>]}
[0m15:29:34.561659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m15:29:34.570327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m15:29:34.599408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68dc32a6-a5fa-47ae-80ce-9a2a8da9040b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4d930>]}
[0m15:29:34.599798 [info ] [MainThread]: Found 2 models, 7 sources, 434 macros
[0m15:29:34.600031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68dc32a6-a5fa-47ae-80ce-9a2a8da9040b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bae1a0>]}
[0m15:29:34.601008 [info ] [MainThread]: 
[0m15:29:34.601236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:34.601416 [info ] [MainThread]: 
[0m15:29:34.601716 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:34.604335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:29:34.673024 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:29:34.673602 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:29:34.673862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:34.790452 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.117 seconds
[0m15:29:34.791535 [debug] [ThreadPool]: On list_postgres: Close
[0m15:29:34.792340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m15:29:34.796156 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m15:29:34.796471 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m15:29:34.796670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:34.816504 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m15:29:34.816855 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m15:29:34.817058 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m15:29:34.937852 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.121 seconds
[0m15:29:34.938824 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m15:29:34.939567 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m15:29:34.942725 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:34.943007 [debug] [MainThread]: On master: BEGIN
[0m15:29:34.943199 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:34.952501 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:29:34.952827 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:34.953086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:29:34.976046 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m15:29:34.976958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68dc32a6-a5fa-47ae-80ce-9a2a8da9040b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109be3fa0>]}
[0m15:29:34.977259 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:34.977951 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:34.978703 [debug] [MainThread]: On master: BEGIN
[0m15:29:34.979705 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:29:34.980285 [debug] [MainThread]: On master: COMMIT
[0m15:29:34.980989 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:34.981533 [debug] [MainThread]: On master: COMMIT
[0m15:29:34.986032 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m15:29:34.986864 [debug] [MainThread]: On master: Close
[0m15:29:35.003759 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m15:29:35.004718 [info ] [Thread-1 (]: 1 of 2 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m15:29:35.005115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m15:29:35.005343 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m15:29:35.014853 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m15:29:35.019121 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m15:29:35.045644 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m15:29:35.048029 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:29:35.048354 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m15:29:35.048576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:35.064027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m15:29:35.064333 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:29:35.064702 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m15:29:44.590992 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.528 seconds
[0m15:29:44.598146 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:29:44.598493 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m15:29:44.599458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:44.601163 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:29:44.601398 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m15:29:44.602441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:44.615385 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m15:29:44.615752 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:29:44.615975 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m15:29:44.621620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:29:44.625598 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m15:29:44.627981 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:29:44.628226 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m15:29:44.675233 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.047 seconds
[0m15:29:44.677047 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m15:29:44.685101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68dc32a6-a5fa-47ae-80ce-9a2a8da9040b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5afe0>]}
[0m15:29:44.685686 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.67s]
[0m15:29:44.686072 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m15:29:44.686335 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_revenue
[0m15:29:44.686710 [info ] [Thread-1 (]: 2 of 2 START sql table model bi_staging.stg_fund_revenue ....................... [RUN]
[0m15:29:44.687082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.stg_fund_revenue)
[0m15:29:44.687331 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_revenue
[0m15:29:44.689528 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_revenue"
[0m15:29:44.690087 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_revenue
[0m15:29:44.692917 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_revenue"
[0m15:29:44.693405 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:29:44.693625 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: BEGIN
[0m15:29:44.693825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:44.701956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:29:44.702300 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:29:44.702521 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp"
  
  
    as
  
  (
    with acct as (
    select "ACCD_CD" from "postgres"."igisam"."accd"
    where "CNT_ACCT_DIV" > '2'
)

select 
  acct."ACCT_CD"
from acct
;
  );
  
[0m15:29:44.703087 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: ;
         ^

[0m15:29:44.703405 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: ROLLBACK
[0m15:29:44.703962 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: Close
[0m15:29:44.742530 [debug] [Thread-1 (]: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  syntax error at or near ";"
  LINE 20: ;
           ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m15:29:44.742996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68dc32a6-a5fa-47ae-80ce-9a2a8da9040b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107502b30>]}
[0m15:29:44.743404 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model bi_staging.stg_fund_revenue .............. [[31mERROR[0m in 0.06s]
[0m15:29:44.743751 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_revenue
[0m15:29:44.744056 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_revenue' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  syntax error at or near ";"
  LINE 20: ;
           ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql.
[0m15:29:44.745066 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:44.745285 [debug] [MainThread]: On master: BEGIN
[0m15:29:44.745460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:29:44.754471 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:29:44.754806 [debug] [MainThread]: On master: COMMIT
[0m15:29:44.755010 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:44.755182 [debug] [MainThread]: On master: COMMIT
[0m15:29:44.755643 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:44.755873 [debug] [MainThread]: On master: Close
[0m15:29:44.756160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:44.756347 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_revenue' was properly closed.
[0m15:29:44.756584 [info ] [MainThread]: 
[0m15:29:44.756798 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 10.15 seconds (10.15s).
[0m15:29:44.757290 [debug] [MainThread]: Command end result
[0m15:29:44.772256 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m15:29:44.773665 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m15:29:44.781147 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m15:29:44.781440 [info ] [MainThread]: 
[0m15:29:44.781692 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:29:44.781945 [info ] [MainThread]: 
[0m15:29:44.782199 [error] [MainThread]:   Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  syntax error at or near ";"
  LINE 20: ;
           ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m15:29:44.782401 [info ] [MainThread]: 
[0m15:29:44.782600 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:29:44.785571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.217156, "process_in_blocks": "0", "process_kernel_time": 0.201053, "process_mem_max_rss": "132857856", "process_out_blocks": "0", "process_user_time": 1.492379}
[0m15:29:44.785883 [debug] [MainThread]: Command `dbt run` failed at 15:29:44.785820 after 11.22 seconds
[0m15:29:44.786152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ec6e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109be9a80>]}
[0m15:29:44.786407 [debug] [MainThread]: Flushing usage events
[0m15:29:45.591549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:53.313975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103820d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e59f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e6110>]}


============================== 15:29:53.319440 | 911e03eb-08c4-41c7-9b75-1235b60477cd ==============================
[0m15:29:53.319440 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:29:53.319798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:53.444207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '911e03eb-08c4-41c7-9b75-1235b60477cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c84880>]}
[0m15:29:53.479592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '911e03eb-08c4-41c7-9b75-1235b60477cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038c4700>]}
[0m15:29:53.481911 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:53.559206 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:29:53.676475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:29:53.676938 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_revenue.sql
[0m15:29:53.834400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '911e03eb-08c4-41c7-9b75-1235b60477cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c3fa0>]}
[0m15:29:53.885003 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m15:29:53.890747 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m15:29:53.911328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '911e03eb-08c4-41c7-9b75-1235b60477cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d8460>]}
[0m15:29:53.911689 [info ] [MainThread]: Found 2 models, 7 sources, 434 macros
[0m15:29:53.911914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '911e03eb-08c4-41c7-9b75-1235b60477cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054dbcd0>]}
[0m15:29:53.912869 [info ] [MainThread]: 
[0m15:29:53.913094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:53.913271 [info ] [MainThread]: 
[0m15:29:53.913581 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:53.916229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:29:54.020057 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:29:54.020376 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:29:54.020567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:54.054592 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.034 seconds
[0m15:29:54.055490 [debug] [ThreadPool]: On list_postgres: Close
[0m15:29:54.056296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m15:29:54.060414 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m15:29:54.060681 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m15:29:54.060861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:54.074730 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m15:29:54.075024 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m15:29:54.075230 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m15:29:54.094855 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.019 seconds
[0m15:29:54.095682 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m15:29:54.098593 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m15:29:54.101397 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:54.101621 [debug] [MainThread]: On master: BEGIN
[0m15:29:54.101801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:54.111507 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:29:54.111821 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:54.112071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:29:54.159924 [debug] [MainThread]: SQL status: SELECT 0 in 0.048 seconds
[0m15:29:54.160911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '911e03eb-08c4-41c7-9b75-1235b60477cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105527a30>]}
[0m15:29:54.161221 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:54.162268 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:54.162464 [debug] [MainThread]: On master: BEGIN
[0m15:29:54.167526 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:29:54.167741 [debug] [MainThread]: On master: COMMIT
[0m15:29:54.167922 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:54.168091 [debug] [MainThread]: On master: COMMIT
[0m15:29:54.168814 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:29:54.169058 [debug] [MainThread]: On master: Close
[0m15:29:54.171311 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m15:29:54.171739 [info ] [Thread-1 (]: 1 of 2 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m15:29:54.172049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m15:29:54.172268 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m15:29:54.181162 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m15:29:54.182055 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m15:29:54.205655 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m15:29:54.206640 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:29:54.206935 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m15:29:54.207135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:54.223590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:29:54.223932 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:29:54.224318 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m15:30:03.262247 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.038 seconds
[0m15:30:03.274093 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:30:03.274528 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m15:30:03.275559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:30:03.277417 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:30:03.277647 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m15:30:03.278983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:30:03.289417 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m15:30:03.289724 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:30:03.289949 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m15:30:03.292512 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:30:03.296256 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m15:30:03.298758 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:30:03.299009 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m15:30:03.303783 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:30:03.305482 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m15:30:03.306875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911e03eb-08c4-41c7-9b75-1235b60477cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5d870>]}
[0m15:30:03.307405 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.13s]
[0m15:30:03.307770 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m15:30:03.308034 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_revenue
[0m15:30:03.308381 [info ] [Thread-1 (]: 2 of 2 START sql table model bi_staging.stg_fund_revenue ....................... [RUN]
[0m15:30:03.308710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.stg_fund_revenue)
[0m15:30:03.308947 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_revenue
[0m15:30:03.310874 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_revenue"
[0m15:30:03.311553 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_revenue
[0m15:30:03.313549 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_revenue"
[0m15:30:03.316395 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:30:03.316682 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: BEGIN
[0m15:30:03.316904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:03.325021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:30:03.325352 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:30:03.325666 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp"
  
  
    as
  
  (
    with acct as (
    select "ACCD_CD" from "postgres"."igisam"."accd"
    where "CNT_ACCT_DIV" > '2'
)

select 
  acct."ACCT_CD"
from acct
  );
  
[0m15:30:03.326459 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "igisam.accd" does not exist
LINE 13:     select "ACCD_CD" from "postgres"."igisam"."accd"
                                   ^

[0m15:30:03.326705 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: ROLLBACK
[0m15:30:03.327292 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: Close
[0m15:30:03.333217 [debug] [Thread-1 (]: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  relation "igisam.accd" does not exist
  LINE 13:     select "ACCD_CD" from "postgres"."igisam"."accd"
                                     ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m15:30:03.333625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '911e03eb-08c4-41c7-9b75-1235b60477cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10308eb30>]}
[0m15:30:03.334050 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model bi_staging.stg_fund_revenue .............. [[31mERROR[0m in 0.02s]
[0m15:30:03.334421 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_revenue
[0m15:30:03.334729 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_revenue' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  relation "igisam.accd" does not exist
  LINE 13:     select "ACCD_CD" from "postgres"."igisam"."accd"
                                     ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql.
[0m15:30:03.335763 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:03.335950 [debug] [MainThread]: On master: BEGIN
[0m15:30:03.336112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:03.344430 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:30:03.344731 [debug] [MainThread]: On master: COMMIT
[0m15:30:03.344915 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:03.345081 [debug] [MainThread]: On master: COMMIT
[0m15:30:03.345523 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:30:03.345837 [debug] [MainThread]: On master: Close
[0m15:30:03.346119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:03.346300 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_revenue' was properly closed.
[0m15:30:03.346551 [info ] [MainThread]: 
[0m15:30:03.346842 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.43 seconds (9.43s).
[0m15:30:03.347367 [debug] [MainThread]: Command end result
[0m15:30:03.362279 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m15:30:03.366210 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m15:30:03.370862 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m15:30:03.371116 [info ] [MainThread]: 
[0m15:30:03.371348 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:30:03.371550 [info ] [MainThread]: 
[0m15:30:03.371782 [error] [MainThread]:   Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  relation "igisam.accd" does not exist
  LINE 13:     select "ACCD_CD" from "postgres"."igisam"."accd"
                                     ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m15:30:03.371966 [info ] [MainThread]: 
[0m15:30:03.372157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:30:03.373435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.112675, "process_in_blocks": "0", "process_kernel_time": 0.204978, "process_mem_max_rss": "132448256", "process_out_blocks": "0", "process_user_time": 1.417227}
[0m15:30:03.373756 [debug] [MainThread]: Command `dbt run` failed at 15:30:03.373704 after 10.11 seconds
[0m15:30:03.373995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103820d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d97e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c2a40>]}
[0m15:30:03.374217 [debug] [MainThread]: Flushing usage events
[0m15:30:04.224220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:35.703412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e5930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e6050>]}


============================== 15:31:35.709453 | 9a1e9376-8564-4c84-9a3d-3416b0383f3a ==============================
[0m15:31:35.709453 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:31:35.709995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:31:35.845281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a1e9376-8564-4c84-9a3d-3416b0383f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab0c550>]}
[0m15:31:35.879569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a1e9376-8564-4c84-9a3d-3416b0383f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10916dfc0>]}
[0m15:31:35.880643 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:31:35.958884 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:31:36.088393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:36.088710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:36.112646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a1e9376-8564-4c84-9a3d-3416b0383f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af48d90>]}
[0m15:31:36.165782 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m15:31:36.172985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m15:31:36.193427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a1e9376-8564-4c84-9a3d-3416b0383f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af4a320>]}
[0m15:31:36.193817 [info ] [MainThread]: Found 2 models, 7 sources, 434 macros
[0m15:31:36.194057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1e9376-8564-4c84-9a3d-3416b0383f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abd8c70>]}
[0m15:31:36.195198 [info ] [MainThread]: 
[0m15:31:36.195438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:31:36.195615 [info ] [MainThread]: 
[0m15:31:36.195929 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:36.198575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:31:36.273318 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:31:36.273623 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:31:36.273811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:36.316709 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.043 seconds
[0m15:31:36.317628 [debug] [ThreadPool]: On list_postgres: Close
[0m15:31:36.318340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m15:31:36.322118 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m15:31:36.322369 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m15:31:36.322540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:36.331694 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:31:36.331990 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m15:31:36.332183 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m15:31:36.344143 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m15:31:36.345062 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m15:31:36.345573 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m15:31:36.348612 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:36.348855 [debug] [MainThread]: On master: BEGIN
[0m15:31:36.349030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:36.359638 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:31:36.359903 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:36.360159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:31:36.369881 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:31:36.370583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1e9376-8564-4c84-9a3d-3416b0383f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af6e800>]}
[0m15:31:36.370885 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:36.371411 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:36.371588 [debug] [MainThread]: On master: BEGIN
[0m15:31:36.372354 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:31:36.372584 [debug] [MainThread]: On master: COMMIT
[0m15:31:36.372775 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:36.372945 [debug] [MainThread]: On master: COMMIT
[0m15:31:36.373381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:31:36.373731 [debug] [MainThread]: On master: Close
[0m15:31:36.376027 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m15:31:36.376414 [info ] [Thread-1 (]: 1 of 2 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m15:31:36.376725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m15:31:36.376942 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m15:31:36.386118 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m15:31:36.387481 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m15:31:36.411005 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m15:31:36.412195 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:31:36.412517 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m15:31:36.412732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:36.426066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:31:36.426420 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:31:36.426831 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m15:31:45.573377 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.146 seconds
[0m15:31:45.585593 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:31:45.585921 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m15:31:45.586875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:45.618320 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:31:45.618661 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m15:31:45.619847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:45.630075 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m15:31:45.630421 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:31:45.630660 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m15:31:45.645321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m15:31:45.649423 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m15:31:45.651968 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:31:45.652217 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m15:31:45.661893 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m15:31:45.663641 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m15:31:45.665239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1e9376-8564-4c84-9a3d-3416b0383f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b371630>]}
[0m15:31:45.665781 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.29s]
[0m15:31:45.666193 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m15:31:45.666439 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_revenue
[0m15:31:45.666762 [info ] [Thread-1 (]: 2 of 2 START sql table model bi_staging.stg_fund_revenue ....................... [RUN]
[0m15:31:45.667043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.stg_fund_revenue)
[0m15:31:45.667262 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_revenue
[0m15:31:45.669186 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_revenue"
[0m15:31:45.669815 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_revenue
[0m15:31:45.671823 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_revenue"
[0m15:31:45.672601 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:31:45.672920 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: BEGIN
[0m15:31:45.673140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:45.685657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:31:45.686041 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:31:45.686283 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp"
  
  
    as
  
  (
    with acct as (
    select "ACCD_CD" from "postgres"."igisam"."accd"
    where "CNT_ACCT_DIV" > '2'
)

select 
  acct."ACCT_CD"
from acct
  );
  
[0m15:31:45.686969 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "igisam.accd" does not exist
LINE 13:     select "ACCD_CD" from "postgres"."igisam"."accd"
                                   ^

[0m15:31:45.687235 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: ROLLBACK
[0m15:31:45.688174 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: Close
[0m15:31:45.698363 [debug] [Thread-1 (]: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  relation "igisam.accd" does not exist
  LINE 13:     select "ACCD_CD" from "postgres"."igisam"."accd"
                                     ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m15:31:45.698789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1e9376-8564-4c84-9a3d-3416b0383f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892d870>]}
[0m15:31:45.699204 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model bi_staging.stg_fund_revenue .............. [[31mERROR[0m in 0.03s]
[0m15:31:45.699555 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_revenue
[0m15:31:45.699900 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_revenue' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  relation "igisam.accd" does not exist
  LINE 13:     select "ACCD_CD" from "postgres"."igisam"."accd"
                                     ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql.
[0m15:31:45.700898 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:45.701112 [debug] [MainThread]: On master: BEGIN
[0m15:31:45.701284 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:45.715030 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m15:31:45.715375 [debug] [MainThread]: On master: COMMIT
[0m15:31:45.715567 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:45.715738 [debug] [MainThread]: On master: COMMIT
[0m15:31:45.717600 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m15:31:45.717810 [debug] [MainThread]: On master: Close
[0m15:31:45.718080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:45.718247 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_revenue' was properly closed.
[0m15:31:45.718468 [info ] [MainThread]: 
[0m15:31:45.718671 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.52 seconds (9.52s).
[0m15:31:45.719149 [debug] [MainThread]: Command end result
[0m15:31:45.734144 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m15:31:45.739882 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m15:31:45.745425 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m15:31:45.745697 [info ] [MainThread]: 
[0m15:31:45.745986 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:31:45.746233 [info ] [MainThread]: 
[0m15:31:45.746527 [error] [MainThread]:   Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  relation "igisam.accd" does not exist
  LINE 13:     select "ACCD_CD" from "postgres"."igisam"."accd"
                                     ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m15:31:45.746866 [info ] [MainThread]: 
[0m15:31:45.748017 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:31:45.754295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.137967, "process_in_blocks": "0", "process_kernel_time": 0.241054, "process_mem_max_rss": "126615552", "process_out_blocks": "0", "process_user_time": 1.283038}
[0m15:31:45.754633 [debug] [MainThread]: Command `dbt run` failed at 15:31:45.754573 after 10.14 seconds
[0m15:31:45.754907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3c7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3c7b50>]}
[0m15:31:45.755155 [debug] [MainThread]: Flushing usage events
[0m15:31:46.828306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:12.387689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d08cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075159c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075160e0>]}


============================== 15:33:12.396337 | 34e23f19-c6af-407e-978a-908dee536d78 ==============================
[0m15:33:12.396337 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:33:12.396756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'debug': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:33:12.547906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34e23f19-c6af-407e-978a-908dee536d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747a2c0>]}
[0m15:33:12.582759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34e23f19-c6af-407e-978a-908dee536d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792c8e0>]}
[0m15:33:12.583937 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:33:12.668647 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:33:12.798387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:33:12.798866 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_revenue.sql
[0m15:33:12.960459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34e23f19-c6af-407e-978a-908dee536d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183dff40>]}
[0m15:33:13.011723 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m15:33:13.015801 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m15:33:13.035080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34e23f19-c6af-407e-978a-908dee536d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181fbe80>]}
[0m15:33:13.035444 [info ] [MainThread]: Found 2 models, 7 sources, 434 macros
[0m15:33:13.035671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34e23f19-c6af-407e-978a-908dee536d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181fbb20>]}
[0m15:33:13.036654 [info ] [MainThread]: 
[0m15:33:13.036885 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:13.037061 [info ] [MainThread]: 
[0m15:33:13.037363 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:13.039978 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:33:13.156498 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:33:13.156818 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:33:13.157008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:13.194327 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.037 seconds
[0m15:33:13.195286 [debug] [ThreadPool]: On list_postgres: Close
[0m15:33:13.196249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m15:33:13.200240 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m15:33:13.200486 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m15:33:13.200671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:13.210447 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:33:13.210755 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m15:33:13.210966 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m15:33:13.226665 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m15:33:13.227582 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m15:33:13.228100 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m15:33:13.231404 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:13.231695 [debug] [MainThread]: On master: BEGIN
[0m15:33:13.231870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:13.243600 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:33:13.243845 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:13.244076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:33:13.253319 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:33:13.254186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34e23f19-c6af-407e-978a-908dee536d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181fb250>]}
[0m15:33:13.254474 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:13.254960 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:13.255170 [debug] [MainThread]: On master: BEGIN
[0m15:33:13.255796 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:33:13.255981 [debug] [MainThread]: On master: COMMIT
[0m15:33:13.256153 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:13.256318 [debug] [MainThread]: On master: COMMIT
[0m15:33:13.256758 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:13.256950 [debug] [MainThread]: On master: Close
[0m15:33:13.259926 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m15:33:13.260255 [info ] [Thread-1 (]: 1 of 2 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m15:33:13.260532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m15:33:13.260741 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m15:33:13.270363 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m15:33:13.271119 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m15:33:13.295329 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m15:33:13.296394 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:33:13.296808 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m15:33:13.297050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:13.305144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:33:13.305437 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:33:13.305827 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m15:33:22.573464 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.265 seconds
[0m15:33:22.583658 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:33:22.583979 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m15:33:22.585049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:33:22.587149 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:33:22.587404 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m15:33:22.588232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:33:22.599029 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m15:33:22.599372 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:33:22.599604 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m15:33:22.628671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m15:33:22.632910 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m15:33:22.635455 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:33:22.635724 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m15:33:22.645900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:33:22.647490 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m15:33:22.648959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e23f19-c6af-407e-978a-908dee536d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792f640>]}
[0m15:33:22.649542 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.39s]
[0m15:33:22.649927 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m15:33:22.650188 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_revenue
[0m15:33:22.650525 [info ] [Thread-1 (]: 2 of 2 START sql table model bi_staging.stg_fund_revenue ....................... [RUN]
[0m15:33:22.650830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.stg_fund_revenue)
[0m15:33:22.651056 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_revenue
[0m15:33:22.653055 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_revenue"
[0m15:33:22.653754 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_revenue
[0m15:33:22.655665 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_revenue"
[0m15:33:22.659140 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:33:22.659447 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: BEGIN
[0m15:33:22.659656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:22.682481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m15:33:22.682843 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:33:22.683082 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp"
  
  
    as
  
  (
    with acct as (
    select "ACCT_CD" from "postgres"."igisam"."accd"
    where "CNT_ACCT_DIV" > '2'
)

select 
  acct."ACCT_CD"
from acct
  );
  
[0m15:33:22.683723 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "igisam.accd" does not exist
LINE 13:     select "ACCT_CD" from "postgres"."igisam"."accd"
                                   ^

[0m15:33:22.684074 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: ROLLBACK
[0m15:33:22.684589 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: Close
[0m15:33:22.701334 [debug] [Thread-1 (]: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  relation "igisam.accd" does not exist
  LINE 13:     select "ACCT_CD" from "postgres"."igisam"."accd"
                                     ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m15:33:22.701856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e23f19-c6af-407e-978a-908dee536d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118185f00>]}
[0m15:33:22.702286 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model bi_staging.stg_fund_revenue .............. [[31mERROR[0m in 0.05s]
[0m15:33:22.702653 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_revenue
[0m15:33:22.702984 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_revenue' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  relation "igisam.accd" does not exist
  LINE 13:     select "ACCT_CD" from "postgres"."igisam"."accd"
                                     ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql.
[0m15:33:22.703978 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:22.704184 [debug] [MainThread]: On master: BEGIN
[0m15:33:22.704354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:22.716665 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:33:22.717026 [debug] [MainThread]: On master: COMMIT
[0m15:33:22.717236 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:22.717411 [debug] [MainThread]: On master: COMMIT
[0m15:33:22.717905 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:22.718240 [debug] [MainThread]: On master: Close
[0m15:33:22.718558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:22.718829 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_revenue' was properly closed.
[0m15:33:22.719128 [info ] [MainThread]: 
[0m15:33:22.719360 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.68 seconds (9.68s).
[0m15:33:22.719874 [debug] [MainThread]: Command end result
[0m15:33:22.734042 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m15:33:22.735706 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m15:33:22.742542 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m15:33:22.742826 [info ] [MainThread]: 
[0m15:33:22.743073 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:33:22.743276 [info ] [MainThread]: 
[0m15:33:22.743512 [error] [MainThread]:   Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  relation "igisam.accd" does not exist
  LINE 13:     select "ACCT_CD" from "postgres"."igisam"."accd"
                                     ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m15:33:22.743710 [info ] [MainThread]: 
[0m15:33:22.743910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:33:22.745682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.420545, "process_in_blocks": "0", "process_kernel_time": 0.242956, "process_mem_max_rss": "131465216", "process_out_blocks": "0", "process_user_time": 1.419549}
[0m15:33:22.745973 [debug] [MainThread]: Command `dbt run` failed at 15:33:22.745917 after 10.42 seconds
[0m15:33:22.746354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d08cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183c6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11897e380>]}
[0m15:33:22.746618 [debug] [MainThread]: Flushing usage events
[0m15:33:23.651378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:22.824970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d08ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d159c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d160e0>]}


============================== 15:36:22.830091 | e80260a6-8b54-4492-bb16-d5deca43dc52 ==============================
[0m15:36:22.830091 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:36:22.830470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:36:22.974050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e80260a6-8b54-4492-bb16-d5deca43dc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612efb0>]}
[0m15:36:23.009087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e80260a6-8b54-4492-bb16-d5deca43dc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061572e0>]}
[0m15:36:23.010011 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:36:23.089463 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:36:23.234504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:36:23.234847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:36:23.258940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e80260a6-8b54-4492-bb16-d5deca43dc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6cdf0>]}
[0m15:36:23.310527 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m15:36:23.320924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m15:36:23.336525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e80260a6-8b54-4492-bb16-d5deca43dc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6e320>]}
[0m15:36:23.336895 [info ] [MainThread]: Found 2 models, 7 sources, 434 macros
[0m15:36:23.337120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e80260a6-8b54-4492-bb16-d5deca43dc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623ba30>]}
[0m15:36:23.338375 [info ] [MainThread]: 
[0m15:36:23.338682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:36:23.338867 [info ] [MainThread]: 
[0m15:36:23.339174 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:36:23.341761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:36:23.433082 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:36:23.433402 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:36:23.433600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:23.478495 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.045 seconds
[0m15:36:23.479426 [debug] [ThreadPool]: On list_postgres: Close
[0m15:36:23.480140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m15:36:23.483891 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m15:36:23.484129 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m15:36:23.484311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:23.496244 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:36:23.496553 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m15:36:23.496774 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m15:36:23.512211 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m15:36:23.513073 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m15:36:23.513638 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m15:36:23.516437 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:23.516657 [debug] [MainThread]: On master: BEGIN
[0m15:36:23.516837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:23.527063 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:36:23.527335 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:23.527570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:36:23.543453 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m15:36:23.544210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e80260a6-8b54-4492-bb16-d5deca43dc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9ad70>]}
[0m15:36:23.544504 [debug] [MainThread]: On master: ROLLBACK
[0m15:36:23.545047 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:23.545264 [debug] [MainThread]: On master: BEGIN
[0m15:36:23.546050 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:36:23.546239 [debug] [MainThread]: On master: COMMIT
[0m15:36:23.546410 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:23.546573 [debug] [MainThread]: On master: COMMIT
[0m15:36:23.547205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:36:23.547417 [debug] [MainThread]: On master: Close
[0m15:36:23.553023 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m15:36:23.553355 [info ] [Thread-1 (]: 1 of 2 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m15:36:23.553634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m15:36:23.553846 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m15:36:23.563050 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m15:36:23.568158 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m15:36:23.592458 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m15:36:23.593783 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:36:23.594123 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m15:36:23.594352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:23.618811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m15:36:23.619172 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:36:23.619568 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m15:36:32.845452 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.225 seconds
[0m15:36:32.858541 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:36:32.858877 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m15:36:32.860027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:32.894712 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:36:32.895096 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m15:36:32.896489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:32.907215 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m15:36:32.907592 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:36:32.907825 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m15:36:32.936957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m15:36:32.941412 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m15:36:32.944211 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m15:36:32.944512 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m15:36:32.956012 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m15:36:32.957757 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m15:36:32.959253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e80260a6-8b54-4492-bb16-d5deca43dc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107091690>]}
[0m15:36:32.959715 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.40s]
[0m15:36:32.960097 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m15:36:32.960345 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_revenue
[0m15:36:32.960657 [info ] [Thread-1 (]: 2 of 2 START sql table model bi_staging.stg_fund_revenue ....................... [RUN]
[0m15:36:32.960933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.stg_fund_revenue)
[0m15:36:32.961147 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_revenue
[0m15:36:32.963071 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_revenue"
[0m15:36:32.969424 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_revenue
[0m15:36:32.971614 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_revenue"
[0m15:36:32.972516 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:36:32.972831 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: BEGIN
[0m15:36:32.973053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:32.986195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:36:32.986539 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:36:32.986763 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp"
  
  
    as
  
  (
    with acct as (
    select "ACCT_CD" from "postgres"."igisam"."accd"
    where "CNT_ACCT_DIV" > '2'
)

select 
  acct."ACCT_CD"
from acct
  );
  
[0m15:36:33.011785 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.025 seconds
[0m15:36:33.013983 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:36:33.014233 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */
alter table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp" rename to "stg_fund_revenue"
[0m15:36:33.015152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:33.015830 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: COMMIT
[0m15:36:33.016036 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:36:33.016225 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: COMMIT
[0m15:36:33.017665 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:36:33.019990 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_revenue__dbt_backup"
[0m15:36:33.020363 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m15:36:33.020598 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */
drop table if exists "postgres"."bi_staging"."stg_fund_revenue__dbt_backup" cascade
[0m15:36:33.021332 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:36:33.022270 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: Close
[0m15:36:33.022660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e80260a6-8b54-4492-bb16-d5deca43dc52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438e5f0>]}
[0m15:36:33.023065 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bi_staging.stg_fund_revenue .................. [[32mSELECT 14[0m in 0.06s]
[0m15:36:33.023415 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_revenue
[0m15:36:33.024191 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:33.024467 [debug] [MainThread]: On master: BEGIN
[0m15:36:33.024653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:36:33.034371 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:36:33.034720 [debug] [MainThread]: On master: COMMIT
[0m15:36:33.034948 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:33.035134 [debug] [MainThread]: On master: COMMIT
[0m15:36:33.035671 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:36:33.035973 [debug] [MainThread]: On master: Close
[0m15:36:33.036256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:33.036447 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_revenue' was properly closed.
[0m15:36:33.036686 [info ] [MainThread]: 
[0m15:36:33.036893 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.70 seconds (9.70s).
[0m15:36:33.037366 [debug] [MainThread]: Command end result
[0m15:36:33.050977 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m15:36:33.052376 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m15:36:33.057293 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m15:36:33.057549 [info ] [MainThread]: 
[0m15:36:33.057795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:36:33.057979 [info ] [MainThread]: 
[0m15:36:33.058176 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:36:33.060035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.294993, "process_in_blocks": "0", "process_kernel_time": 0.228388, "process_mem_max_rss": "126173184", "process_out_blocks": "0", "process_user_time": 1.29986}
[0m15:36:33.060344 [debug] [MainThread]: Command `dbt run` succeeded at 15:36:33.060289 after 10.30 seconds
[0m15:36:33.060587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d08ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc2ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d17730>]}
[0m15:36:33.060818 [debug] [MainThread]: Flushing usage events
[0m15:36:33.971449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:41.949116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d22bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d23310>]}


============================== 16:39:41.970769 | 8976d3b8-dfb5-4e26-bb12-bfd059ef5dda ==============================
[0m16:39:41.970769 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:39:41.971202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/goonzardw/.dbt', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:39:42.308845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8976d3b8-dfb5-4e26-bb12-bfd059ef5dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de2b60>]}
[0m16:39:42.343671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8976d3b8-dfb5-4e26-bb12-bfd059ef5dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b43250>]}
[0m16:39:42.346760 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:39:42.471690 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:39:43.457535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:39:43.458098 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_revenue.sql
[0m16:39:43.630875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8976d3b8-dfb5-4e26-bb12-bfd059ef5dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be3ee0>]}
[0m16:39:43.684935 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:39:43.689640 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:39:43.776153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8976d3b8-dfb5-4e26-bb12-bfd059ef5dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be1750>]}
[0m16:39:43.776643 [info ] [MainThread]: Found 2 models, 7 sources, 434 macros
[0m16:39:43.776938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8976d3b8-dfb5-4e26-bb12-bfd059ef5dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d1b40>]}
[0m16:39:43.778201 [info ] [MainThread]: 
[0m16:39:43.778544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:39:43.778814 [info ] [MainThread]: 
[0m16:39:43.779201 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:43.782589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:39:44.758980 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:39:44.759614 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:39:44.759924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:45.107244 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.347 seconds
[0m16:39:45.108198 [debug] [ThreadPool]: On list_postgres: Close
[0m16:39:45.109068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m16:39:45.113294 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:39:45.113560 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m16:39:45.113738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:45.123118 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:39:45.123462 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:39:45.123693 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m16:39:45.187181 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.063 seconds
[0m16:39:45.188155 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m16:39:45.188964 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m16:39:45.192053 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.192311 [debug] [MainThread]: On master: BEGIN
[0m16:39:45.192484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:45.217294 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m16:39:45.217641 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.217884 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:45.305379 [debug] [MainThread]: SQL status: SELECT 0 in 0.087 seconds
[0m16:39:45.306750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8976d3b8-dfb5-4e26-bb12-bfd059ef5dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd8b50>]}
[0m16:39:45.307214 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:45.308293 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.308632 [debug] [MainThread]: On master: BEGIN
[0m16:39:45.315525 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:39:45.315953 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.316254 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.316529 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.317618 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:39:45.318052 [debug] [MainThread]: On master: Close
[0m16:39:45.342713 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m16:39:45.343325 [info ] [Thread-1 (]: 1 of 2 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m16:39:45.343888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m16:39:45.344297 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m16:39:45.358530 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m16:39:45.360291 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m16:39:45.392094 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m16:39:45.392866 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:39:45.393176 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m16:39:45.393432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:45.413638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:39:45.414031 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:39:45.414484 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m16:39:54.840097 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.425 seconds
[0m16:39:54.856805 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:39:54.857183 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m16:39:54.858775 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:39:54.860898 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:39:54.861200 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m16:39:54.862497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:39:54.873845 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:39:54.874247 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:39:54.874480 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:39:54.876905 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:39:54.881524 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m16:39:54.884604 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:39:54.884943 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m16:39:54.900155 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m16:39:54.902560 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m16:39:54.905078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8976d3b8-dfb5-4e26-bb12-bfd059ef5dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cfca0>]}
[0m16:39:54.905622 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.56s]
[0m16:39:54.906020 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m16:39:54.906299 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_revenue
[0m16:39:54.906673 [info ] [Thread-1 (]: 2 of 2 START sql table model bi_staging.stg_fund_revenue ....................... [RUN]
[0m16:39:54.907032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.stg_fund_revenue)
[0m16:39:54.907303 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_revenue
[0m16:39:54.909661 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_revenue"
[0m16:39:54.911971 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_revenue
[0m16:39:54.914351 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_revenue"
[0m16:39:54.916696 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:39:54.917007 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: BEGIN
[0m16:39:54.917242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:54.928106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:39:54.928512 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:39:54.928794 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "FUND_CD",
    "ACCT_CD",
    "PROC_DT",
    "PRE_BAL"::numeric,
    "DEBT_AMT"::numeric,
    "CREDIT_AMT"::numeric
  from "postgres"."igisam"."fngl"
  where "PROC_DT" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m16:39:54.930676 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "FUND_CD" does not exist
LINE 14:     "FUND_CD",
             ^

[0m16:39:54.930986 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: ROLLBACK
[0m16:39:54.931648 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: Close
[0m16:39:54.956553 [debug] [Thread-1 (]: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  column "FUND_CD" does not exist
  LINE 14:     "FUND_CD",
               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m16:39:54.957107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8976d3b8-dfb5-4e26-bb12-bfd059ef5dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105586590>]}
[0m16:39:54.957640 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model bi_staging.stg_fund_revenue .............. [[31mERROR[0m in 0.05s]
[0m16:39:54.958100 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_revenue
[0m16:39:54.958490 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_revenue' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  column "FUND_CD" does not exist
  LINE 14:     "FUND_CD",
               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql.
[0m16:39:54.959829 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:54.960201 [debug] [MainThread]: On master: BEGIN
[0m16:39:54.960444 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:54.976150 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:39:54.976583 [debug] [MainThread]: On master: COMMIT
[0m16:39:54.976855 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:54.977093 [debug] [MainThread]: On master: COMMIT
[0m16:39:54.977742 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:54.978047 [debug] [MainThread]: On master: Close
[0m16:39:54.978412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:54.978637 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_revenue' was properly closed.
[0m16:39:54.978926 [info ] [MainThread]: 
[0m16:39:54.979181 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 11.20 seconds (11.20s).
[0m16:39:54.979785 [debug] [MainThread]: Command end result
[0m16:39:54.997986 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:39:54.999443 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:39:55.008609 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m16:39:55.008917 [info ] [MainThread]: 
[0m16:39:55.009174 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:39:55.009387 [info ] [MainThread]: 
[0m16:39:55.009655 [error] [MainThread]:   Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  column "FUND_CD" does not exist
  LINE 14:     "FUND_CD",
               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m16:39:55.009858 [info ] [MainThread]: 
[0m16:39:55.010066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:39:55.018330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.165044, "process_in_blocks": "0", "process_kernel_time": 0.614324, "process_mem_max_rss": "130105344", "process_out_blocks": "0", "process_user_time": 2.149184}
[0m16:39:55.018850 [debug] [MainThread]: Command `dbt run` failed at 16:39:55.018771 after 13.17 seconds
[0m16:39:55.019139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f33220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120188b80>]}
[0m16:39:55.019403 [debug] [MainThread]: Flushing usage events
[0m16:39:55.905112 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:43.213000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106308d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070199f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701a110>]}


============================== 16:43:43.217282 | 64f323ad-e65c-4534-b209-6e2273ca7b53 ==============================
[0m16:43:43.217282 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:43:43.217640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'profiles_dir': '/Users/goonzardw/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:43.352298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f323ad-e65c-4534-b209-6e2273ca7b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b30880>]}
[0m16:43:43.385781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64f323ad-e65c-4534-b209-6e2273ca7b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ac700>]}
[0m16:43:43.387654 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:43:43.469700 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:43:43.593416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:43:43.593995 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_revenue.sql
[0m16:43:43.751097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f323ad-e65c-4534-b209-6e2273ca7b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102dffa0>]}
[0m16:43:43.800532 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:43:43.808013 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:43:43.874655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f323ad-e65c-4534-b209-6e2273ca7b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100fc460>]}
[0m16:43:43.875075 [info ] [MainThread]: Found 2 models, 7 sources, 434 macros
[0m16:43:43.875309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f323ad-e65c-4534-b209-6e2273ca7b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ffcd0>]}
[0m16:43:43.876388 [info ] [MainThread]: 
[0m16:43:43.876624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:43.876809 [info ] [MainThread]: 
[0m16:43:43.877259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:43:43.880110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:43:44.015557 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:43:44.015871 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:43:44.016062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:44.068354 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.052 seconds
[0m16:43:44.069336 [debug] [ThreadPool]: On list_postgres: Close
[0m16:43:44.070140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m16:43:44.074493 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:43:44.074765 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m16:43:44.074952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:44.089187 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m16:43:44.089517 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:43:44.089740 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m16:43:44.100640 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m16:43:44.101614 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m16:43:44.105983 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m16:43:44.109346 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:44.109608 [debug] [MainThread]: On master: BEGIN
[0m16:43:44.109813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:44.123128 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:43:44.123464 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:44.123761 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:43:44.135265 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m16:43:44.136276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f323ad-e65c-4534-b209-6e2273ca7b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110148730>]}
[0m16:43:44.136621 [debug] [MainThread]: On master: ROLLBACK
[0m16:43:44.137311 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:44.137530 [debug] [MainThread]: On master: BEGIN
[0m16:43:44.138461 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:43:44.138807 [debug] [MainThread]: On master: COMMIT
[0m16:43:44.139034 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:44.139255 [debug] [MainThread]: On master: COMMIT
[0m16:43:44.139831 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:43:44.140106 [debug] [MainThread]: On master: Close
[0m16:43:44.142073 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m16:43:44.142505 [info ] [Thread-1 (]: 1 of 2 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m16:43:44.142849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m16:43:44.143102 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m16:43:44.154295 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m16:43:44.156550 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m16:43:44.180583 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m16:43:44.181366 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:43:44.181597 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m16:43:44.181805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:44.193370 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:43:44.193688 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:43:44.194069 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m16:43:53.309612 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.115 seconds
[0m16:43:53.321575 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:43:53.321899 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m16:43:53.322999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:43:53.324890 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:43:53.325146 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m16:43:53.326143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:43:53.341714 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:43:53.342103 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:43:53.342354 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:43:53.345171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:43:53.349733 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m16:43:53.352634 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:43:53.352926 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m16:43:53.366395 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m16:43:53.368325 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m16:43:53.369886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f323ad-e65c-4534-b209-6e2273ca7b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b05ea0>]}
[0m16:43:53.370401 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.23s]
[0m16:43:53.370813 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m16:43:53.371085 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_revenue
[0m16:43:53.371456 [info ] [Thread-1 (]: 2 of 2 START sql table model bi_staging.stg_fund_revenue ....................... [RUN]
[0m16:43:53.371778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.stg_fund_revenue)
[0m16:43:53.372038 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_revenue
[0m16:43:53.374325 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_revenue"
[0m16:43:53.375110 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_revenue
[0m16:43:53.377450 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_revenue"
[0m16:43:53.378221 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:43:53.378528 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: BEGIN
[0m16:43:53.378766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:53.391531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:43:53.391935 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:43:53.392224 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "PROC_DT",
    "FUND_CD",
    "ACCT_CD",
    "DC_DIV",
    "PRE_BAL"::numeric,
    "DEBT_AMT"::numeric,
    "CREDIT_AMT"::numeric
  from "postgres"."igisam"."fngl"
  where "PROC_DT" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m16:43:53.393120 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "PROC_DT" does not exist
LINE 14:     "PROC_DT",
             ^

[0m16:43:53.393438 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: ROLLBACK
[0m16:43:53.394251 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: Close
[0m16:43:53.402959 [debug] [Thread-1 (]: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  column "PROC_DT" does not exist
  LINE 14:     "PROC_DT",
               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m16:43:53.403427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f323ad-e65c-4534-b209-6e2273ca7b53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592eb30>]}
[0m16:43:53.403898 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model bi_staging.stg_fund_revenue .............. [[31mERROR[0m in 0.03s]
[0m16:43:53.404292 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_revenue
[0m16:43:53.404667 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_revenue' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  column "PROC_DT" does not exist
  LINE 14:     "PROC_DT",
               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql.
[0m16:43:53.405785 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:53.406025 [debug] [MainThread]: On master: BEGIN
[0m16:43:53.406227 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:53.417475 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:43:53.417858 [debug] [MainThread]: On master: COMMIT
[0m16:43:53.418089 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:53.418293 [debug] [MainThread]: On master: COMMIT
[0m16:43:53.418797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:43:53.419066 [debug] [MainThread]: On master: Close
[0m16:43:53.419389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:53.419596 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_revenue' was properly closed.
[0m16:43:53.419857 [info ] [MainThread]: 
[0m16:43:53.420090 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.54 seconds (9.54s).
[0m16:43:53.420640 [debug] [MainThread]: Command end result
[0m16:43:53.436779 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:43:53.440898 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:43:53.445673 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m16:43:53.445939 [info ] [MainThread]: 
[0m16:43:53.446175 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:43:53.446380 [info ] [MainThread]: 
[0m16:43:53.446625 [error] [MainThread]:   Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  column "PROC_DT" does not exist
  LINE 14:     "PROC_DT",
               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m16:43:53.446816 [info ] [MainThread]: 
[0m16:43:53.447013 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:43:53.448808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.297949, "process_in_blocks": "0", "process_kernel_time": 0.240721, "process_mem_max_rss": "129794048", "process_out_blocks": "0", "process_user_time": 1.425148}
[0m16:43:53.449095 [debug] [MainThread]: Command `dbt run` failed at 16:43:53.449037 after 10.30 seconds
[0m16:43:53.449347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106308d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592eb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102dd540>]}
[0m16:43:53.449594 [debug] [MainThread]: Flushing usage events
[0m16:43:54.366392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:12.782389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e1930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e2050>]}


============================== 16:44:12.786226 | d89d377a-bdf3-4985-96bf-fbac5f60afa6 ==============================
[0m16:44:12.786226 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:44:12.786608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:44:12.813374 [info ] [MainThread]: dbt version: 1.9.4
[0m16:44:12.813697 [info ] [MainThread]: python version: 3.10.3
[0m16:44:12.813882 [info ] [MainThread]: python path: /Users/goonzardw/Developer/bi/dbt3/.venv/bin/python3
[0m16:44:12.814058 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m16:44:12.874159 [info ] [MainThread]: Using profiles dir at /Users/goonzardw/.dbt
[0m16:44:12.874533 [info ] [MainThread]: Using profiles.yml file at /Users/goonzardw/.dbt/profiles.yml
[0m16:44:12.874731 [info ] [MainThread]: Using dbt_project.yml file at /Users/goonzardw/Developer/bi/dbt3/dbt_project.yml
[0m16:44:12.875370 [info ] [MainThread]: adapter type: postgres
[0m16:44:12.875555 [info ] [MainThread]: adapter version: 1.9.0
[0m16:44:12.932933 [info ] [MainThread]: Configuration:
[0m16:44:12.933291 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:44:12.933483 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:44:12.933668 [info ] [MainThread]: Required dependencies:
[0m16:44:12.934010 [debug] [MainThread]: Executing "git --help"
[0m16:44:12.954858 [debug] [MainThread]: STDOUT: "b"\xec\x82\xac\xec\x9a\xa9\xeb\xb2\x95: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\n\xeb\x8b\xa4\xec\x9d\x8c\xec\x9d\x80 \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\x83\x81\xed\x99\xa9\xec\x97\x90\xec\x84\x9c \xec\x9e\x90\xec\xa3\xbc \xec\x82\xac\xec\x9a\xa9\xed\x95\x98\xeb\x8a\x94 \xea\xb9\x83 \xeb\xaa\x85\xeb\xa0\xb9\xec\x9e\x85\xeb\x8b\x88\xeb\x8b\xa4:\n\n\xec\x9e\x91\xec\x97\x85 \xea\xb3\xb5\xea\xb0\x84 \xec\x8b\x9c\xec\x9e\x91 (\xec\xb0\xb8\xea\xb3\xa0: git help tutorial)\n   clone     \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xb3\xb5\xec\xa0\x9c\xed\x95\xb4 \xec\x83\x88 \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac\xeb\xa1\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   init      \xeb\xb9\x88 \xea\xb9\x83 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98 \xea\xb8\xb0\xec\xa1\xb4 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xeb\xa5\xbc \xeb\x8b\xa4\xec\x8b\x9c \xec\xb4\x88\xea\xb8\xb0\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xeb\xb3\x80\xea\xb2\xbd \xec\x82\xac\xed\x95\xad\xec\x97\x90 \xeb\x8c\x80\xed\x95\x9c \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help everyday)\n   add       \xed\x8c\x8c\xec\x9d\xbc \xeb\x82\xb4\xec\x9a\xa9\xec\x9d\x84 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90 \xec\xb6\x94\xea\xb0\x80\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   mv        \xed\x8c\x8c\xec\x9d\xbc, \xeb\x94\x94\xeb\xa0\x89\xed\x84\xb0\xeb\xa6\xac, \xec\x8b\xac\xeb\xb3\xbc\xeb\xa6\xad \xeb\xa7\x81\xed\x81\xac\xeb\xa5\xbc \xec\x98\xae\xea\xb8\xb0\xea\xb1\xb0\xeb\x82\x98 \xec\x9d\xb4\xeb\xa6\x84\xec\x9d\x84 \xeb\xb0\x94\xea\xbf\x89\xeb\x8b\x88\xeb\x8b\xa4\n   restore   Restore working tree files\n   rm        \xed\x8c\x8c\xec\x9d\xbc\xec\x9d\x84 \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94\xec\x97\x90\xec\x84\x9c \xec\xa0\x9c\xea\xb1\xb0\xed\x95\x98\xea\xb3\xa0 \xec\x9d\xb8\xeb\x8d\xb1\xec\x8a\xa4\xec\x97\x90\xec\x84\x9c\xeb\x8f\x84 \xec\xa0\x9c\xea\xb1\xb0\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xea\xb3\xbc \xec\x83\x81\xed\x83\x9c \xeb\xb3\xb4\xea\xb8\xb0 (\xec\xb0\xb8\xea\xb3\xa0: git help revisions)\n   bisect    \xec\x9d\xb4\xec\xa7\x84 \xed\x83\x90\xec\x83\x89\xec\x9c\xbc\xeb\xa1\x9c \xeb\xb2\x84\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xec\x96\xb4\xeb\x82\xb8 \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xec\xb0\xbe\xec\x8a\xb5\xeb\x8b\x88\xeb\x8b\xa4\n   diff      \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\xbb\xa4\xeb\xb0\x8b \xec\x82\xac\xec\x9d\xb4, \xec\xbb\xa4\xeb\xb0\x8b\xea\xb3\xbc \xec\x9e\x91\xec\x97\x85 \xeb\x82\xb4\xec\x9a\xa9 \xec\x82\xac\xec\x9d\xb4 \xeb\x93\xb1\xec\x9d\x98 \xeb\xb0\x94\xeb\x80\x90 \xec\xa0\x90\xec\x9d\x84 \xeb\xb4\x85\xeb\x8b\x88\xeb\x8b\xa4\n   grep      \xed\x8c\xa8\xed\x84\xb4\xea\xb3\xbc \xec\x9d\xbc\xec\xb9\x98\xed\x95\x98\xeb\x8a\x94 \xec\xa4\x84\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   log       \xec\xbb\xa4\xeb\xb0\x8b \xea\xb8\xb0\xeb\xa1\x9d\xec\x9d\x84 \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   show      \xec\x97\xac\xeb\x9f\xac\xea\xb0\x80\xec\xa7\x80 \xec\xa2\x85\xeb\xa5\x98\xec\x9d\x98 \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   status    \xec\x9e\x91\xec\x97\x85 \xed\x8f\xb4\xeb\x8d\x94 \xec\x83\x81\xed\x83\x9c\xeb\xa5\xbc \xed\x91\x9c\xec\x8b\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xec\xbb\xa4\xeb\xb0\x8b \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x82\xa4\xec\x9a\xb0\xea\xb3\xa0, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb3\xa0, \xec\xa1\xb0\xec\x9e\x91\xed\x95\x98\xea\xb8\xb0\n   branch    \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xeb\xaa\xa9\xeb\xa1\x9d\xec\x9d\x84 \xec\xb6\x9c\xeb\xa0\xa5\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   commit    \xeb\xb0\x94\xeb\x80\x90 \xec\x82\xac\xed\x95\xad\xec\x9d\x84 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90 \xea\xb8\xb0\xeb\xa1\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   merge     \xec\x97\xac\xeb\x9f\xac \xea\xb0\x9c\xec\x9d\x98 \xea\xb0\x9c\xeb\xb0\x9c \xeb\x82\xb4\xec\x97\xad\xec\x9d\x84 \xed\x95\x98\xeb\x82\x98\xeb\xa1\x9c \xed\x95\xa9\xec\xb9\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   rebase    \xec\xbb\xa4\xeb\xb0\x8b\xec\x9d\x84 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xb2\xa0\xec\x9d\xb4\xec\x8a\xa4 \xeb\x81\x9d\xec\x9d\x98 \xec\xb5\x9c\xec\x83\x81\xec\x9c\x84\xec\x97\x90\xec\x84\x9c \xec\xa0\x81\xec\x9a\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   reset     \xed\x98\x84\xec\x9e\xac HEAD\xeb\xa5\xbc \xec\xa7\x80\xec\xa0\x95\xed\x95\x9c \xec\x83\x81\xed\x83\x9c\xeb\xa1\x9c \xec\x9e\xac\xec\x84\xa4\xec\xa0\x95\xed\x99\x94\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   switch    Switch branches\n   tag       \xed\x83\x9c\xea\xb7\xb8\xeb\xa5\xbc \xeb\xa7\x8c\xeb\x93\xa4\xea\xb1\xb0\xeb\x82\x98, \xed\x91\x9c\xec\x8b\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, \xec\x82\xad\xec\xa0\x9c\xed\x95\x98\xea\xb1\xb0\xeb\x82\x98, GPG \xec\x84\x9c\xeb\xaa\x85\xec\x9d\x84 \xea\xb2\x80\xec\xa6\x9d\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n\xed\x98\x91\xeb\x8f\x99 \xec\x9e\x91\xec\x97\x85 (\xec\xb0\xb8\xea\xb3\xa0: git help workflows)\n   fetch     \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c\xec\x97\x90\xec\x84\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xec\x99\x80 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4\xeb\xa5\xbc \xeb\x8b\xa4\xec\x9a\xb4\xeb\xa1\x9c\xeb\x93\x9c\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   pull      \xeb\x8b\xa4\xeb\xa5\xb8 \xec\xa0\x80\xec\x9e\xa5\xec\x86\x8c \xeb\x98\x90\xeb\x8a\x94 \xeb\x8b\xa4\xeb\xa5\xb8 \xeb\xa1\x9c\xec\xbb\xac \xeb\xb8\x8c\xeb\x9e\x9c\xec\xb9\x98\xec\x97\x90\xec\x84\x9c \xea\xb0\x80\xec\xa0\xb8\xec\x98\xa4\xea\xb1\xb0\xeb\x82\x98 \xed\x86\xb5\xed\x95\xa9\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n   push      \xec\x9b\x90\xea\xb2\xa9 \xeb\xa0\x88\xed\x8d\xbc\xeb\x9f\xb0\xec\x8a\xa4 \xeb\xb0\x8f \xea\xb7\xb8\xec\x99\x80 \xea\xb4\x80\xeb\xa0\xa8\xeb\x90\x9c \xec\x98\xa4\xeb\xb8\x8c\xec\xa0\x9d\xed\x8a\xb8\xeb\xa5\xbc \xec\x97\x85\xeb\x8d\xb0\xec\x9d\xb4\xed\x8a\xb8\xed\x95\xa9\xeb\x8b\x88\xeb\x8b\xa4\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:44:12.955660 [debug] [MainThread]: STDERR: "b''"
[0m16:44:12.955899 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:44:12.956115 [info ] [MainThread]: Connection:
[0m16:44:12.956369 [info ] [MainThread]:   host: localhost
[0m16:44:12.956548 [info ] [MainThread]:   port: 5432
[0m16:44:12.956713 [info ] [MainThread]:   user: postgres
[0m16:44:12.956879 [info ] [MainThread]:   database: postgres
[0m16:44:12.957043 [info ] [MainThread]:   schema: bi
[0m16:44:12.957204 [info ] [MainThread]:   connect_timeout: 10
[0m16:44:12.957367 [info ] [MainThread]:   role: None
[0m16:44:12.957527 [info ] [MainThread]:   search_path: None
[0m16:44:12.957687 [info ] [MainThread]:   keepalives_idle: 0
[0m16:44:12.957846 [info ] [MainThread]:   sslmode: None
[0m16:44:12.958007 [info ] [MainThread]:   sslcert: None
[0m16:44:12.958168 [info ] [MainThread]:   sslkey: None
[0m16:44:12.958328 [info ] [MainThread]:   sslrootcert: None
[0m16:44:12.958490 [info ] [MainThread]:   application_name: dbt
[0m16:44:12.958647 [info ] [MainThread]:   retries: 1
[0m16:44:12.959087 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:44:13.035723 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:44:13.170963 [debug] [MainThread]: Using postgres connection "debug"
[0m16:44:13.171292 [debug] [MainThread]: On debug: select 1 as id
[0m16:44:13.171483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:13.217148 [debug] [MainThread]: SQL status: SELECT 1 in 0.046 seconds
[0m16:44:13.217886 [debug] [MainThread]: On debug: Close
[0m16:44:13.218133 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:44:13.218361 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:44:13.220396 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.49030605, "process_in_blocks": "0", "process_kernel_time": 0.206895, "process_mem_max_rss": "117227520", "process_out_blocks": "0", "process_user_time": 0.931602}
[0m16:44:13.220760 [debug] [MainThread]: Command `dbt debug` succeeded at 16:44:13.220683 after 0.49 seconds
[0m16:44:13.220991 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:44:13.221211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c8b3d0>]}
[0m16:44:13.221462 [debug] [MainThread]: Flushing usage events
[0m16:44:14.069458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:30.245850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e59c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e60e0>]}


============================== 16:44:30.251433 | 8acce2cc-95a6-43ba-afa5-e01c8a7e6f8a ==============================
[0m16:44:30.251433 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:44:30.251907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:30.409698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8acce2cc-95a6-43ba-afa5-e01c8a7e6f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11247a2c0>]}
[0m16:44:30.444919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8acce2cc-95a6-43ba-afa5-e01c8a7e6f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fe48e0>]}
[0m16:44:30.445816 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:44:30.525611 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:44:30.656433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:30.656743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:30.681563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8acce2cc-95a6-43ba-afa5-e01c8a7e6f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11344ce20>]}
[0m16:44:30.733351 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:44:30.737519 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:44:30.753326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8acce2cc-95a6-43ba-afa5-e01c8a7e6f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11344fd90>]}
[0m16:44:30.753722 [info ] [MainThread]: Found 2 models, 7 sources, 434 macros
[0m16:44:30.753939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8acce2cc-95a6-43ba-afa5-e01c8a7e6f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11344fdc0>]}
[0m16:44:30.754973 [info ] [MainThread]: 
[0m16:44:30.755206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:30.755381 [info ] [MainThread]: 
[0m16:44:30.755691 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:30.758391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:44:30.835207 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:44:30.835533 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:44:30.835730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:30.900035 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.064 seconds
[0m16:44:30.901023 [debug] [ThreadPool]: On list_postgres: Close
[0m16:44:30.901798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m16:44:30.905846 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:44:30.906115 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m16:44:30.906301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:30.916819 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:44:30.917165 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:44:30.917395 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m16:44:30.932359 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.015 seconds
[0m16:44:30.933375 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m16:44:30.934079 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m16:44:30.937665 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:30.937941 [debug] [MainThread]: On master: BEGIN
[0m16:44:30.938132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:30.952138 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:44:30.952463 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:30.952726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:30.965511 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m16:44:30.966361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8acce2cc-95a6-43ba-afa5-e01c8a7e6f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11324a3b0>]}
[0m16:44:30.966671 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:30.967598 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:30.967824 [debug] [MainThread]: On master: BEGIN
[0m16:44:30.968988 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:44:30.969173 [debug] [MainThread]: On master: COMMIT
[0m16:44:30.969353 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:30.969518 [debug] [MainThread]: On master: COMMIT
[0m16:44:30.970231 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:44:30.970521 [debug] [MainThread]: On master: Close
[0m16:44:30.972479 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m16:44:30.972888 [info ] [Thread-1 (]: 1 of 2 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m16:44:30.973229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m16:44:30.973450 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m16:44:30.983239 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m16:44:30.983958 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m16:44:31.007756 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m16:44:31.008493 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:44:31.008731 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m16:44:31.008944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:31.022200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:44:31.022554 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:44:31.022933 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m16:44:40.162966 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.139 seconds
[0m16:44:40.174208 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:44:40.174527 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m16:44:40.175442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:44:40.212539 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:44:40.212978 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m16:44:40.214859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:44:40.226921 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:44:40.227328 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:44:40.227567 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:44:40.265023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m16:44:40.269444 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m16:44:40.272260 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:44:40.272570 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m16:44:40.284214 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m16:44:40.286002 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m16:44:40.287454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8acce2cc-95a6-43ba-afa5-e01c8a7e6f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113873520>]}
[0m16:44:40.287905 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.31s]
[0m16:44:40.288277 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m16:44:40.288524 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_revenue
[0m16:44:40.288896 [info ] [Thread-1 (]: 2 of 2 START sql table model bi_staging.stg_fund_revenue ....................... [RUN]
[0m16:44:40.289254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.stg_fund_revenue)
[0m16:44:40.289501 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_revenue
[0m16:44:40.291458 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_revenue"
[0m16:44:40.292150 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_revenue
[0m16:44:40.294339 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_revenue"
[0m16:44:40.295120 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:44:40.295410 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: BEGIN
[0m16:44:40.295632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:40.305047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m16:44:40.305435 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:44:40.305700 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "PROC_DT",
    "FUND_CD",
    "ACCT_CD",
    "DC_DIV",
    "PRE_BAL"::numeric,
    "DEBT_AMT"::numeric,
    "CREDIT_AMT"::numeric
  from "postgres"."igisam"."fngl"
  where "PROC_DT" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m16:44:40.306409 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "PROC_DT" does not exist
LINE 14:     "PROC_DT",
             ^

[0m16:44:40.306761 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: ROLLBACK
[0m16:44:40.307315 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: Close
[0m16:44:40.315330 [debug] [Thread-1 (]: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  column "PROC_DT" does not exist
  LINE 14:     "PROC_DT",
               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m16:44:40.315819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8acce2cc-95a6-43ba-afa5-e01c8a7e6f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b31990>]}
[0m16:44:40.316260 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model bi_staging.stg_fund_revenue .............. [[31mERROR[0m in 0.03s]
[0m16:44:40.316658 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_revenue
[0m16:44:40.317001 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_revenue' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  column "PROC_DT" does not exist
  LINE 14:     "PROC_DT",
               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql.
[0m16:44:40.318029 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:40.318250 [debug] [MainThread]: On master: BEGIN
[0m16:44:40.318427 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:40.328652 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:44:40.329014 [debug] [MainThread]: On master: COMMIT
[0m16:44:40.329232 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:40.329420 [debug] [MainThread]: On master: COMMIT
[0m16:44:40.329885 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:44:40.330140 [debug] [MainThread]: On master: Close
[0m16:44:40.330642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:40.330860 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_revenue' was properly closed.
[0m16:44:40.331111 [info ] [MainThread]: 
[0m16:44:40.331325 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.58 seconds (9.58s).
[0m16:44:40.331817 [debug] [MainThread]: Command end result
[0m16:44:40.346714 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:44:40.348691 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:44:40.353000 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m16:44:40.353251 [info ] [MainThread]: 
[0m16:44:40.353505 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:44:40.353709 [info ] [MainThread]: 
[0m16:44:40.353939 [error] [MainThread]:   Database Error in model stg_fund_revenue (models/staging/stg_fund_revenue.sql)
  column "PROC_DT" does not exist
  LINE 14:     "PROC_DT",
               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_revenue.sql
[0m16:44:40.354134 [info ] [MainThread]: 
[0m16:44:40.354328 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:44:40.356111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.184315, "process_in_blocks": "0", "process_kernel_time": 0.235886, "process_mem_max_rss": "127713280", "process_out_blocks": "0", "process_user_time": 1.316575}
[0m16:44:40.356417 [debug] [MainThread]: Command `dbt run` failed at 16:44:40.356357 after 10.18 seconds
[0m16:44:40.356666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130f0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130f04f0>]}
[0m16:44:40.356900 [debug] [MainThread]: Flushing usage events
[0m16:44:41.154543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:23.760101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e08ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d199c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1a0e0>]}


============================== 16:46:23.768770 | 95e34578-bfed-415c-8598-8beee1dbaaab ==============================
[0m16:46:23.768770 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:46:23.769167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:46:23.910259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95e34578-bfed-415c-8598-8beee1dbaaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109066fb0>]}
[0m16:46:23.946097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95e34578-bfed-415c-8598-8beee1dbaaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090932e0>]}
[0m16:46:23.946981 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:46:24.030605 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:46:24.173532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:46:24.173992 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_revenue.sql
[0m16:46:24.174233 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m16:46:24.336241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95e34578-bfed-415c-8598-8beee1dbaaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a5fdc0>]}
[0m16:46:24.385826 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:46:24.389612 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:46:24.408041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95e34578-bfed-415c-8598-8beee1dbaaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc9060>]}
[0m16:46:24.408407 [info ] [MainThread]: Found 2 models, 7 sources, 434 macros
[0m16:46:24.408627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e34578-bfed-415c-8598-8beee1dbaaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc9000>]}
[0m16:46:24.409653 [info ] [MainThread]: 
[0m16:46:24.409879 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:46:24.410062 [info ] [MainThread]: 
[0m16:46:24.410369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:46:24.412923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:46:24.526933 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:46:24.527235 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:46:24.527420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:24.587341 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.060 seconds
[0m16:46:24.588301 [debug] [ThreadPool]: On list_postgres: Close
[0m16:46:24.589074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m16:46:24.593048 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:46:24.593291 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m16:46:24.593480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:24.606980 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:46:24.607291 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:46:24.607519 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m16:46:24.631996 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.024 seconds
[0m16:46:24.632954 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m16:46:24.633531 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m16:46:24.637165 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:24.637496 [debug] [MainThread]: On master: BEGIN
[0m16:46:24.637716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:24.652839 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:46:24.653086 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:24.653354 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:46:24.667098 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m16:46:24.668241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e34578-bfed-415c-8598-8beee1dbaaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a37f10>]}
[0m16:46:24.668619 [debug] [MainThread]: On master: ROLLBACK
[0m16:46:24.669452 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:24.669793 [debug] [MainThread]: On master: BEGIN
[0m16:46:24.670708 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:46:24.670993 [debug] [MainThread]: On master: COMMIT
[0m16:46:24.671237 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:24.671454 [debug] [MainThread]: On master: COMMIT
[0m16:46:24.672530 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:46:24.672848 [debug] [MainThread]: On master: Close
[0m16:46:24.675138 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m16:46:24.675564 [info ] [Thread-1 (]: 1 of 2 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m16:46:24.675934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m16:46:24.676204 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m16:46:24.686599 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m16:46:24.687504 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m16:46:24.713686 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m16:46:24.715096 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:46:24.715324 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m16:46:24.715523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:24.731700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:46:24.732013 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:46:24.732406 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "fund_cd" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."fund_cd"
  );
  
[0m16:46:24.733677 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fund_cd" does not exist
LINE 19:     select distinct "fund_cd" from "postgres"."igisam"."mtfn...
                             ^

[0m16:46:24.734030 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m16:46:24.734638 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m16:46:24.741247 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "fund_cd" does not exist
  LINE 19:     select distinct "fund_cd" from "postgres"."igisam"."mtfn...
                               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m16:46:24.742708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e34578-bfed-415c-8598-8beee1dbaaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cdffd0>]}
[0m16:46:24.743145 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.07s]
[0m16:46:24.743509 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m16:46:24.743749 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_revenue
[0m16:46:24.744054 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "fund_cd" does not exist
  LINE 19:     select distinct "fund_cd" from "postgres"."igisam"."mtfn...
                               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m16:46:24.744356 [info ] [Thread-1 (]: 2 of 2 START sql table model bi_staging.stg_fund_revenue ....................... [RUN]
[0m16:46:24.744974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.stg_fund_revenue)
[0m16:46:24.745198 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_revenue
[0m16:46:24.747054 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_revenue"
[0m16:46:24.748532 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_revenue
[0m16:46:24.750821 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_revenue"
[0m16:46:24.751591 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:46:24.751865 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: BEGIN
[0m16:46:24.752076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:24.767985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:46:24.768321 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:46:24.768550 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m16:46:59.108795 [debug] [Thread-1 (]: SQL status: SELECT 125496 in 34.338 seconds
[0m16:46:59.124069 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:46:59.124750 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */
alter table "postgres"."bi_staging"."stg_fund_revenue" rename to "stg_fund_revenue__dbt_backup"
[0m16:46:59.126985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:46:59.129233 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:46:59.129499 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */
alter table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp" rename to "stg_fund_revenue"
[0m16:46:59.131140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:59.144296 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: COMMIT
[0m16:46:59.144712 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:46:59.144966 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: COMMIT
[0m16:46:59.154628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m16:46:59.159387 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_revenue__dbt_backup"
[0m16:46:59.162300 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:46:59.162595 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */
drop table if exists "postgres"."bi_staging"."stg_fund_revenue__dbt_backup" cascade
[0m16:46:59.173253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:46:59.176195 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: Close
[0m16:46:59.177042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e34578-bfed-415c-8598-8beee1dbaaab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064082b0>]}
[0m16:46:59.177846 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bi_staging.stg_fund_revenue .................. [[32mSELECT 125496[0m in 34.43s]
[0m16:46:59.178376 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_revenue
[0m16:46:59.179775 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:59.180039 [debug] [MainThread]: On master: BEGIN
[0m16:46:59.180254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:59.210332 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m16:46:59.210667 [debug] [MainThread]: On master: COMMIT
[0m16:46:59.210875 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:59.211059 [debug] [MainThread]: On master: COMMIT
[0m16:46:59.211504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:46:59.211766 [debug] [MainThread]: On master: Close
[0m16:46:59.212087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:59.212281 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_revenue' was properly closed.
[0m16:46:59.212639 [info ] [MainThread]: 
[0m16:46:59.212896 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 34.80 seconds (34.80s).
[0m16:46:59.213463 [debug] [MainThread]: Command end result
[0m16:46:59.233613 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:46:59.243505 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:46:59.253168 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m16:46:59.253416 [info ] [MainThread]: 
[0m16:46:59.253677 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:46:59.254189 [info ] [MainThread]: 
[0m16:46:59.254553 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  column "fund_cd" does not exist
  LINE 19:     select distinct "fund_cd" from "postgres"."igisam"."mtfn...
                               ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m16:46:59.254801 [info ] [MainThread]: 
[0m16:46:59.255040 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:46:59.258176 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 35.563026, "process_in_blocks": "0", "process_kernel_time": 0.261721, "process_mem_max_rss": "128860160", "process_out_blocks": "0", "process_user_time": 1.451257}
[0m16:46:59.258607 [debug] [MainThread]: Command `dbt run` failed at 16:46:59.258540 after 35.56 seconds
[0m16:46:59.258935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e08ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e66260>]}
[0m16:46:59.259259 [debug] [MainThread]: Flushing usage events
[0m16:47:00.212606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:12.940715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108485990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084860b0>]}


============================== 16:47:12.945707 | 5d27debc-5fe0-4da7-a34d-2ed6901dac2a ==============================
[0m16:47:12.945707 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:47:12.946064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:47:13.092520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d27debc-5fe0-4da7-a34d-2ed6901dac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f6350>]}
[0m16:47:13.127698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d27debc-5fe0-4da7-a34d-2ed6901dac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108923370>]}
[0m16:47:13.128796 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:47:13.204844 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:47:13.335598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:47:13.336052 [debug] [MainThread]: Partial parsing: updated file: fund_dbt_project://models/staging/stg_fund_master.sql
[0m16:47:13.497516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d27debc-5fe0-4da7-a34d-2ed6901dac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e59c0>]}
[0m16:47:13.547331 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:47:13.556543 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:47:13.576077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d27debc-5fe0-4da7-a34d-2ed6901dac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931be50>]}
[0m16:47:13.576466 [info ] [MainThread]: Found 2 models, 7 sources, 434 macros
[0m16:47:13.576709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d27debc-5fe0-4da7-a34d-2ed6901dac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093155d0>]}
[0m16:47:13.577784 [info ] [MainThread]: 
[0m16:47:13.578016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:47:13.578194 [info ] [MainThread]: 
[0m16:47:13.578501 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:47:13.581197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:47:13.692569 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:47:13.692884 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:47:13.693079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:13.744691 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.052 seconds
[0m16:47:13.745707 [debug] [ThreadPool]: On list_postgres: Close
[0m16:47:13.746554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m16:47:13.750433 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:47:13.750679 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m16:47:13.750862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:13.761283 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:47:13.761611 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:47:13.761818 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m16:47:13.775608 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.014 seconds
[0m16:47:13.776631 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m16:47:13.777514 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m16:47:13.780536 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:13.780778 [debug] [MainThread]: On master: BEGIN
[0m16:47:13.780962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:13.792679 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:47:13.792972 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:13.793234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:47:13.805544 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m16:47:13.806567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d27debc-5fe0-4da7-a34d-2ed6901dac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e8f10>]}
[0m16:47:13.806925 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:13.807581 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:13.807934 [debug] [MainThread]: On master: BEGIN
[0m16:47:13.808696 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:47:13.808928 [debug] [MainThread]: On master: COMMIT
[0m16:47:13.809142 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:13.809334 [debug] [MainThread]: On master: COMMIT
[0m16:47:13.809866 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:47:13.810133 [debug] [MainThread]: On master: Close
[0m16:47:13.812358 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m16:47:13.812823 [info ] [Thread-1 (]: 1 of 2 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m16:47:13.813527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_master)
[0m16:47:13.813819 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m16:47:13.823485 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m16:47:13.824371 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m16:47:13.849992 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m16:47:13.850889 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:47:13.851115 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m16:47:13.851316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:13.867521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:47:13.867860 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:47:13.868253 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m16:47:22.796199 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 8.927 seconds
[0m16:47:22.809044 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:47:22.809374 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m16:47:22.810358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:47:22.812279 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:47:22.812531 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m16:47:22.813434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:47:22.824906 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:47:22.825271 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:47:22.825524 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:47:22.828348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:47:22.832722 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m16:47:22.835557 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:47:22.835844 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m16:47:22.848103 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m16:47:22.850058 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m16:47:22.851680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d27debc-5fe0-4da7-a34d-2ed6901dac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f942b0>]}
[0m16:47:22.852175 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.04s]
[0m16:47:22.852577 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m16:47:22.852854 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_revenue
[0m16:47:22.853208 [info ] [Thread-1 (]: 2 of 2 START sql table model bi_staging.stg_fund_revenue ....................... [RUN]
[0m16:47:22.853530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.stg_fund_revenue)
[0m16:47:22.853782 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_revenue
[0m16:47:22.856045 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_revenue"
[0m16:47:22.857197 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_revenue
[0m16:47:22.859609 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_revenue"
[0m16:47:22.860420 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:47:22.860781 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: BEGIN
[0m16:47:22.861030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:22.870224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m16:47:22.870525 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:47:22.870792 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m16:47:55.828846 [debug] [Thread-1 (]: SQL status: SELECT 125496 in 32.957 seconds
[0m16:47:55.834778 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:47:55.835144 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */
alter table "postgres"."bi_staging"."stg_fund_revenue" rename to "stg_fund_revenue__dbt_backup"
[0m16:47:55.836988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:47:55.838839 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:47:55.839082 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */
alter table "postgres"."bi_staging"."stg_fund_revenue__dbt_tmp" rename to "stg_fund_revenue"
[0m16:47:55.839932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:47:55.840791 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: COMMIT
[0m16:47:55.841079 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:47:55.841397 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: COMMIT
[0m16:47:55.843215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:47:55.845041 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_revenue__dbt_backup"
[0m16:47:55.845469 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_revenue"
[0m16:47:55.845732 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_revenue"} */
drop table if exists "postgres"."bi_staging"."stg_fund_revenue__dbt_backup" cascade
[0m16:47:55.854003 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m16:47:55.855114 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_revenue: Close
[0m16:47:55.855675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d27debc-5fe0-4da7-a34d-2ed6901dac2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f9c90>]}
[0m16:47:55.856203 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bi_staging.stg_fund_revenue .................. [[32mSELECT 125496[0m in 33.00s]
[0m16:47:55.856584 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_revenue
[0m16:47:55.857750 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:55.858057 [debug] [MainThread]: On master: BEGIN
[0m16:47:55.858250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:55.869261 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:47:55.869678 [debug] [MainThread]: On master: COMMIT
[0m16:47:55.869971 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:55.870176 [debug] [MainThread]: On master: COMMIT
[0m16:47:55.870761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:47:55.870990 [debug] [MainThread]: On master: Close
[0m16:47:55.871305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:55.871507 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_revenue' was properly closed.
[0m16:47:55.871783 [info ] [MainThread]: 
[0m16:47:55.872168 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 42.29 seconds (42.29s).
[0m16:47:55.872672 [debug] [MainThread]: Command end result
[0m16:47:55.891005 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:47:55.893575 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:47:55.898820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m16:47:55.899135 [info ] [MainThread]: 
[0m16:47:55.899422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:55.899631 [info ] [MainThread]: 
[0m16:47:55.899857 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:47:55.907913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 43.025864, "process_in_blocks": "0", "process_kernel_time": 0.241786, "process_mem_max_rss": "129007616", "process_out_blocks": "0", "process_user_time": 1.429325}
[0m16:47:55.908419 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:55.908340 after 43.03 seconds
[0m16:47:55.908717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107861de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f6350>]}
[0m16:47:55.908997 [debug] [MainThread]: Flushing usage events
[0m16:47:56.726055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:08.183644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b159c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b160e0>]}


============================== 16:48:08.189022 | adc47a69-17a8-4dc7-85a8-2ee1dac0b84a ==============================
[0m16:48:08.189022 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:48:08.189383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/goonzardw/.dbt', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:48:08.326079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adc47a69-17a8-4dc7-85a8-2ee1dac0b84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5efb0>]}
[0m16:48:08.360215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adc47a69-17a8-4dc7-85a8-2ee1dac0b84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e872e0>]}
[0m16:48:08.361205 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:48:08.441253 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:48:08.565921 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:48:08.566336 [debug] [MainThread]: Partial parsing: added file: fund_dbt_project://models/staging/stg_fund_ledger.sql
[0m16:48:08.566523 [debug] [MainThread]: Partial parsing: deleted file: fund_dbt_project://models/staging/stg_fund_revenue.sql
[0m16:48:08.722773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adc47a69-17a8-4dc7-85a8-2ee1dac0b84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e7e50>]}
[0m16:48:08.772309 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:48:08.778456 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:48:08.799396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adc47a69-17a8-4dc7-85a8-2ee1dac0b84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e59f0>]}
[0m16:48:08.799825 [info ] [MainThread]: Found 2 models, 7 sources, 434 macros
[0m16:48:08.800071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adc47a69-17a8-4dc7-85a8-2ee1dac0b84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6b940>]}
[0m16:48:08.801127 [info ] [MainThread]: 
[0m16:48:08.801363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:48:08.801550 [info ] [MainThread]: 
[0m16:48:08.801887 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:48:08.804655 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:48:08.921281 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:48:08.921621 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:48:08.921820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:08.978915 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.057 seconds
[0m16:48:08.979847 [debug] [ThreadPool]: On list_postgres: Close
[0m16:48:08.980647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m16:48:08.984934 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:48:08.985223 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m16:48:08.985406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:08.998308 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:48:08.998617 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:48:08.998814 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m16:48:09.011570 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m16:48:09.012485 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m16:48:09.013371 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m16:48:09.016454 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:09.016705 [debug] [MainThread]: On master: BEGIN
[0m16:48:09.016882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:09.042561 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m16:48:09.042996 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:09.043383 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:48:09.065738 [debug] [MainThread]: SQL status: SELECT 0 in 0.022 seconds
[0m16:48:09.067060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adc47a69-17a8-4dc7-85a8-2ee1dac0b84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672c370>]}
[0m16:48:09.067484 [debug] [MainThread]: On master: ROLLBACK
[0m16:48:09.068744 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:09.069346 [debug] [MainThread]: On master: BEGIN
[0m16:48:09.070768 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:48:09.071057 [debug] [MainThread]: On master: COMMIT
[0m16:48:09.071269 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:09.071457 [debug] [MainThread]: On master: COMMIT
[0m16:48:09.072034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:48:09.072273 [debug] [MainThread]: On master: Close
[0m16:48:09.075417 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_ledger
[0m16:48:09.075880 [info ] [Thread-1 (]: 1 of 2 START sql table model bi_staging.stg_fund_ledger ........................ [RUN]
[0m16:48:09.076243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_ledger)
[0m16:48:09.076486 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_ledger
[0m16:48:09.082065 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_ledger"
[0m16:48:09.082685 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_ledger
[0m16:48:09.111610 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_ledger"
[0m16:48:09.113580 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m16:48:09.113844 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: BEGIN
[0m16:48:09.114071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:09.132605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:48:09.133266 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m16:48:09.133618 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m16:48:42.334258 [debug] [Thread-1 (]: SQL status: SELECT 125496 in 33.199 seconds
[0m16:48:42.349261 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m16:48:42.349767 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp" rename to "stg_fund_ledger"
[0m16:48:42.353780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:48:42.365775 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m16:48:42.366164 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m16:48:42.366429 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m16:48:42.368273 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:48:42.373201 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_ledger__dbt_backup"
[0m16:48:42.376366 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m16:48:42.376671 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
drop table if exists "postgres"."bi_staging"."stg_fund_ledger__dbt_backup" cascade
[0m16:48:42.377696 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:48:42.380394 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: Close
[0m16:48:42.382683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc47a69-17a8-4dc7-85a8-2ee1dac0b84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10290c250>]}
[0m16:48:42.383416 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bi_staging.stg_fund_ledger ................... [[32mSELECT 125496[0m in 33.30s]
[0m16:48:42.383910 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_ledger
[0m16:48:42.384237 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m16:48:42.384768 [info ] [Thread-1 (]: 2 of 2 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m16:48:42.385127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_ledger, now model.fund_dbt_project.stg_fund_master)
[0m16:48:42.385395 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m16:48:42.393434 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m16:48:42.394629 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m16:48:42.397395 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m16:48:42.407449 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:48:42.407882 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m16:48:42.408246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:42.421128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:48:42.421574 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:48:42.422005 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m16:48:51.908835 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.486 seconds
[0m16:48:51.916674 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:48:51.916989 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m16:48:51.917797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:48:51.919688 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:48:51.919929 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m16:48:51.920750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:48:51.922800 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:48:51.923047 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:48:51.923260 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:48:51.927475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:48:51.929951 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m16:48:51.930347 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:48:51.930597 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m16:48:51.938638 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m16:48:51.939546 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m16:48:51.939959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc47a69-17a8-4dc7-85a8-2ee1dac0b84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f49570>]}
[0m16:48:51.940381 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.55s]
[0m16:48:51.940745 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m16:48:51.941693 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:51.941911 [debug] [MainThread]: On master: BEGIN
[0m16:48:51.942084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:51.951551 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:48:51.951869 [debug] [MainThread]: On master: COMMIT
[0m16:48:51.952072 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:51.952256 [debug] [MainThread]: On master: COMMIT
[0m16:48:51.952789 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:48:51.952979 [debug] [MainThread]: On master: Close
[0m16:48:51.953246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:51.953424 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m16:48:51.953730 [info ] [MainThread]: 
[0m16:48:51.953947 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 43.15 seconds (43.15s).
[0m16:48:51.954439 [debug] [MainThread]: Command end result
[0m16:48:51.972281 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:48:51.976059 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:48:51.982552 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m16:48:51.982850 [info ] [MainThread]: 
[0m16:48:51.983149 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:48:51.983365 [info ] [MainThread]: 
[0m16:48:51.983620 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:48:51.986602 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 43.8648, "process_in_blocks": "0", "process_kernel_time": 0.262465, "process_mem_max_rss": "129744896", "process_out_blocks": "0", "process_user_time": 1.471105}
[0m16:48:51.986955 [debug] [MainThread]: Command `dbt run` succeeded at 16:48:51.986895 after 43.87 seconds
[0m16:48:51.987284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c81de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673d0c0>]}
[0m16:48:51.987549 [debug] [MainThread]: Flushing usage events
[0m16:48:52.868113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:41.601451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a608d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5159f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b516110>]}


============================== 16:55:41.616400 | 1d418659-a1c5-422a-93e2-85c5554e4a9b ==============================
[0m16:55:41.616400 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:55:41.616888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:42.133145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d418659-a1c5-422a-93e2-85c5554e4a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b954880>]}
[0m16:55:42.168305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d418659-a1c5-422a-93e2-85c5554e4a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6ac700>]}
[0m16:55:42.172454 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:55:42.327056 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:55:42.601463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:55:42.601955 [debug] [MainThread]: Partial parsing: added file: fund_dbt_project://models/marts/fund/mart_fund_ledger_value_ar_rent.sql
[0m16:55:42.602259 [debug] [MainThread]: Partial parsing: added file: fund_dbt_project://models/marts/fund/schema.yml
[0m16:55:42.756640 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'mart_fund_ledger_11304' in the 'models' section of file 'models/marts/fund/schema.yml'
[0m16:55:42.806766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d418659-a1c5-422a-93e2-85c5554e4a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c3b77f0>]}
[0m16:55:42.890521 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:55:42.899797 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:55:43.041052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d418659-a1c5-422a-93e2-85c5554e4a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c45a740>]}
[0m16:55:43.041590 [info ] [MainThread]: Found 3 models, 7 sources, 434 macros
[0m16:55:43.041965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d418659-a1c5-422a-93e2-85c5554e4a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c45af80>]}
[0m16:55:43.043567 [info ] [MainThread]: 
[0m16:55:43.044068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:43.044400 [info ] [MainThread]: 
[0m16:55:43.044832 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:55:43.048640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:55:44.320704 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:55:44.321132 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:55:44.321383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:44.571894 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.250 seconds
[0m16:55:44.573902 [debug] [ThreadPool]: On list_postgres: Close
[0m16:55:44.576930 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:55:44.577396 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:55:44.577877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:44.605275 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.027 seconds
[0m16:55:44.607157 [debug] [ThreadPool]: On list_postgres: Close
[0m16:55:44.608790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m16:55:44.615579 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:55:44.615993 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m16:55:44.616277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:44.633811 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:55:44.634289 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m16:55:44.634620 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m16:55:44.687571 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.053 seconds
[0m16:55:44.689165 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m16:55:44.694094 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m16:55:44.694875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now list_postgres_bi)
[0m16:55:44.697442 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi"
[0m16:55:44.697751 [debug] [ThreadPool]: On list_postgres_bi: BEGIN
[0m16:55:44.698003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:44.715536 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:55:44.716132 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi"
[0m16:55:44.716554 [debug] [ThreadPool]: On list_postgres_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi'
  
[0m16:55:44.724341 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m16:55:44.725883 [debug] [ThreadPool]: On list_postgres_bi: ROLLBACK
[0m16:55:44.726761 [debug] [ThreadPool]: On list_postgres_bi: Close
[0m16:55:44.730757 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:44.731097 [debug] [MainThread]: On master: BEGIN
[0m16:55:44.731335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:44.751714 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m16:55:44.752262 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:44.752622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:55:44.866145 [debug] [MainThread]: SQL status: SELECT 0 in 0.113 seconds
[0m16:55:44.870284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d418659-a1c5-422a-93e2-85c5554e4a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1a1f00>]}
[0m16:55:44.871203 [debug] [MainThread]: On master: ROLLBACK
[0m16:55:44.872567 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:44.872890 [debug] [MainThread]: On master: BEGIN
[0m16:55:44.874138 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:55:44.874364 [debug] [MainThread]: On master: COMMIT
[0m16:55:44.874570 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:44.874770 [debug] [MainThread]: On master: COMMIT
[0m16:55:44.875713 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:55:44.875925 [debug] [MainThread]: On master: Close
[0m16:55:44.890677 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_ledger
[0m16:55:44.891601 [info ] [Thread-1 (]: 1 of 3 START sql table model bi_staging.stg_fund_ledger ........................ [RUN]
[0m16:55:44.892008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi, now model.fund_dbt_project.stg_fund_ledger)
[0m16:55:44.892290 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_ledger
[0m16:55:44.903835 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_ledger"
[0m16:55:44.906556 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_ledger
[0m16:55:44.943747 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_ledger"
[0m16:55:44.946857 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m16:55:44.947128 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: BEGIN
[0m16:55:44.947370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:44.963311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:55:44.963725 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m16:55:44.964031 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m16:56:18.171158 [debug] [Thread-1 (]: SQL status: SELECT 125496 in 33.205 seconds
[0m16:56:18.181921 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m16:56:18.182313 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger" rename to "stg_fund_ledger__dbt_backup"
[0m16:56:18.184522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:56:18.186819 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m16:56:18.187203 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp" rename to "stg_fund_ledger"
[0m16:56:18.188942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:56:18.198981 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m16:56:18.199295 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m16:56:18.199516 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m16:56:18.201888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:56:18.205943 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_ledger__dbt_backup"
[0m16:56:18.208395 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m16:56:18.208641 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
drop table if exists "postgres"."bi_staging"."stg_fund_ledger__dbt_backup" cascade
[0m16:56:18.225402 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m16:56:18.227528 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: Close
[0m16:56:18.235028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d418659-a1c5-422a-93e2-85c5554e4a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b99de10>]}
[0m16:56:18.235717 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bi_staging.stg_fund_ledger ................... [[32mSELECT 125496[0m in 33.34s]
[0m16:56:18.236148 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_ledger
[0m16:56:18.236547 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m16:56:18.237162 [info ] [Thread-1 (]: 2 of 3 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m16:56:18.237507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_ledger, now model.fund_dbt_project.stg_fund_master)
[0m16:56:18.237739 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m16:56:18.245149 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m16:56:18.249722 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m16:56:18.252240 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m16:56:18.252984 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:56:18.253222 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m16:56:18.253427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:18.264808 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:56:18.265204 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:56:18.265630 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m16:56:27.967557 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.701 seconds
[0m16:56:27.973563 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:56:27.973906 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m16:56:27.975298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:56:27.977424 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:56:27.977690 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m16:56:27.978610 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:56:27.979424 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:56:27.979659 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:56:27.979869 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m16:56:27.984340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:56:27.985852 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m16:56:27.986469 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m16:56:27.986794 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m16:56:27.991906 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m16:56:27.998257 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m16:56:27.999594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d418659-a1c5-422a-93e2-85c5554e4a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c019570>]}
[0m16:56:28.000094 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.76s]
[0m16:56:28.000519 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m16:56:28.000885 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.mart_fund_ledger_value_ar_rent
[0m16:56:28.001295 [info ] [Thread-1 (]: 3 of 3 START sql view model bi.mart_fund_ledger_value_ar_rent .................. [RUN]
[0m16:56:28.001652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.mart_fund_ledger_value_ar_rent)
[0m16:56:28.002005 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.mart_fund_ledger_value_ar_rent
[0m16:56:28.004046 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m16:56:28.004611 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.mart_fund_ledger_value_ar_rent
[0m16:56:28.017315 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m16:56:28.018048 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m16:56:28.018300 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: BEGIN
[0m16:56:28.018523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:28.027852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m16:56:28.028312 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m16:56:28.028572 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"} */

  create view "postgres"."bi"."mart_fund_ledger_value_ar_rent__dbt_tmp"
    
    
  as (
    with filtered as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    dc_div,
    pre_bal,
    debt_amt,
    credit_amt
  from "postgres"."bi_staging"."stg_fund_ledger"
  where acct_cd in ('11304')
),

calc as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    case
      when dc_div = 'D' then pre_bal + debt_amt - credit_amt
      when dc_div = 'C' then pre_bal + credit_amt - debt_amt
      else null
    end as value
  from filtered
)

select * from calc
  );
[0m16:56:28.057594 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m16:56:28.059829 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m16:56:28.060097 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"} */
alter table "postgres"."bi"."mart_fund_ledger_value_ar_rent__dbt_tmp" rename to "mart_fund_ledger_value_ar_rent"
[0m16:56:28.060836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:56:28.061583 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: COMMIT
[0m16:56:28.061872 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m16:56:28.062076 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: COMMIT
[0m16:56:28.071136 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m16:56:28.072678 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi"."mart_fund_ledger_value_ar_rent__dbt_backup"
[0m16:56:28.074323 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m16:56:28.074601 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"} */
drop view if exists "postgres"."bi"."mart_fund_ledger_value_ar_rent__dbt_backup" cascade
[0m16:56:28.075338 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:56:28.076179 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: Close
[0m16:56:28.076550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d418659-a1c5-422a-93e2-85c5554e4a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1e7e80>]}
[0m16:56:28.076946 [info ] [Thread-1 (]: 3 of 3 OK created sql view model bi.mart_fund_ledger_value_ar_rent ............. [[32mCREATE VIEW[0m in 0.07s]
[0m16:56:28.077274 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.mart_fund_ledger_value_ar_rent
[0m16:56:28.078253 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:28.078547 [debug] [MainThread]: On master: BEGIN
[0m16:56:28.078735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:56:28.096270 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m16:56:28.096612 [debug] [MainThread]: On master: COMMIT
[0m16:56:28.096820 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:28.096992 [debug] [MainThread]: On master: COMMIT
[0m16:56:28.097471 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:56:28.097702 [debug] [MainThread]: On master: Close
[0m16:56:28.098063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:28.098289 [debug] [MainThread]: Connection 'model.fund_dbt_project.mart_fund_ledger_value_ar_rent' was properly closed.
[0m16:56:28.098605 [info ] [MainThread]: 
[0m16:56:28.098853 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 45.05 seconds (45.05s).
[0m16:56:28.099493 [debug] [MainThread]: Command end result
[0m16:56:28.115648 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m16:56:28.119112 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m16:56:28.124683 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m16:56:28.124915 [info ] [MainThread]: 
[0m16:56:28.125175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:56:28.125361 [info ] [MainThread]: 
[0m16:56:28.125563 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:56:28.134661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 46.630463, "process_in_blocks": "0", "process_kernel_time": 0.468993, "process_mem_max_rss": "131514368", "process_out_blocks": "0", "process_user_time": 2.08903}
[0m16:56:28.135119 [debug] [MainThread]: Command `dbt run` succeeded at 16:56:28.135059 after 46.63 seconds
[0m16:56:28.135434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a608d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c0440d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c420a60>]}
[0m16:56:28.135680 [debug] [MainThread]: Flushing usage events
[0m16:56:29.036089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:03.351781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076218d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107621fc0>]}


============================== 17:00:03.356055 | 387cd9ca-a335-4004-a999-5ff606158796 ==============================
[0m17:00:03.356055 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:00:03.356411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:00:03.496822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '387cd9ca-a335-4004-a999-5ff606158796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733f6d0>]}
[0m17:00:03.532526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '387cd9ca-a335-4004-a999-5ff606158796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a57df0>]}
[0m17:00:03.533602 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:00:03.613552 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:00:03.673702 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:00:03.674118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '387cd9ca-a335-4004-a999-5ff606158796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e67610>]}
[0m17:00:04.493735 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'mart_fund_ledger_11304' in the 'models' section of file 'models/marts/fund/schema.yml'
[0m17:00:04.552944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '387cd9ca-a335-4004-a999-5ff606158796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186e8130>]}
[0m17:00:04.604261 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:00:04.614696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:00:04.635044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '387cd9ca-a335-4004-a999-5ff606158796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186eae30>]}
[0m17:00:04.635417 [info ] [MainThread]: Found 3 models, 7 sources, 434 macros
[0m17:00:04.635635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '387cd9ca-a335-4004-a999-5ff606158796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186e8220>]}
[0m17:00:04.636633 [info ] [MainThread]: 
[0m17:00:04.636857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:00:04.637035 [info ] [MainThread]: 
[0m17:00:04.637337 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:00:04.639938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:00:04.746465 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:00:04.746787 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:00:04.746972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:04.797836 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.051 seconds
[0m17:00:04.798793 [debug] [ThreadPool]: On list_postgres: Close
[0m17:00:04.800688 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:00:04.801086 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:00:04.801334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:04.816550 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m17:00:04.817574 [debug] [ThreadPool]: On list_postgres: Close
[0m17:00:04.818030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_bi_bi)
[0m17:00:04.818522 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "bi_bi"
"
[0m17:00:04.822058 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_bi"
[0m17:00:04.822324 [debug] [ThreadPool]: On create_postgres_bi_bi: BEGIN
[0m17:00:04.822513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:04.837548 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m17:00:04.837875 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_bi"
[0m17:00:04.838086 [debug] [ThreadPool]: On create_postgres_bi_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "create_postgres_bi_bi"} */
create schema if not exists "bi_bi"
[0m17:00:04.846392 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.008 seconds
[0m17:00:04.847173 [debug] [ThreadPool]: On create_postgres_bi_bi: COMMIT
[0m17:00:04.847409 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_bi"
[0m17:00:04.847614 [debug] [ThreadPool]: On create_postgres_bi_bi: COMMIT
[0m17:00:04.850863 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m17:00:04.851096 [debug] [ThreadPool]: On create_postgres_bi_bi: Close
[0m17:00:04.851936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_bi_bi, now list_postgres_bi_staging)
[0m17:00:04.856178 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:00:04.856459 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m17:00:04.856665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:04.870784 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m17:00:04.871112 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:00:04.871352 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m17:00:04.888414 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.017 seconds
[0m17:00:04.889394 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m17:00:04.894023 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m17:00:04.894437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now list_postgres_bi_bi)
[0m17:00:04.896037 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:00:04.896660 [debug] [ThreadPool]: On list_postgres_bi_bi: BEGIN
[0m17:00:04.896877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:04.906694 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:00:04.907053 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:00:04.907313 [debug] [ThreadPool]: On list_postgres_bi_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_bi"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_bi'
  
[0m17:00:04.913055 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m17:00:04.913955 [debug] [ThreadPool]: On list_postgres_bi_bi: ROLLBACK
[0m17:00:04.914501 [debug] [ThreadPool]: On list_postgres_bi_bi: Close
[0m17:00:04.918986 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:04.919368 [debug] [MainThread]: On master: BEGIN
[0m17:00:04.919597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:04.929413 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:00:04.929735 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:04.930028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:00:04.937566 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m17:00:04.938882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '387cd9ca-a335-4004-a999-5ff606158796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e2110>]}
[0m17:00:04.939247 [debug] [MainThread]: On master: ROLLBACK
[0m17:00:04.939820 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:04.940054 [debug] [MainThread]: On master: BEGIN
[0m17:00:04.940775 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:00:04.940999 [debug] [MainThread]: On master: COMMIT
[0m17:00:04.941211 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:04.941414 [debug] [MainThread]: On master: COMMIT
[0m17:00:04.941885 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:00:04.942151 [debug] [MainThread]: On master: Close
[0m17:00:04.946128 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_ledger
[0m17:00:04.946550 [info ] [Thread-1 (]: 1 of 3 START sql table model bi_staging.stg_fund_ledger ........................ [RUN]
[0m17:00:04.946908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_bi, now model.fund_dbt_project.stg_fund_ledger)
[0m17:00:04.947179 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_ledger
[0m17:00:04.953429 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:00:04.954707 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_ledger
[0m17:00:04.980213 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:00:04.981008 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:00:04.981246 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: BEGIN
[0m17:00:04.981447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:04.996188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m17:00:04.996542 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:00:04.996781 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m17:00:39.226560 [debug] [Thread-1 (]: SQL status: SELECT 125496 in 34.229 seconds
[0m17:00:39.234778 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:00:39.235092 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger" rename to "stg_fund_ledger__dbt_backup"
[0m17:00:39.236568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:39.238571 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:00:39.238829 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp" rename to "stg_fund_ledger"
[0m17:00:39.239718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:39.254728 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:00:39.255245 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:00:39.255588 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:00:39.322256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.066 seconds
[0m17:00:39.365320 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_ledger__dbt_backup"
[0m17:00:39.368746 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:00:39.369135 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
drop table if exists "postgres"."bi_staging"."stg_fund_ledger__dbt_backup" cascade
[0m17:00:39.380452 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m17:00:39.382537 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: Close
[0m17:00:39.384236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387cd9ca-a335-4004-a999-5ff606158796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b44f0>]}
[0m17:00:39.384927 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bi_staging.stg_fund_ledger ................... [[32mSELECT 125496[0m in 34.44s]
[0m17:00:39.385389 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_ledger
[0m17:00:39.385693 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m17:00:39.386197 [info ] [Thread-1 (]: 2 of 3 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m17:00:39.386768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_ledger, now model.fund_dbt_project.stg_fund_master)
[0m17:00:39.387092 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m17:00:39.393407 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m17:00:39.394631 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m17:00:39.397064 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m17:00:39.397814 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:00:39.398068 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m17:00:39.398284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:39.408315 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:00:39.408697 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:00:39.409103 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m17:00:48.665660 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.255 seconds
[0m17:00:48.671033 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:00:48.671333 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m17:00:48.672208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:48.674064 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:00:48.674309 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m17:00:48.675161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:48.675933 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:00:48.676167 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:00:48.676375 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:00:48.682562 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:00:48.684378 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m17:00:48.684956 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:00:48.685219 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m17:00:48.697790 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m17:00:48.700411 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m17:00:48.701053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387cd9ca-a335-4004-a999-5ff606158796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c120b0>]}
[0m17:00:48.701626 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.31s]
[0m17:00:48.702012 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m17:00:48.702269 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.mart_fund_ledger_value_ar_rent
[0m17:00:48.702638 [info ] [Thread-1 (]: 3 of 3 START sql incremental model bi_bi.mart_fund_ledger_value_ar_rent ........ [RUN]
[0m17:00:48.702948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.mart_fund_ledger_value_ar_rent)
[0m17:00:48.703185 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.mart_fund_ledger_value_ar_rent
[0m17:00:48.706092 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m17:00:48.706787 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.mart_fund_ledger_value_ar_rent
[0m17:00:48.727086 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m17:00:48.731339 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m17:00:48.731629 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: BEGIN
[0m17:00:48.731878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:48.741569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:00:48.741953 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m17:00:48.742232 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"} */

      
  
    

  create  table "postgres"."bi_bi"."mart_fund_ledger_value_ar_rent"
  
  
    as
  
  (
    with filtered as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    dc_div,
    pre_bal,
    debt_amt,
    credit_amt
  from "postgres"."bi_staging"."stg_fund_ledger"
  where acct_cd in ('11304')
),

calc as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    case
      when dc_div = 'D' then pre_bal + debt_amt - credit_amt
      when dc_div = 'C' then pre_bal + credit_amt - debt_amt
      else null
    end as value
  from filtered
)

select * from calc
  );
  
  
[0m17:00:48.771713 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.029 seconds
[0m17:00:48.772752 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: COMMIT
[0m17:00:48.773011 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_ar_rent"
[0m17:00:48.773237 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: COMMIT
[0m17:00:48.775493 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:00:48.775992 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_ar_rent: Close
[0m17:00:48.776376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387cd9ca-a335-4004-a999-5ff606158796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119046110>]}
[0m17:00:48.776790 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model bi_bi.mart_fund_ledger_value_ar_rent ... [[32mSELECT 74[0m in 0.07s]
[0m17:00:48.777141 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.mart_fund_ledger_value_ar_rent
[0m17:00:48.777904 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:48.778117 [debug] [MainThread]: On master: BEGIN
[0m17:00:48.778301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:48.790209 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:00:48.790553 [debug] [MainThread]: On master: COMMIT
[0m17:00:48.790763 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:48.790950 [debug] [MainThread]: On master: COMMIT
[0m17:00:48.791359 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:00:48.791553 [debug] [MainThread]: On master: Close
[0m17:00:48.791846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:48.792028 [debug] [MainThread]: Connection 'model.fund_dbt_project.mart_fund_ledger_value_ar_rent' was properly closed.
[0m17:00:48.792294 [info ] [MainThread]: 
[0m17:00:48.792534 [info ] [MainThread]: Finished running 1 incremental model, 2 table models in 0 hours 0 minutes and 44.15 seconds (44.15s).
[0m17:00:48.793203 [debug] [MainThread]: Command end result
[0m17:00:48.809958 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:00:48.815700 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:00:48.821388 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m17:00:48.821725 [info ] [MainThread]: 
[0m17:00:48.822045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:48.822283 [info ] [MainThread]: 
[0m17:00:48.822542 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:00:48.824732 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 45.535725, "process_in_blocks": "0", "process_kernel_time": 0.253638, "process_mem_max_rss": "133300224", "process_out_blocks": "0", "process_user_time": 2.020933}
[0m17:00:48.825064 [debug] [MainThread]: Command `dbt run` succeeded at 17:00:48.824999 after 45.54 seconds
[0m17:00:48.825360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d37940>]}
[0m17:00:48.825654 [debug] [MainThread]: Flushing usage events
[0m17:00:49.746867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:05.605086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105788ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064999f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649a0e0>]}


============================== 17:01:05.609697 | 9299e619-9327-4edd-b3be-0b6860ba6f59 ==============================
[0m17:01:05.609697 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:01:05.610092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:01:05.747861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9299e619-9327-4edd-b3be-0b6860ba6f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040d4bb0>]}
[0m17:01:05.783640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9299e619-9327-4edd-b3be-0b6860ba6f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581d960>]}
[0m17:01:05.784616 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:01:05.863418 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:01:05.981424 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:01:05.981859 [debug] [MainThread]: Partial parsing: added file: fund_dbt_project://models/marts/fund/mart_fund_ledger_value_11304.sql
[0m17:01:05.982051 [debug] [MainThread]: Partial parsing: deleted file: fund_dbt_project://models/marts/fund/mart_fund_ledger_value_ar_rent.sql
[0m17:01:06.141393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9299e619-9327-4edd-b3be-0b6860ba6f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107595180>]}
[0m17:01:06.198717 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:01:06.203829 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:01:06.220940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9299e619-9327-4edd-b3be-0b6860ba6f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107596da0>]}
[0m17:01:06.221364 [info ] [MainThread]: Found 3 models, 7 sources, 434 macros
[0m17:01:06.221588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9299e619-9327-4edd-b3be-0b6860ba6f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c237c0>]}
[0m17:01:06.222639 [info ] [MainThread]: 
[0m17:01:06.222880 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:01:06.223059 [info ] [MainThread]: 
[0m17:01:06.223373 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:01:06.225969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:01:06.547156 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:01:06.547511 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:01:06.547714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:06.660885 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.113 seconds
[0m17:01:06.661982 [debug] [ThreadPool]: On list_postgres: Close
[0m17:01:06.663739 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:01:06.664045 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:01:06.664438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:06.677389 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.013 seconds
[0m17:01:06.678489 [debug] [ThreadPool]: On list_postgres: Close
[0m17:01:06.679516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m17:01:06.683514 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:01:06.683828 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m17:01:06.684009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:06.694736 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:01:06.695069 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:01:06.695294 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m17:01:06.703777 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m17:01:06.704713 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m17:01:06.705278 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m17:01:06.705686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now list_postgres_bi_bi)
[0m17:01:06.707389 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:01:06.707602 [debug] [ThreadPool]: On list_postgres_bi_bi: BEGIN
[0m17:01:06.707776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:06.717785 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:01:06.718124 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:01:06.718341 [debug] [ThreadPool]: On list_postgres_bi_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_bi"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_bi'
  
[0m17:01:06.722590 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m17:01:06.723504 [debug] [ThreadPool]: On list_postgres_bi_bi: ROLLBACK
[0m17:01:06.724086 [debug] [ThreadPool]: On list_postgres_bi_bi: Close
[0m17:01:06.727594 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:06.727876 [debug] [MainThread]: On master: BEGIN
[0m17:01:06.728060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:06.738612 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:01:06.738969 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:06.739248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:01:06.747618 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m17:01:06.748517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9299e619-9327-4edd-b3be-0b6860ba6f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f70a0>]}
[0m17:01:06.748854 [debug] [MainThread]: On master: ROLLBACK
[0m17:01:06.749476 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:06.749772 [debug] [MainThread]: On master: BEGIN
[0m17:01:06.750603 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:01:06.750890 [debug] [MainThread]: On master: COMMIT
[0m17:01:06.751116 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:06.751320 [debug] [MainThread]: On master: COMMIT
[0m17:01:06.751969 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:01:06.752286 [debug] [MainThread]: On master: Close
[0m17:01:06.754469 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_ledger
[0m17:01:06.754891 [info ] [Thread-1 (]: 1 of 3 START sql table model bi_staging.stg_fund_ledger ........................ [RUN]
[0m17:01:06.755248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_bi, now model.fund_dbt_project.stg_fund_ledger)
[0m17:01:06.755483 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_ledger
[0m17:01:06.760898 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:01:06.762011 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_ledger
[0m17:01:06.786955 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:01:06.787789 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:01:06.788118 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: BEGIN
[0m17:01:06.788332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:06.797642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:01:06.798009 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:01:06.798249 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m17:01:39.985664 [debug] [Thread-1 (]: SQL status: SELECT 125496 in 33.186 seconds
[0m17:01:39.998849 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:01:39.999588 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger" rename to "stg_fund_ledger__dbt_backup"
[0m17:01:40.002221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:01:40.004274 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:01:40.004719 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp" rename to "stg_fund_ledger"
[0m17:01:40.005766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:01:40.017000 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:01:40.017361 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:01:40.017621 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:01:40.019505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:01:40.024255 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_ledger__dbt_backup"
[0m17:01:40.027218 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:01:40.027518 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
drop table if exists "postgres"."bi_staging"."stg_fund_ledger__dbt_backup" cascade
[0m17:01:40.037694 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m17:01:40.040710 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: Close
[0m17:01:40.043100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9299e619-9327-4edd-b3be-0b6860ba6f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064499c0>]}
[0m17:01:40.043872 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bi_staging.stg_fund_ledger ................... [[32mSELECT 125496[0m in 33.29s]
[0m17:01:40.044415 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_ledger
[0m17:01:40.044787 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m17:01:40.045405 [info ] [Thread-1 (]: 2 of 3 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m17:01:40.045931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_ledger, now model.fund_dbt_project.stg_fund_master)
[0m17:01:40.046226 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m17:01:40.053531 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m17:01:40.055980 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m17:01:40.059412 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m17:01:40.069915 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:01:40.070215 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m17:01:40.070471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:40.089641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:01:40.090074 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:01:40.090542 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m17:01:49.490890 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.400 seconds
[0m17:01:49.494422 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:01:49.494709 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m17:01:49.495893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:01:49.497730 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:01:49.497963 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m17:01:49.498791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:01:49.499549 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:01:49.499782 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:01:49.499990 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:01:49.503453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:01:49.504981 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m17:01:49.506104 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:01:49.506884 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m17:01:49.513205 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:01:49.514213 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m17:01:49.514632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9299e619-9327-4edd-b3be-0b6860ba6f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644b370>]}
[0m17:01:49.515053 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.47s]
[0m17:01:49.515430 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m17:01:49.515688 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.mart_fund_ledger_value_11304
[0m17:01:49.516023 [info ] [Thread-1 (]: 3 of 3 START sql incremental model bi_bi.mart_fund_ledger_value_11304 .......... [RUN]
[0m17:01:49.516307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.mart_fund_ledger_value_11304)
[0m17:01:49.516532 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.mart_fund_ledger_value_11304
[0m17:01:49.518541 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.mart_fund_ledger_value_11304"
[0m17:01:49.519056 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.mart_fund_ledger_value_11304
[0m17:01:49.539325 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.mart_fund_ledger_value_11304"
[0m17:01:49.539999 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_11304"
[0m17:01:49.540270 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_11304: BEGIN
[0m17:01:49.540510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:49.556191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:01:49.556555 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_11304"
[0m17:01:49.556832 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_value_11304"} */

      
  
    

  create  table "postgres"."bi_bi"."mart_fund_ledger_value_11304"
  
  
    as
  
  (
    with filtered as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    dc_div,
    pre_bal,
    debt_amt,
    credit_amt
  from "postgres"."bi_staging"."stg_fund_ledger"
  where acct_cd in ('11304')
),

calc as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    case
      when dc_div = 'D' then pre_bal + debt_amt - credit_amt
      when dc_div = 'C' then pre_bal + credit_amt - debt_amt
      else null
    end as value
  from filtered
)

select * from calc
  );
  
  
[0m17:01:49.594606 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.037 seconds
[0m17:01:49.595640 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_11304: COMMIT
[0m17:01:49.595896 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_11304"
[0m17:01:49.596111 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_11304: COMMIT
[0m17:01:49.604618 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m17:01:49.605272 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_11304: Close
[0m17:01:49.605693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9299e619-9327-4edd-b3be-0b6860ba6f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742f3a0>]}
[0m17:01:49.606119 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model bi_bi.mart_fund_ledger_value_11304 ..... [[32mSELECT 74[0m in 0.09s]
[0m17:01:49.606485 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.mart_fund_ledger_value_11304
[0m17:01:49.607605 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:49.607925 [debug] [MainThread]: On master: BEGIN
[0m17:01:49.608137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:01:49.619384 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m17:01:49.619715 [debug] [MainThread]: On master: COMMIT
[0m17:01:49.619930 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:49.620122 [debug] [MainThread]: On master: COMMIT
[0m17:01:49.620544 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:01:49.620745 [debug] [MainThread]: On master: Close
[0m17:01:49.621031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:49.621213 [debug] [MainThread]: Connection 'model.fund_dbt_project.mart_fund_ledger_value_11304' was properly closed.
[0m17:01:49.621526 [info ] [MainThread]: 
[0m17:01:49.621904 [info ] [MainThread]: Finished running 1 incremental model, 2 table models in 0 hours 0 minutes and 43.40 seconds (43.40s).
[0m17:01:49.622529 [debug] [MainThread]: Command end result
[0m17:01:49.640736 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:01:49.643606 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:01:49.651613 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m17:01:49.651914 [info ] [MainThread]: 
[0m17:01:49.652226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:01:49.652459 [info ] [MainThread]: 
[0m17:01:49.652718 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:01:49.656220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 44.11724, "process_in_blocks": "0", "process_kernel_time": 0.291367, "process_mem_max_rss": "125681664", "process_out_blocks": "0", "process_user_time": 1.525084}
[0m17:01:49.656823 [debug] [MainThread]: Command `dbt run` succeeded at 17:01:49.656720 after 44.12 seconds
[0m17:01:49.657217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105788ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062be2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107596950>]}
[0m17:01:49.657532 [debug] [MainThread]: Flushing usage events
[0m17:01:50.617810 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:53.472277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f15a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f16140>]}


============================== 17:04:53.479362 | 5faea396-7575-4177-944d-2da26bfca327 ==============================
[0m17:04:53.479362 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:04:53.479727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:53.622345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5faea396-7575-4177-944d-2da26bfca327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d13f0>]}
[0m17:04:53.657376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5faea396-7575-4177-944d-2da26bfca327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c26b0>]}
[0m17:04:53.658370 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:04:53.740687 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:04:53.804493 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:04:53.804947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5faea396-7575-4177-944d-2da26bfca327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab781c0>]}
[0m17:04:54.548683 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'mart_fund_ledger_11304' in the 'models' section of file 'models/marts/fund/schema.yml'
[0m17:04:54.636533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5faea396-7575-4177-944d-2da26bfca327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd0a30>]}
[0m17:04:54.686324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:04:54.696729 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:04:54.720062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5faea396-7575-4177-944d-2da26bfca327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afca320>]}
[0m17:04:54.720449 [info ] [MainThread]: Found 3 models, 7 sources, 434 macros
[0m17:04:54.720667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5faea396-7575-4177-944d-2da26bfca327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afdb370>]}
[0m17:04:54.721681 [info ] [MainThread]: 
[0m17:04:54.721897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:54.722075 [info ] [MainThread]: 
[0m17:04:54.722396 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:04:54.725049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:04:55.213929 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:04:55.214355 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:04:55.214563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:55.265260 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.051 seconds
[0m17:04:55.266619 [debug] [ThreadPool]: On list_postgres: Close
[0m17:04:55.268710 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:04:55.269067 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:04:55.269390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:55.284042 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m17:04:55.285253 [debug] [ThreadPool]: On list_postgres: Close
[0m17:04:55.285824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_bi_bi)
[0m17:04:55.286508 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "bi_bi"
"
[0m17:04:55.290580 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_bi"
[0m17:04:55.290872 [debug] [ThreadPool]: On create_postgres_bi_bi: BEGIN
[0m17:04:55.291091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:55.305755 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m17:04:55.306148 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_bi"
[0m17:04:55.306395 [debug] [ThreadPool]: On create_postgres_bi_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "create_postgres_bi_bi"} */
create schema if not exists "bi_bi"
[0m17:04:55.312399 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.006 seconds
[0m17:04:55.313493 [debug] [ThreadPool]: On create_postgres_bi_bi: COMMIT
[0m17:04:55.313839 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_bi"
[0m17:04:55.314081 [debug] [ThreadPool]: On create_postgres_bi_bi: COMMIT
[0m17:04:55.316127 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m17:04:55.316446 [debug] [ThreadPool]: On create_postgres_bi_bi: Close
[0m17:04:55.317410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_bi_bi, now list_postgres_bi_bi)
[0m17:04:55.322215 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:04:55.322535 [debug] [ThreadPool]: On list_postgres_bi_bi: BEGIN
[0m17:04:55.322759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:55.347716 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m17:04:55.348103 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:04:55.348364 [debug] [ThreadPool]: On list_postgres_bi_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_bi"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_bi'
  
[0m17:04:55.356909 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m17:04:55.357897 [debug] [ThreadPool]: On list_postgres_bi_bi: ROLLBACK
[0m17:04:55.358567 [debug] [ThreadPool]: On list_postgres_bi_bi: Close
[0m17:04:55.358994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_bi_bi, now list_postgres_bi_staging)
[0m17:04:55.361438 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:04:55.361743 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m17:04:55.361968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:55.372925 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:04:55.373253 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:04:55.373503 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m17:04:55.380509 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m17:04:55.381558 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m17:04:55.382330 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m17:04:55.386618 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:55.386972 [debug] [MainThread]: On master: BEGIN
[0m17:04:55.387206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:55.401008 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m17:04:55.401380 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:55.401704 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:04:55.430342 [debug] [MainThread]: SQL status: SELECT 0 in 0.028 seconds
[0m17:04:55.431449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5faea396-7575-4177-944d-2da26bfca327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107920850>]}
[0m17:04:55.431851 [debug] [MainThread]: On master: ROLLBACK
[0m17:04:55.432733 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:55.433057 [debug] [MainThread]: On master: BEGIN
[0m17:04:55.433981 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:04:55.434245 [debug] [MainThread]: On master: COMMIT
[0m17:04:55.434491 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:55.434727 [debug] [MainThread]: On master: COMMIT
[0m17:04:55.435294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:04:55.435577 [debug] [MainThread]: On master: Close
[0m17:04:55.437867 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_ledger
[0m17:04:55.438331 [info ] [Thread-1 (]: 1 of 3 START sql table model bi_staging.stg_fund_ledger ........................ [RUN]
[0m17:04:55.438720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_ledger)
[0m17:04:55.439015 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_ledger
[0m17:04:55.445474 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:04:55.446915 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_ledger
[0m17:04:55.474218 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:04:55.478512 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:04:55.478749 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: BEGIN
[0m17:04:55.478961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:55.490150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m17:04:55.490475 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:04:55.490732 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m17:05:28.581889 [debug] [Thread-1 (]: SQL status: SELECT 125496 in 33.090 seconds
[0m17:05:28.593752 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:05:28.594170 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger" rename to "stg_fund_ledger__dbt_backup"
[0m17:05:28.595836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:28.598099 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:05:28.598362 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp" rename to "stg_fund_ledger"
[0m17:05:28.599199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:28.612111 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:05:28.612500 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:05:28.612751 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:05:28.614443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:05:28.658424 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_ledger__dbt_backup"
[0m17:05:28.661240 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:05:28.661509 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
drop table if exists "postgres"."bi_staging"."stg_fund_ledger__dbt_backup" cascade
[0m17:05:28.671495 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m17:05:28.673460 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: Close
[0m17:05:28.675049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5faea396-7575-4177-944d-2da26bfca327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a0340>]}
[0m17:05:28.675572 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bi_staging.stg_fund_ledger ................... [[32mSELECT 125496[0m in 33.24s]
[0m17:05:28.675970 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_ledger
[0m17:05:28.676242 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m17:05:28.676643 [info ] [Thread-1 (]: 2 of 3 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m17:05:28.676941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_ledger, now model.fund_dbt_project.stg_fund_master)
[0m17:05:28.677170 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m17:05:28.683280 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m17:05:28.684839 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m17:05:28.687329 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m17:05:28.688389 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:05:28.688672 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m17:05:28.688900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:28.719167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m17:05:28.719552 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:05:28.719965 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m17:05:38.061243 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.340 seconds
[0m17:05:38.067724 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:05:38.068301 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m17:05:38.069287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:38.071369 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:05:38.071629 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m17:05:38.072464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:05:38.073352 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:05:38.073601 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:05:38.073816 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:05:38.083462 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m17:05:38.086061 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m17:05:38.086472 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:05:38.086722 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m17:05:38.095387 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m17:05:38.096858 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m17:05:38.097357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5faea396-7575-4177-944d-2da26bfca327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae07af0>]}
[0m17:05:38.097860 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.42s]
[0m17:05:38.098248 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m17:05:38.098509 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.mart_fund_ledger_value_11304
[0m17:05:38.098933 [info ] [Thread-1 (]: 3 of 3 START sql incremental model bi_bi.mart_fund_ledger_value_11304 .......... [RUN]
[0m17:05:38.099283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.mart_fund_ledger_value_11304)
[0m17:05:38.099545 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.mart_fund_ledger_value_11304
[0m17:05:38.101920 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.mart_fund_ledger_value_11304"
[0m17:05:38.105184 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.mart_fund_ledger_value_11304
[0m17:05:38.129541 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.mart_fund_ledger_value_11304"
[0m17:05:38.138335 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_11304"
[0m17:05:38.138746 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_11304: BEGIN
[0m17:05:38.139005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:38.148941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:05:38.149431 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_11304"
[0m17:05:38.149713 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_value_11304"} */

      
  
    

  create  table "postgres"."bi_bi"."mart_fund_ledger_value_11304"
  
  
    as
  
  (
    with filtered as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    dc_div,
    pre_bal,
    debt_amt,
    credit_amt
  from "postgres"."bi_staging"."stg_fund_ledger"
  where acct_cd in ('11304')
),

calc as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    case
      when dc_div = 'D' then pre_bal + debt_amt - credit_amt
      when dc_div = 'C' then pre_bal + credit_amt - debt_amt
      else null
    end as value
  from filtered
)

select * from calc
  );
  
  
[0m17:05:38.177798 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.028 seconds
[0m17:05:38.178895 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_11304: COMMIT
[0m17:05:38.179390 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_value_11304"
[0m17:05:38.179838 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_11304: COMMIT
[0m17:05:38.182093 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:05:38.182769 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_value_11304: Close
[0m17:05:38.183211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5faea396-7575-4177-944d-2da26bfca327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b669600>]}
[0m17:05:38.183679 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model bi_bi.mart_fund_ledger_value_11304 ..... [[32mSELECT 74[0m in 0.08s]
[0m17:05:38.184060 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.mart_fund_ledger_value_11304
[0m17:05:38.185033 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:38.185318 [debug] [MainThread]: On master: BEGIN
[0m17:05:38.185518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:05:38.197873 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:05:38.198215 [debug] [MainThread]: On master: COMMIT
[0m17:05:38.198434 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:38.198635 [debug] [MainThread]: On master: COMMIT
[0m17:05:38.199073 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:05:38.199342 [debug] [MainThread]: On master: Close
[0m17:05:38.199663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:38.199879 [debug] [MainThread]: Connection 'model.fund_dbt_project.mart_fund_ledger_value_11304' was properly closed.
[0m17:05:38.200171 [info ] [MainThread]: 
[0m17:05:38.200444 [info ] [MainThread]: Finished running 1 incremental model, 2 table models in 0 hours 0 minutes and 43.48 seconds (43.48s).
[0m17:05:38.201395 [debug] [MainThread]: Command end result
[0m17:05:38.219849 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:05:38.221921 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:05:38.227801 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m17:05:38.228137 [info ] [MainThread]: 
[0m17:05:38.228457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:38.228691 [info ] [MainThread]: 
[0m17:05:38.228946 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:05:38.238007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 44.83188, "process_in_blocks": "0", "process_kernel_time": 0.333171, "process_mem_max_rss": "134250496", "process_out_blocks": "0", "process_user_time": 2.168613}
[0m17:05:38.238413 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:38.238344 after 44.83 seconds
[0m17:05:38.238723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd1c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d96c0>]}
[0m17:05:38.239015 [debug] [MainThread]: Flushing usage events
[0m17:05:39.159028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:23.245831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a22cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a233a0>]}


============================== 17:07:23.250004 | 2328a842-3964-4fa7-9008-5c9721cd26ed ==============================
[0m17:07:23.250004 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:07:23.250355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'profiles_dir': '/Users/goonzardw/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:07:23.395971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2328a842-3964-4fa7-9008-5c9721cd26ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104068bb0>]}
[0m17:07:23.429829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2328a842-3964-4fa7-9008-5c9721cd26ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5d960>]}
[0m17:07:23.430774 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:07:23.661731 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:07:23.946557 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:07:23.947228 [debug] [MainThread]: Partial parsing: added file: fund_dbt_project://models/marts/fund/mart_fund_ledger_11304.sql
[0m17:07:23.947542 [debug] [MainThread]: Partial parsing: deleted file: fund_dbt_project://models/marts/fund/mart_fund_ledger_value_11304.sql
[0m17:07:24.115297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2328a842-3964-4fa7-9008-5c9721cd26ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e5180>]}
[0m17:07:24.167341 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:07:24.171559 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:07:24.192967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2328a842-3964-4fa7-9008-5c9721cd26ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e6da0>]}
[0m17:07:24.193368 [info ] [MainThread]: Found 3 models, 7 sources, 434 macros
[0m17:07:24.193597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2328a842-3964-4fa7-9008-5c9721cd26ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f237c0>]}
[0m17:07:24.194696 [info ] [MainThread]: 
[0m17:07:24.194931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:24.195112 [info ] [MainThread]: 
[0m17:07:24.195422 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:07:24.198108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:07:25.963068 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:07:25.963533 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:07:25.963753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:26.105064 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.141 seconds
[0m17:07:26.106284 [debug] [ThreadPool]: On list_postgres: Close
[0m17:07:26.108662 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:07:26.109154 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:07:26.109582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:26.132154 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.022 seconds
[0m17:07:26.133316 [debug] [ThreadPool]: On list_postgres: Close
[0m17:07:26.134334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m17:07:26.139587 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:07:26.139944 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m17:07:26.140199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:26.161129 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m17:07:26.161576 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:07:26.161875 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m17:07:26.202126 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.040 seconds
[0m17:07:26.203583 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m17:07:26.204526 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m17:07:26.205111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now list_postgres_bi_bi)
[0m17:07:26.208022 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:07:26.208449 [debug] [ThreadPool]: On list_postgres_bi_bi: BEGIN
[0m17:07:26.208732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:26.227104 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m17:07:26.227539 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:07:26.227912 [debug] [ThreadPool]: On list_postgres_bi_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_bi"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_bi'
  
[0m17:07:26.242326 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m17:07:26.243825 [debug] [ThreadPool]: On list_postgres_bi_bi: ROLLBACK
[0m17:07:26.244722 [debug] [ThreadPool]: On list_postgres_bi_bi: Close
[0m17:07:26.249944 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:26.250376 [debug] [MainThread]: On master: BEGIN
[0m17:07:26.250687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:26.274725 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m17:07:26.275259 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:26.275704 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:07:26.327049 [debug] [MainThread]: SQL status: SELECT 0 in 0.051 seconds
[0m17:07:26.328728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2328a842-3964-4fa7-9008-5c9721cd26ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ff160>]}
[0m17:07:26.329422 [debug] [MainThread]: On master: ROLLBACK
[0m17:07:26.330603 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:26.331037 [debug] [MainThread]: On master: BEGIN
[0m17:07:26.332237 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:07:26.332624 [debug] [MainThread]: On master: COMMIT
[0m17:07:26.332953 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:26.333260 [debug] [MainThread]: On master: COMMIT
[0m17:07:26.333922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:07:26.334249 [debug] [MainThread]: On master: Close
[0m17:07:26.341964 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_ledger
[0m17:07:26.342847 [info ] [Thread-1 (]: 1 of 3 START sql table model bi_staging.stg_fund_ledger ........................ [RUN]
[0m17:07:26.343623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_bi, now model.fund_dbt_project.stg_fund_ledger)
[0m17:07:26.344149 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_ledger
[0m17:07:26.355251 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:07:26.381518 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_ledger
[0m17:07:26.416143 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:07:26.421145 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:07:26.421455 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: BEGIN
[0m17:07:26.421697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:26.442727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m17:07:26.443120 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:07:26.443395 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m17:07:59.945921 [debug] [Thread-1 (]: SQL status: SELECT 125496 in 33.502 seconds
[0m17:07:59.956813 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:07:59.957297 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger" rename to "stg_fund_ledger__dbt_backup"
[0m17:07:59.959657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:07:59.961882 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:07:59.962171 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp" rename to "stg_fund_ledger"
[0m17:07:59.963442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:59.974246 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:07:59.974655 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:07:59.974904 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:07:59.977105 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:07:59.981493 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_ledger__dbt_backup"
[0m17:07:59.984212 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:07:59.984506 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
drop table if exists "postgres"."bi_staging"."stg_fund_ledger__dbt_backup" cascade
[0m17:07:59.993815 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m17:07:59.996856 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: Close
[0m17:07:59.999477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2328a842-3964-4fa7-9008-5c9721cd26ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c99c0>]}
[0m17:08:00.000153 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bi_staging.stg_fund_ledger ................... [[32mSELECT 125496[0m in 33.65s]
[0m17:08:00.000579 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_ledger
[0m17:08:00.000878 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m17:08:00.001366 [info ] [Thread-1 (]: 2 of 3 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m17:08:00.001955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_ledger, now model.fund_dbt_project.stg_fund_master)
[0m17:08:00.002386 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m17:08:00.009887 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m17:08:00.011295 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m17:08:00.014910 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m17:08:00.015969 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:08:00.017004 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m17:08:00.017298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:00.037332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m17:08:00.037699 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:08:00.038093 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m17:08:09.272915 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.234 seconds
[0m17:08:09.278182 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:08:09.278507 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m17:08:09.279818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:09.282051 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:08:09.282334 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m17:08:09.283752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:09.286523 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:08:09.287400 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:08:09.288019 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:08:09.293320 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:08:09.295265 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m17:08:09.295663 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:08:09.295910 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m17:08:09.304759 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m17:08:09.307211 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m17:08:09.307746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2328a842-3964-4fa7-9008-5c9721cd26ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cb370>]}
[0m17:08:09.308188 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.31s]
[0m17:08:09.308542 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m17:08:09.308803 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:08:09.309144 [info ] [Thread-1 (]: 3 of 3 START sql incremental model bi_bi.mart_fund_ledger_11304 ................ [RUN]
[0m17:08:09.309454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.mart_fund_ledger_11304)
[0m17:08:09.309679 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:08:09.312100 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:08:09.312703 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:08:09.333512 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:08:09.334464 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:08:09.334804 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: BEGIN
[0m17:08:09.335036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:09.351967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:08:09.352327 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:08:09.352573 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_11304"} */

      
  
    

  create  table "postgres"."bi_bi"."mart_fund_ledger_11304"
  
  
    as
  
  (
    with filtered as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    dc_div,
    pre_bal,
    debt_amt,
    credit_amt
  from "postgres"."bi_staging"."stg_fund_ledger"
  where acct_cd in ('11304')
),

calc as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    case
      when dc_div = 'D' then pre_bal + debt_amt - credit_amt
      when dc_div = 'C' then pre_bal + credit_amt - debt_amt
      else null
    end as value
  from filtered
)

select * from calc
  );
  
  
[0m17:08:09.406558 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.054 seconds
[0m17:08:09.407845 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: COMMIT
[0m17:08:09.408130 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:08:09.408382 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: COMMIT
[0m17:08:09.411503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:08:09.412267 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: Close
[0m17:08:09.412751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2328a842-3964-4fa7-9008-5c9721cd26ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107732710>]}
[0m17:08:09.413193 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model bi_bi.mart_fund_ledger_11304 ........... [[32mSELECT 74[0m in 0.10s]
[0m17:08:09.413558 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:08:09.418389 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:09.420017 [debug] [MainThread]: On master: BEGIN
[0m17:08:09.420230 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:09.432579 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:08:09.432994 [debug] [MainThread]: On master: COMMIT
[0m17:08:09.433212 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:09.433407 [debug] [MainThread]: On master: COMMIT
[0m17:08:09.433895 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:08:09.434149 [debug] [MainThread]: On master: Close
[0m17:08:09.434470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:09.434665 [debug] [MainThread]: Connection 'model.fund_dbt_project.mart_fund_ledger_11304' was properly closed.
[0m17:08:09.434976 [info ] [MainThread]: 
[0m17:08:09.435287 [info ] [MainThread]: Finished running 1 incremental model, 2 table models in 0 hours 0 minutes and 45.24 seconds (45.24s).
[0m17:08:09.436042 [debug] [MainThread]: Command end result
[0m17:08:09.457275 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:08:09.465129 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:08:09.564423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m17:08:09.564794 [info ] [MainThread]: 
[0m17:08:09.565089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:08:09.565295 [info ] [MainThread]: 
[0m17:08:09.565520 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:08:09.603658 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 46.41735, "process_in_blocks": "0", "process_kernel_time": 0.329137, "process_mem_max_rss": "129302528", "process_out_blocks": "0", "process_user_time": 1.581922}
[0m17:08:09.604317 [debug] [MainThread]: Command `dbt run` succeeded at 17:08:09.604218 after 46.42 seconds
[0m17:08:09.604856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10683e2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e6950>]}
[0m17:08:09.605320 [debug] [MainThread]: Flushing usage events
[0m17:08:10.573176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:16.508608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bccd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a15a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a16140>]}


============================== 17:10:16.515876 | 46f0fc21-bb52-4ca5-9e5e-aa54c49ec9e3 ==============================
[0m17:10:16.515876 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:10:16.516285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:10:16.688457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46f0fc21-bb52-4ca5-9e5e-aa54c49ec9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023e93f0>]}
[0m17:10:16.724408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46f0fc21-bb52-4ca5-9e5e-aa54c49ec9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c966b0>]}
[0m17:10:16.729387 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:10:16.837938 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:10:16.905620 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:10:16.906049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46f0fc21-bb52-4ca5-9e5e-aa54c49ec9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059981c0>]}
[0m17:10:17.844499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46f0fc21-bb52-4ca5-9e5e-aa54c49ec9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df0d30>]}
[0m17:10:17.896947 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:10:17.900475 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:10:17.995138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46f0fc21-bb52-4ca5-9e5e-aa54c49ec9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e13eb0>]}
[0m17:10:17.995613 [info ] [MainThread]: Found 3 models, 7 sources, 434 macros
[0m17:10:17.995887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f0fc21-bb52-4ca5-9e5e-aa54c49ec9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f8d240>]}
[0m17:10:17.997146 [info ] [MainThread]: 
[0m17:10:17.997433 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:17.997660 [info ] [MainThread]: 
[0m17:10:17.998026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:18.001619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:10:19.324412 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:10:19.324754 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:10:19.324955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:19.379149 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.054 seconds
[0m17:10:19.380088 [debug] [ThreadPool]: On list_postgres: Close
[0m17:10:19.381718 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:10:19.381970 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:10:19.382149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:19.393475 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m17:10:19.394460 [debug] [ThreadPool]: On list_postgres: Close
[0m17:10:19.395263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_staging)
[0m17:10:19.399197 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:10:19.399476 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m17:10:19.399666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:19.413407 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m17:10:19.413744 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:10:19.413954 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m17:10:19.420177 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m17:10:19.421057 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m17:10:19.421643 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m17:10:19.422086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now list_postgres_bi_bi)
[0m17:10:19.423935 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:10:19.424207 [debug] [ThreadPool]: On list_postgres_bi_bi: BEGIN
[0m17:10:19.424390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:19.435588 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:10:19.435931 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:10:19.436148 [debug] [ThreadPool]: On list_postgres_bi_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_bi"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_bi'
  
[0m17:10:19.439589 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m17:10:19.440477 [debug] [ThreadPool]: On list_postgres_bi_bi: ROLLBACK
[0m17:10:19.441040 [debug] [ThreadPool]: On list_postgres_bi_bi: Close
[0m17:10:19.444993 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:19.445294 [debug] [MainThread]: On master: BEGIN
[0m17:10:19.445488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:19.454580 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m17:10:19.454941 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:19.455212 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:19.550560 [debug] [MainThread]: SQL status: SELECT 0 in 0.095 seconds
[0m17:10:19.551491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f0fc21-bb52-4ca5-9e5e-aa54c49ec9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f4c8e0>]}
[0m17:10:19.551812 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:19.552640 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:19.552879 [debug] [MainThread]: On master: BEGIN
[0m17:10:19.554093 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:10:19.554419 [debug] [MainThread]: On master: COMMIT
[0m17:10:19.554629 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:19.554805 [debug] [MainThread]: On master: COMMIT
[0m17:10:19.555531 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:10:19.555780 [debug] [MainThread]: On master: Close
[0m17:10:19.560110 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_ledger
[0m17:10:19.560495 [info ] [Thread-1 (]: 1 of 3 START sql table model bi_staging.stg_fund_ledger ........................ [RUN]
[0m17:10:19.560816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_bi, now model.fund_dbt_project.stg_fund_ledger)
[0m17:10:19.561051 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_ledger
[0m17:10:19.567187 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:10:19.569118 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_ledger
[0m17:10:19.594553 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:10:19.596321 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:10:19.596628 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: BEGIN
[0m17:10:19.596858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:19.614972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:10:19.615349 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:10:19.615607 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m17:10:52.115295 [debug] [Thread-1 (]: SQL status: SELECT 125496 in 32.499 seconds
[0m17:10:52.126305 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:10:52.126978 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger" rename to "stg_fund_ledger__dbt_backup"
[0m17:10:52.128980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:10:52.131200 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:10:52.131484 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp" rename to "stg_fund_ledger"
[0m17:10:52.132276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:10:52.149214 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:10:52.149719 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:10:52.150070 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:10:52.154243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:10:52.198460 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_ledger__dbt_backup"
[0m17:10:52.201287 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:10:52.201567 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
drop table if exists "postgres"."bi_staging"."stg_fund_ledger__dbt_backup" cascade
[0m17:10:52.211943 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m17:10:52.213888 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: Close
[0m17:10:52.216366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46f0fc21-bb52-4ca5-9e5e-aa54c49ec9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023b8340>]}
[0m17:10:52.216897 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bi_staging.stg_fund_ledger ................... [[32mSELECT 125496[0m in 32.65s]
[0m17:10:52.217392 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_ledger
[0m17:10:52.217675 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m17:10:52.218092 [info ] [Thread-1 (]: 2 of 3 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m17:10:52.218423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_ledger, now model.fund_dbt_project.stg_fund_master)
[0m17:10:52.218655 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m17:10:52.224665 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m17:10:52.225662 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m17:10:52.228037 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m17:10:52.230300 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:10:52.230531 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m17:10:52.230739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:52.249652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m17:10:52.250048 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:10:52.250463 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m17:11:01.206195 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 8.955 seconds
[0m17:11:01.210589 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:11:01.210983 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master" rename to "stg_fund_master__dbt_backup"
[0m17:11:01.212060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:11:01.214078 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:11:01.214344 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m17:11:01.215411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:11:01.216214 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:11:01.216448 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:11:01.216652 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:11:01.285208 [debug] [Thread-1 (]: SQL status: COMMIT in 0.068 seconds
[0m17:11:01.290108 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m17:11:01.290730 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:11:01.291080 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m17:11:01.305535 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m17:11:01.306962 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m17:11:01.307556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46f0fc21-bb52-4ca5-9e5e-aa54c49ec9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106294ac0>]}
[0m17:11:01.308094 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.09s]
[0m17:11:01.308532 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m17:11:01.308829 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:11:01.309362 [info ] [Thread-1 (]: 3 of 3 START sql incremental model bi_bi.mart_fund_ledger_11304 ................ [RUN]
[0m17:11:01.309857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.mart_fund_ledger_11304)
[0m17:11:01.310171 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:11:01.313779 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:11:01.314920 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:11:01.335964 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:11:01.336511 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_11304"} */

    
  
    

  create temporary table "mart_fund_ledger_11304__dbt_tmp171101330989"
  
  
    as
  
  (
    with filtered as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    dc_div,
    pre_bal,
    debt_amt,
    credit_amt
  from "postgres"."bi_staging"."stg_fund_ledger"
  where acct_cd in ('11304')
),

calc as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    case
      when dc_div = 'D' then pre_bal + debt_amt - credit_amt
      when dc_div = 'C' then pre_bal + credit_amt - debt_amt
      else null
    end as value
  from filtered
)

select * from calc
  );
  
  
[0m17:11:01.336793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:01.381492 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.045 seconds
[0m17:11:01.390792 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:11:01.391123 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: BEGIN
[0m17:11:01.391904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m17:11:01.392244 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:11:01.392487 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_11304"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_fund_ledger_11304__dbt_tmp171101330989'
        
      order by ordinal_position

  
[0m17:11:01.420775 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.028 seconds
[0m17:11:01.424783 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:11:01.425139 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_11304"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'mart_fund_ledger_11304'
        
        and table_schema = 'bi_bi'
        
      order by ordinal_position

  
[0m17:11:01.427502 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m17:11:01.432972 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:11:01.433292 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_11304"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'mart_fund_ledger_11304'
        
        and table_schema = 'bi_bi'
        
      order by ordinal_position

  
[0m17:11:01.435341 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m17:11:01.443577 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:11:01.444845 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:11:01.445225 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_11304"} */

      insert into "postgres"."bi_bi"."mart_fund_ledger_11304" ("proc_dt", "fund_cd", "acct_cd", "value")
    (
        select "proc_dt", "fund_cd", "acct_cd", "value"
        from "mart_fund_ledger_11304__dbt_tmp171101330989"
    )


  
[0m17:11:01.448580 [debug] [Thread-1 (]: SQL status: INSERT 0 74 in 0.003 seconds
[0m17:11:01.449733 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: COMMIT
[0m17:11:01.450060 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:11:01.450338 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: COMMIT
[0m17:11:01.454127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:11:01.454786 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: Close
[0m17:11:01.455245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46f0fc21-bb52-4ca5-9e5e-aa54c49ec9e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb3580>]}
[0m17:11:01.455742 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model bi_bi.mart_fund_ledger_11304 ........... [[32mINSERT 0 74[0m in 0.15s]
[0m17:11:01.456157 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:11:01.457007 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:01.457244 [debug] [MainThread]: On master: BEGIN
[0m17:11:01.457442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:01.471265 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m17:11:01.471665 [debug] [MainThread]: On master: COMMIT
[0m17:11:01.471909 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:01.472124 [debug] [MainThread]: On master: COMMIT
[0m17:11:01.473177 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:11:01.473463 [debug] [MainThread]: On master: Close
[0m17:11:01.473813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:01.474034 [debug] [MainThread]: Connection 'model.fund_dbt_project.mart_fund_ledger_11304' was properly closed.
[0m17:11:01.474383 [info ] [MainThread]: 
[0m17:11:01.474731 [info ] [MainThread]: Finished running 1 incremental model, 2 table models in 0 hours 0 minutes and 43.48 seconds (43.48s).
[0m17:11:01.475657 [debug] [MainThread]: Command end result
[0m17:11:01.507084 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:11:01.509010 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:11:01.513685 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m17:11:01.513961 [info ] [MainThread]: 
[0m17:11:01.514275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:01.514532 [info ] [MainThread]: 
[0m17:11:01.514767 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:11:01.517377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 45.093166, "process_in_blocks": "0", "process_kernel_time": 0.362204, "process_mem_max_rss": "134004736", "process_out_blocks": "0", "process_user_time": 2.329841}
[0m17:11:01.517763 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:01.517706 after 45.09 seconds
[0m17:11:01.518027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bccd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1d030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1f010>]}
[0m17:11:01.518277 [debug] [MainThread]: Flushing usage events
[0m17:11:02.458312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:11.162476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a20c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109315990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109316080>]}


============================== 17:12:11.167177 | adc017f3-b99e-4652-bbeb-7ca51d4bfd00 ==============================
[0m17:12:11.167177 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:12:11.167546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'version_check': 'True', 'profiles_dir': '/Users/goonzardw/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:12:11.300421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adc017f3-b99e-4652-bbeb-7ca51d4bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972a2f0>]}
[0m17:12:11.334523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adc017f3-b99e-4652-bbeb-7ca51d4bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109317eb0>]}
[0m17:12:11.335674 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:12:11.423473 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:12:11.552207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:11.552537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:11.578314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adc017f3-b99e-4652-bbeb-7ca51d4bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a17ded0>]}
[0m17:12:11.631053 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:12:11.639828 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:12:11.661514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adc017f3-b99e-4652-bbeb-7ca51d4bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a17f220>]}
[0m17:12:11.661900 [info ] [MainThread]: Found 3 models, 7 sources, 434 macros
[0m17:12:11.662138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adc017f3-b99e-4652-bbeb-7ca51d4bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a17f2e0>]}
[0m17:12:11.663226 [info ] [MainThread]: 
[0m17:12:11.663462 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:11.663647 [info ] [MainThread]: 
[0m17:12:11.663961 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:11.666661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:12:11.751446 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:12:11.751758 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:12:11.751952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:11.798419 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.046 seconds
[0m17:12:11.799390 [debug] [ThreadPool]: On list_postgres: Close
[0m17:12:11.801073 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:12:11.801286 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:12:11.801469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:11.811681 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m17:12:11.812638 [debug] [ThreadPool]: On list_postgres: Close
[0m17:12:11.813156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_bi_staging)
[0m17:12:11.813767 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "bi_staging"
"
[0m17:12:11.817232 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_staging"
[0m17:12:11.817484 [debug] [ThreadPool]: On create_postgres_bi_staging: BEGIN
[0m17:12:11.817668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:11.826190 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m17:12:11.826584 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_staging"
[0m17:12:11.826786 [debug] [ThreadPool]: On create_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "create_postgres_bi_staging"} */
create schema if not exists "bi_staging"
[0m17:12:11.828011 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m17:12:11.828634 [debug] [ThreadPool]: On create_postgres_bi_staging: COMMIT
[0m17:12:11.828850 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_staging"
[0m17:12:11.829031 [debug] [ThreadPool]: On create_postgres_bi_staging: COMMIT
[0m17:12:11.836052 [debug] [ThreadPool]: SQL status: COMMIT in 0.007 seconds
[0m17:12:11.836276 [debug] [ThreadPool]: On create_postgres_bi_staging: Close
[0m17:12:11.836663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_bi_staging, now create_postgres_bi_bi)
[0m17:12:11.836946 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "bi_bi"
"
[0m17:12:11.838381 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_bi"
[0m17:12:11.838620 [debug] [ThreadPool]: On create_postgres_bi_bi: BEGIN
[0m17:12:11.838804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:11.854254 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m17:12:11.854582 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_bi"
[0m17:12:11.854778 [debug] [ThreadPool]: On create_postgres_bi_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "create_postgres_bi_bi"} */
create schema if not exists "bi_bi"
[0m17:12:11.856667 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m17:12:11.857461 [debug] [ThreadPool]: On create_postgres_bi_bi: COMMIT
[0m17:12:11.857779 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi_bi"
[0m17:12:11.857993 [debug] [ThreadPool]: On create_postgres_bi_bi: COMMIT
[0m17:12:11.860446 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m17:12:11.860747 [debug] [ThreadPool]: On create_postgres_bi_bi: Close
[0m17:12:11.861666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_bi_bi, now list_postgres_bi_staging)
[0m17:12:11.865793 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:12:11.866082 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m17:12:11.866269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:11.876996 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:12:11.877330 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:12:11.877572 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m17:12:11.892167 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m17:12:11.893100 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m17:12:11.893651 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m17:12:11.894061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now list_postgres_bi_bi)
[0m17:12:11.895622 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:12:11.895895 [debug] [ThreadPool]: On list_postgres_bi_bi: BEGIN
[0m17:12:11.896156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:11.910724 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m17:12:11.911052 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:12:11.911283 [debug] [ThreadPool]: On list_postgres_bi_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_bi"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_bi'
  
[0m17:12:11.915259 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m17:12:11.916222 [debug] [ThreadPool]: On list_postgres_bi_bi: ROLLBACK
[0m17:12:11.916767 [debug] [ThreadPool]: On list_postgres_bi_bi: Close
[0m17:12:11.920249 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:11.920531 [debug] [MainThread]: On master: BEGIN
[0m17:12:11.920740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:11.930821 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:12:11.931124 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:11.931410 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:11.943171 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m17:12:11.944084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adc017f3-b99e-4652-bbeb-7ca51d4bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c8940>]}
[0m17:12:11.944447 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:11.945007 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:11.945233 [debug] [MainThread]: On master: BEGIN
[0m17:12:11.945999 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:12:11.946351 [debug] [MainThread]: On master: COMMIT
[0m17:12:11.946609 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:11.946832 [debug] [MainThread]: On master: COMMIT
[0m17:12:11.947415 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:12:11.947722 [debug] [MainThread]: On master: Close
[0m17:12:11.954185 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_ledger
[0m17:12:11.954661 [info ] [Thread-1 (]: 1 of 3 START sql table model bi_staging.stg_fund_ledger ........................ [RUN]
[0m17:12:11.955051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_bi, now model.fund_dbt_project.stg_fund_ledger)
[0m17:12:11.955356 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_ledger
[0m17:12:11.991066 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:12:11.992710 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_ledger
[0m17:12:12.015975 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:12:12.019233 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:12:12.019564 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: BEGIN
[0m17:12:12.019779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:12.035097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m17:12:12.035436 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:12:12.035680 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m17:12:12.036346 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "igisam.fngl" does not exist
LINE 21:   from "postgres"."igisam"."fngl"
                ^

[0m17:12:12.036689 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: ROLLBACK
[0m17:12:12.037190 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: Close
[0m17:12:12.079750 [debug] [Thread-1 (]: Database Error in model stg_fund_ledger (models/staging/stg_fund_ledger.sql)
  relation "igisam.fngl" does not exist
  LINE 21:   from "postgres"."igisam"."fngl"
                  ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_ledger.sql
[0m17:12:12.081536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc017f3-b99e-4652-bbeb-7ca51d4bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b3070>]}
[0m17:12:12.081990 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model bi_staging.stg_fund_ledger ............... [[31mERROR[0m in 0.13s]
[0m17:12:12.082357 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_ledger
[0m17:12:12.082597 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m17:12:12.082898 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_ledger' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_ledger (models/staging/stg_fund_ledger.sql)
  relation "igisam.fngl" does not exist
  LINE 21:   from "postgres"."igisam"."fngl"
                  ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_ledger.sql.
[0m17:12:12.083202 [info ] [Thread-1 (]: 2 of 3 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m17:12:12.083954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_ledger, now model.fund_dbt_project.stg_fund_master)
[0m17:12:12.084207 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m17:12:12.090415 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m17:12:12.091405 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m17:12:12.093626 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m17:12:12.094385 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:12:12.094667 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m17:12:12.094883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:12.109978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m17:12:12.110295 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:12:12.110674 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m17:12:12.111567 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "igisbiz.afndbascm" does not exist
LINE 13:     select * from "postgres"."igisbiz"."afndbascm"
                           ^

[0m17:12:12.111790 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: ROLLBACK
[0m17:12:12.112289 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m17:12:12.112959 [debug] [Thread-1 (]: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  relation "igisbiz.afndbascm" does not exist
  LINE 13:     select * from "postgres"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m17:12:12.113305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc017f3-b99e-4652-bbeb-7ca51d4bfd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728a590>]}
[0m17:12:12.113724 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model bi_staging.stg_fund_master ............... [[31mERROR[0m in 0.03s]
[0m17:12:12.114056 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m17:12:12.114280 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:12:12.114494 [info ] [Thread-1 (]: 3 of 3 SKIP relation bi_bi.mart_fund_ledger_11304 .............................. [[33mSKIP[0m]
[0m17:12:12.114727 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:12:12.115023 [debug] [Thread-4 (]: Marking all children of 'model.fund_dbt_project.stg_fund_master' to be skipped because of status 'error'.  Reason: Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  relation "igisbiz.afndbascm" does not exist
  LINE 13:     select * from "postgres"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql.
[0m17:12:12.115669 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:12.115864 [debug] [MainThread]: On master: BEGIN
[0m17:12:12.116034 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:12.127328 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m17:12:12.127782 [debug] [MainThread]: On master: COMMIT
[0m17:12:12.128008 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:12.128179 [debug] [MainThread]: On master: COMMIT
[0m17:12:12.128764 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:12:12.129063 [debug] [MainThread]: On master: Close
[0m17:12:12.129360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:12.129535 [debug] [MainThread]: Connection 'model.fund_dbt_project.stg_fund_master' was properly closed.
[0m17:12:12.129764 [info ] [MainThread]: 
[0m17:12:12.129968 [info ] [MainThread]: Finished running 1 incremental model, 2 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m17:12:12.130472 [debug] [MainThread]: Command end result
[0m17:12:12.144518 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:12:12.145971 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:12:12.152880 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m17:12:12.153133 [info ] [MainThread]: 
[0m17:12:12.153378 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:12:12.153582 [info ] [MainThread]: 
[0m17:12:12.153821 [error] [MainThread]:   Database Error in model stg_fund_ledger (models/staging/stg_fund_ledger.sql)
  relation "igisam.fngl" does not exist
  LINE 21:   from "postgres"."igisam"."fngl"
                  ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_ledger.sql
[0m17:12:12.154019 [info ] [MainThread]: 
[0m17:12:12.154236 [error] [MainThread]:   Database Error in model stg_fund_master (models/staging/stg_fund_master.sql)
  relation "igisbiz.afndbascm" does not exist
  LINE 13:     select * from "postgres"."igisbiz"."afndbascm"
                             ^
  compiled code at target/run/fund_dbt_project/models/staging/stg_fund_master.sql
[0m17:12:12.154426 [info ] [MainThread]: 
[0m17:12:12.154624 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m17:12:12.156526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.048385, "process_in_blocks": "0", "process_kernel_time": 0.241887, "process_mem_max_rss": "126369792", "process_out_blocks": "0", "process_user_time": 1.318189}
[0m17:12:12.156779 [debug] [MainThread]: Command `dbt run` failed at 17:12:12.156725 after 1.05 seconds
[0m17:12:12.157032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a20c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a534250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a534a90>]}
[0m17:12:12.157490 [debug] [MainThread]: Flushing usage events
[0m17:12:13.088875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:17.545727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b15a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b16140>]}


============================== 17:13:17.553433 | 2f6e7105-7a3a-477f-afdd-cff0473e9b27 ==============================
[0m17:13:17.553433 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:13:17.553817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:13:17.701085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f6e7105-7a3a-477f-afdd-cff0473e9b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061693f0>]}
[0m17:13:17.734839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f6e7105-7a3a-477f-afdd-cff0473e9b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d926b0>]}
[0m17:13:17.738295 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:13:17.819669 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:13:17.967332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:13:17.967652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:13:17.992816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f6e7105-7a3a-477f-afdd-cff0473e9b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c75f60>]}
[0m17:13:18.044607 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:13:18.050291 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:13:18.073383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f6e7105-7a3a-477f-afdd-cff0473e9b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c70310>]}
[0m17:13:18.073748 [info ] [MainThread]: Found 3 models, 7 sources, 434 macros
[0m17:13:18.073965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f6e7105-7a3a-477f-afdd-cff0473e9b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f21240>]}
[0m17:13:18.075037 [info ] [MainThread]: 
[0m17:13:18.075270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:18.075450 [info ] [MainThread]: 
[0m17:13:18.075759 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:13:18.078662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:13:18.241466 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:13:18.241813 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:13:18.242016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:18.314735 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.073 seconds
[0m17:13:18.315725 [debug] [ThreadPool]: On list_postgres: Close
[0m17:13:18.317449 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:13:18.317723 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:13:18.317907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:18.332445 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.014 seconds
[0m17:13:18.333399 [debug] [ThreadPool]: On list_postgres: Close
[0m17:13:18.334241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_bi_bi)
[0m17:13:18.338159 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:13:18.338467 [debug] [ThreadPool]: On list_postgres_bi_bi: BEGIN
[0m17:13:18.338687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:18.350258 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:13:18.350602 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_bi"
[0m17:13:18.350830 [debug] [ThreadPool]: On list_postgres_bi_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_bi"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_bi'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_bi'
  
[0m17:13:18.358820 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m17:13:18.359728 [debug] [ThreadPool]: On list_postgres_bi_bi: ROLLBACK
[0m17:13:18.360241 [debug] [ThreadPool]: On list_postgres_bi_bi: Close
[0m17:13:18.360776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_bi_bi, now list_postgres_bi_staging)
[0m17:13:18.362367 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:13:18.362656 [debug] [ThreadPool]: On list_postgres_bi_staging: BEGIN
[0m17:13:18.362860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:18.373117 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:13:18.373403 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi_staging"
[0m17:13:18.373621 [debug] [ThreadPool]: On list_postgres_bi_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi_staging'
  
[0m17:13:18.377570 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m17:13:18.378487 [debug] [ThreadPool]: On list_postgres_bi_staging: ROLLBACK
[0m17:13:18.379049 [debug] [ThreadPool]: On list_postgres_bi_staging: Close
[0m17:13:18.382330 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:18.382595 [debug] [MainThread]: On master: BEGIN
[0m17:13:18.382788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:18.392505 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:13:18.392809 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:18.393083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:13:18.399267 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m17:13:18.400195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f6e7105-7a3a-477f-afdd-cff0473e9b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0cf430>]}
[0m17:13:18.400597 [debug] [MainThread]: On master: ROLLBACK
[0m17:13:18.401298 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:18.401562 [debug] [MainThread]: On master: BEGIN
[0m17:13:18.402414 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:13:18.402761 [debug] [MainThread]: On master: COMMIT
[0m17:13:18.402992 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:18.403199 [debug] [MainThread]: On master: COMMIT
[0m17:13:18.403725 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:13:18.404054 [debug] [MainThread]: On master: Close
[0m17:13:18.406180 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_ledger
[0m17:13:18.406600 [info ] [Thread-1 (]: 1 of 3 START sql table model bi_staging.stg_fund_ledger ........................ [RUN]
[0m17:13:18.406941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi_staging, now model.fund_dbt_project.stg_fund_ledger)
[0m17:13:18.407177 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_ledger
[0m17:13:18.412838 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:13:18.415915 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_ledger
[0m17:13:18.472485 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:13:18.474445 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:13:18.474698 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: BEGIN
[0m17:13:18.474911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:18.486336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m17:13:18.486679 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:13:18.486917 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp"
  
  
    as
  
  (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
  
[0m17:13:51.136652 [debug] [Thread-1 (]: SQL status: SELECT 125496 in 32.649 seconds
[0m17:13:51.144244 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:13:51.144533 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi_staging"."stg_fund_ledger__dbt_tmp" rename to "stg_fund_ledger"
[0m17:13:51.147349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:13:51.157437 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:13:51.157838 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:13:51.158081 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:13:51.159635 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:13:51.163886 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_ledger__dbt_backup"
[0m17:13:51.166445 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:13:51.166699 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
drop table if exists "postgres"."bi_staging"."stg_fund_ledger__dbt_backup" cascade
[0m17:13:51.167619 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:13:51.169526 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: Close
[0m17:13:51.172984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f6e7105-7a3a-477f-afdd-cff0473e9b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106138340>]}
[0m17:13:51.173543 [info ] [Thread-1 (]: 1 of 3 OK created sql table model bi_staging.stg_fund_ledger ................... [[32mSELECT 125496[0m in 32.76s]
[0m17:13:51.173935 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_ledger
[0m17:13:51.174214 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m17:13:51.174660 [info ] [Thread-1 (]: 2 of 3 START sql table model bi_staging.stg_fund_master ........................ [RUN]
[0m17:13:51.174979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_ledger, now model.fund_dbt_project.stg_fund_master)
[0m17:13:51.175216 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m17:13:51.182111 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m17:13:51.183024 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m17:13:51.185537 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m17:13:51.186319 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:13:51.186568 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m17:13:51.186785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:51.200377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:13:51.200885 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:13:51.201384 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  
    

  create  table "postgres"."bi_staging"."stg_fund_master__dbt_tmp"
  
  
    as
  
  (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
  
[0m17:14:00.517232 [debug] [Thread-1 (]: SQL status: SELECT 1005 in 9.314 seconds
[0m17:14:00.527633 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:14:00.527948 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi_staging"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m17:14:00.529883 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:14:00.530877 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:14:00.531156 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:14:00.531372 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:14:00.534118 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:14:00.535769 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi_staging"."stg_fund_master__dbt_backup"
[0m17:14:00.536153 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:14:00.536401 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop table if exists "postgres"."bi_staging"."stg_fund_master__dbt_backup" cascade
[0m17:14:00.537103 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m17:14:00.538214 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m17:14:00.538880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f6e7105-7a3a-477f-afdd-cff0473e9b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0aa200>]}
[0m17:14:00.539502 [info ] [Thread-1 (]: 2 of 3 OK created sql table model bi_staging.stg_fund_master ................... [[32mSELECT 1005[0m in 9.36s]
[0m17:14:00.539904 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m17:14:00.540169 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:14:00.540578 [info ] [Thread-1 (]: 3 of 3 START sql incremental model bi_bi.mart_fund_ledger_11304 ................ [RUN]
[0m17:14:00.540869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.mart_fund_ledger_11304)
[0m17:14:00.541099 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:14:00.543408 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:14:00.544103 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:14:00.580703 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:14:00.612325 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:14:00.612879 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: BEGIN
[0m17:14:00.613349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:00.627545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m17:14:00.628006 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:14:00.628361 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_11304"} */

      
  
    

  create  table "postgres"."bi_bi"."mart_fund_ledger_11304"
  
  
    as
  
  (
    with filtered as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    dc_div,
    pre_bal,
    debt_amt,
    credit_amt
  from "postgres"."bi_staging"."stg_fund_ledger"
  where acct_cd in ('11304')
),

calc as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    case
      when dc_div = 'D' then pre_bal + debt_amt - credit_amt
      when dc_div = 'C' then pre_bal + credit_amt - debt_amt
      else null
    end as value
  from filtered
)

select * from calc
  );
  
  
[0m17:14:00.667726 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.039 seconds
[0m17:14:00.668795 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: COMMIT
[0m17:14:00.669069 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:14:00.669298 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: COMMIT
[0m17:14:00.677242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m17:14:00.678100 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: Close
[0m17:14:00.678564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f6e7105-7a3a-477f-afdd-cff0473e9b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cbd90>]}
[0m17:14:00.679046 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model bi_bi.mart_fund_ledger_11304 ........... [[32mSELECT 74[0m in 0.14s]
[0m17:14:00.679449 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:14:00.680677 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:00.681143 [debug] [MainThread]: On master: BEGIN
[0m17:14:00.681382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:00.691286 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:14:00.691655 [debug] [MainThread]: On master: COMMIT
[0m17:14:00.691895 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:00.692107 [debug] [MainThread]: On master: COMMIT
[0m17:14:00.692585 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:14:00.692853 [debug] [MainThread]: On master: Close
[0m17:14:00.693178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:00.693387 [debug] [MainThread]: Connection 'model.fund_dbt_project.mart_fund_ledger_11304' was properly closed.
[0m17:14:00.693813 [info ] [MainThread]: 
[0m17:14:00.694082 [info ] [MainThread]: Finished running 1 incremental model, 2 table models in 0 hours 0 minutes and 42.62 seconds (42.62s).
[0m17:14:00.694751 [debug] [MainThread]: Command end result
[0m17:14:00.714009 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:14:00.716824 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:14:00.723792 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m17:14:00.724114 [info ] [MainThread]: 
[0m17:14:00.724399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:00.724596 [info ] [MainThread]: 
[0m17:14:00.724827 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:14:00.727782 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 43.25439, "process_in_blocks": "0", "process_kernel_time": 0.283439, "process_mem_max_rss": "126664704", "process_out_blocks": "0", "process_user_time": 1.387295}
[0m17:14:00.728213 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:00.728146 after 43.25 seconds
[0m17:14:00.728541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc8d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d926b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1d2290>]}
[0m17:14:00.728795 [debug] [MainThread]: Flushing usage events
[0m17:14:01.599561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:08.320354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c08ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079199c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791a0b0>]}


============================== 17:16:08.327482 | 4e038400-8494-4ebb-a366-39a2121c6485 ==============================
[0m17:16:08.327482 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:16:08.327886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'profiles_dir': '/Users/goonzardw/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:16:08.643995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e038400-8494-4ebb-a366-39a2121c6485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f8400>]}
[0m17:16:08.679025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e038400-8494-4ebb-a366-39a2121c6485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed7370>]}
[0m17:16:08.682837 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:16:08.774618 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:16:09.203803 [error] [MainThread]: Encountered an error:

[0m17:16:09.216951 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/parser/manifest.py", line 2069, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/parser/manifest.py", line 312, in get_full_manifest
    manifest = loader.load()
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/parser/manifest.py", line 359, in load
    file_reader.read_files()
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/parser/read_files.py", line 212, in read_files
    self.read_files_for_project(project, file_types)
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/parser/read_files.py", line 219, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/parser/read_files.py", line 167, in read_files_for_parser
    source_files = get_source_files(
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/parser/read_files.py", line 156, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt/parser/read_files.py", line 84, in load_source_file
    file_contents = load_file_contents(path.absolute_path, strip=True)
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt_common/record.py", line 507, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
  File "/Users/goonzardw/Developer/bi/dbt3/.venv/lib/python3.10/site-packages/dbt_common/clients/system.py", line 178, in load_file_contents
    to_return = handle.read().decode("utf-8")
KeyboardInterrupt

[0m17:16:09.222422 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.97322744, "process_in_blocks": "0", "process_kernel_time": 0.231268, "process_mem_max_rss": "109494272", "process_out_blocks": "0", "process_user_time": 1.155106}
[0m17:16:09.223072 [debug] [MainThread]: Command `dbt run` failed at 17:16:09.222952 after 0.97 seconds
[0m17:16:09.223618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c08ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102453f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110245450>]}
[0m17:16:09.224097 [debug] [MainThread]: Flushing usage events
[0m17:16:10.122861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:15.775275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110408c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111319960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11131a050>]}


============================== 17:16:15.781475 | 7eb3cd9e-d1cb-46c7-a302-23606f6d422e ==============================
[0m17:16:15.781475 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:16:15.783005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/goonzardw/Developer/bi/dbt3/logs', 'profiles_dir': '/Users/goonzardw/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:16:15.893190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7eb3cd9e-d1cb-46c7-a302-23606f6d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c9f00>]}
[0m17:16:15.926941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7eb3cd9e-d1cb-46c7-a302-23606f6d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11202d900>]}
[0m17:16:15.927912 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:16:16.006093 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:16:16.067256 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:16:16.067666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7eb3cd9e-d1cb-46c7-a302-23606f6d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba6b30>]}
[0m17:16:16.823720 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.staging
- models.marts.fund
- models.marts
[0m17:16:16.831471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eb3cd9e-d1cb-46c7-a302-23606f6d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c04a00>]}
[0m17:16:16.880159 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:16:16.885697 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:16:16.998626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eb3cd9e-d1cb-46c7-a302-23606f6d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bfe170>]}
[0m17:16:16.999174 [info ] [MainThread]: Found 3 models, 7 sources, 434 macros
[0m17:16:16.999474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eb3cd9e-d1cb-46c7-a302-23606f6d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128360b0>]}
[0m17:16:17.000864 [info ] [MainThread]: 
[0m17:16:17.001166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:17.001410 [info ] [MainThread]: 
[0m17:16:17.001816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:17.005817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:16:18.629477 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:16:18.629876 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:16:18.630147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:18.788092 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.158 seconds
[0m17:16:18.789299 [debug] [ThreadPool]: On list_postgres: Close
[0m17:16:18.790025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_bi)
[0m17:16:18.790819 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "bi"
"
[0m17:16:18.795813 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi"
[0m17:16:18.796093 [debug] [ThreadPool]: On create_postgres_bi: BEGIN
[0m17:16:18.796293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:18.809385 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m17:16:18.809780 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi"
[0m17:16:18.810011 [debug] [ThreadPool]: On create_postgres_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "create_postgres_bi"} */
create schema if not exists "bi"
[0m17:16:18.811806 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m17:16:18.812492 [debug] [ThreadPool]: On create_postgres_bi: COMMIT
[0m17:16:18.812728 [debug] [ThreadPool]: Using postgres connection "create_postgres_bi"
[0m17:16:18.812929 [debug] [ThreadPool]: On create_postgres_bi: COMMIT
[0m17:16:18.814767 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m17:16:18.815064 [debug] [ThreadPool]: On create_postgres_bi: Close
[0m17:16:18.816000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_bi, now list_postgres_bi)
[0m17:16:18.820733 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi"
[0m17:16:18.821046 [debug] [ThreadPool]: On list_postgres_bi: BEGIN
[0m17:16:18.821260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:18.837167 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m17:16:18.837545 [debug] [ThreadPool]: Using postgres connection "list_postgres_bi"
[0m17:16:18.837814 [debug] [ThreadPool]: On list_postgres_bi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "list_postgres_bi"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bi'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bi'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bi'
  
[0m17:16:18.847850 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m17:16:18.848927 [debug] [ThreadPool]: On list_postgres_bi: ROLLBACK
[0m17:16:18.849774 [debug] [ThreadPool]: On list_postgres_bi: Close
[0m17:16:18.853648 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:18.853975 [debug] [MainThread]: On master: BEGIN
[0m17:16:18.854211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:18.864977 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m17:16:18.865380 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:18.865728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:18.884191 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m17:16:18.885345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eb3cd9e-d1cb-46c7-a302-23606f6d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e3190>]}
[0m17:16:18.885774 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:18.886553 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:18.886875 [debug] [MainThread]: On master: BEGIN
[0m17:16:18.887970 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:16:18.888380 [debug] [MainThread]: On master: COMMIT
[0m17:16:18.888709 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:18.888999 [debug] [MainThread]: On master: COMMIT
[0m17:16:18.889764 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:18.890178 [debug] [MainThread]: On master: Close
[0m17:16:18.900911 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_ledger
[0m17:16:18.901533 [info ] [Thread-1 (]: 1 of 3 START sql view model bi.stg_fund_ledger ................................. [RUN]
[0m17:16:18.902041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_bi, now model.fund_dbt_project.stg_fund_ledger)
[0m17:16:18.902410 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_ledger
[0m17:16:18.911391 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:16:18.914125 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_ledger
[0m17:16:18.945528 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_ledger"
[0m17:16:18.952038 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:16:18.952436 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: BEGIN
[0m17:16:18.952712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:18.969387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:16:18.969827 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:16:18.970139 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */

  create view "postgres"."bi"."stg_fund_ledger__dbt_tmp"
    
    
  as (
    with raw as (
  select
    "proc_dt",
    "fund_cd",
    "acct_cd",
    "dc_div",
    "pre_bal"::numeric,
    "debt_amt"::numeric,
    "credit_amt"::numeric
  from "postgres"."igisam"."fngl"
  where "proc_dt" = current_date - interval '1 day'  -- 🟡 YESTERDAY ONLY
)

select * from raw
  );
[0m17:16:19.002852 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m17:16:19.009019 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:16:19.009462 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
alter table "postgres"."bi"."stg_fund_ledger__dbt_tmp" rename to "stg_fund_ledger"
[0m17:16:19.017597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m17:16:19.030375 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:16:19.030819 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:16:19.031106 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: COMMIT
[0m17:16:19.038512 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m17:16:19.043514 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi"."stg_fund_ledger__dbt_backup"
[0m17:16:19.046399 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_ledger"
[0m17:16:19.046687 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_ledger"} */
drop view if exists "postgres"."bi"."stg_fund_ledger__dbt_backup" cascade
[0m17:16:19.049901 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:16:19.051971 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_ledger: Close
[0m17:16:19.070058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eb3cd9e-d1cb-46c7-a302-23606f6d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128cb130>]}
[0m17:16:19.070769 [info ] [Thread-1 (]: 1 of 3 OK created sql view model bi.stg_fund_ledger ............................ [[32mCREATE VIEW[0m in 0.15s]
[0m17:16:19.071429 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_ledger
[0m17:16:19.071840 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.stg_fund_master
[0m17:16:19.072249 [info ] [Thread-1 (]: 2 of 3 START sql view model bi.stg_fund_master ................................. [RUN]
[0m17:16:19.072753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_ledger, now model.fund_dbt_project.stg_fund_master)
[0m17:16:19.073253 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.stg_fund_master
[0m17:16:19.080630 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.stg_fund_master"
[0m17:16:19.081785 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.stg_fund_master
[0m17:16:19.118168 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.stg_fund_master"
[0m17:16:19.118927 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:16:19.119146 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: BEGIN
[0m17:16:19.119341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:19.137025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:16:19.137362 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:16:19.137746 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */

  create view "postgres"."bi"."stg_fund_master__dbt_tmp"
    
    
  as (
    with afn as (
    select * from "postgres"."igisbiz"."afndbascm"
),
fn as (
    select * from "postgres"."igisam"."fn"
),
mtfn as (
    select distinct "FUND_CD" from "postgres"."igisam"."mtfn"
)

select
    -- FUND identifiers and names
    afn.FUND_CD,
    afn.FUND_NM,
    afn.FUND_NUM,
    afn.FUND_NM_FULL,
    afn.FUND_ANM,
    afn.FUND_ENM,
    afn.FUND_ENG_ANM,

    -- Status and classification
    afn.MNGT_STAT,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MNGT_STAT'
      and code.code_id = afn.MNGT_STAT
    limit 1
)
 as MNGT_STAT_TXT,
    coalesce(afn.BLND_YN, 'N') as BLND_YN,
    afn.FUND_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_CLS'
      and code.code_id = afn.FUND_CLS
    limit 1
)
 as FUND_CLS_TXT,
    afn.FUND_KICD,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_FUND_KICD'
      and code.code_id = afn.FUND_KICD
    limit 1
)
 as FUND_KICD_TXT,
    afn.INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TYPE'
      and code.code_id = afn.INVT_TYPE
    limit 1
)
 as INVT_TYPE_TXT,
    afn.INVT_ASET_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_ASET_TYPE'
      and code.code_id = afn.INVT_ASET_TYPE
    limit 1
)
 as INVT_ASET_TYPE_TXT,
    afn.INVT_TRGT_LCTN_AREA,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_TRGT_LCTN_AREA'
      and code.code_id = afn.INVT_TRGT_LCTN_AREA
    limit 1
)
 as INVT_TRGT_LCTN_AREA_TXT,
    afn.INVT_STTG,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'INVT_STTG'
      and code.code_id = afn.INVT_STTG
    limit 1
)
 as INVT_STTG_TXT,

    -- Investment characteristics
    coalesce(afn.DVLP_YN, 'N') as DVLP_YN,
    afn.INVT_TRGT_ASET,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'AUREM_INVT_TRGT_ASET'
      and code.code_id = afn.INVT_TRGT_ASET
    limit 1
)
 as INVT_TRGT_ASET_TXT,
    afn.DMAB_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'DMAB_CLS'
      and code.code_id = afn.DMAB_CLS
    limit 1
)
 as DMAB_CLS_TXT,
    afn.PO_PE_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'PO_PE_CLS'
      and code.code_id = afn.PO_PE_CLS
    limit 1
)
 as PO_PE_CLS_TXT,
    afn.MOJA_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MOJA_CLS'
      and code.code_id = afn.MOJA_CLS
    limit 1
)
 as MOJA_CLS_TXT,
    afn.MULTI_CLAS_CLS,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'MULTI_CLAS_CLS'
      and code.code_id = afn.MULTI_CLAS_CLS
    limit 1
)
 as MULTI_CLAS_CLS_TXT,

    -- Fund structure
    afn.FUND_STRR,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'FUND_STRR'
      and code.code_id = afn.FUND_STRR
    limit 1
)
 as FUND_STRR_TXT,
    afn.LOAN_INVT_TYPE,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'LOAN_INVT_TYPE'
      and code.code_id = afn.LOAN_INVT_TYPE
    limit 1
)
 as LOAN_INVT_TYPE_TXT,

    -- Service providers
    afn.AGCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'OTHR_AGCO_CLS'
      and code.code_id = afn.AGCO
    limit 1
)
 as AGCO_TXT,
    afn.CNCO,
    
(
    select code_nm
    from "postgres"."igisdms"."mdbmcodef" code
    where code.code_grp_id = 'CNCO_CODE'
      and code.code_id = afn.CNCO
    limit 1
)
 as CNCO_NM,

    -- Key dates
    afn.CNRC_STTL_DT,
    afn.FST_ESDT,
    afn.MNGT_BGDT,
    afn.MTRT_PRDT,
    afn.MNGT_EXDT,
    afn.FUND_LQDT,

    -- Status flags
    afn.FUND_CANC_YN,
    afn.THCO_FUND_FOF_INCU_YN,
    afn.SD_YN,
    afn.SD_STTL_DT,
    afn.CPCL_MNNR_YN,

    -- Management details
    afn.INVT_INCR_EMPL_NO,
    afn.INVT_PTPR_EMPL_NO,
    afn.MANG_INCR_EMPL_NO,
    afn.MANG_PTPR_EMPL_NO,
    afn.MANG_DEPT_CD,

    -- Compliance and codes
    afn.ACNG_AUDT_YN,
    afn.FSS_ISCD,
    afn.KOFIA_ISCD,
    afn.KSD_FUND_CD,
    afn.KSD_ISCD,

    -- Fund classification depth
    afn.ACNG_PRD,
    afn.FUND_1_DIV, afn.FUND_2_DIV, afn.FUND_3_DIV, afn.FUND_4_DIV,
    afn.FUND_5_DIV, afn.FUND_6_DIV, afn.FUND_7_DIV, afn.FUND_8_DIV,
    afn.FUND_9_DIV, afn.FUND_10_DIV, afn.FUND_11_DIV, afn.FUND_12_DIV,
    afn.FUND_13_DIV, afn.FUND_14_DIV,

    -- Risk, currency, and flags
    afn.STND_CRNC,
    afn.FUND_RISK_GRAD,
    afn.CPLX_FUND_YN,
    afn.FX_HEDG_MTHD,
    coalesce(afn.IPUT_NTRGT, 'N') as IPUT_NTRGT,
    coalesce(afn.KMS_TRGT_YN, 'N') as KMS_TRGT_YN,
    coalesce(afn.AUTO_TRGT_YN, 'N') as AUTO_TRGT_YN,
    coalesce(afn.USE_YN, 'N') as USE_YN,
    coalesce(afn.INFO_SECU_YN, 'N') as INFO_SECU_YN,
    coalesce(afn.OVRS_FUND_YN, 'N') as OVRS_FUND_YN,
    afn.UNUL_MATR,
    case 
        when mtfn."FUND_CD" is not null then 'Y'
        else 'N'
    end as FRN_CCY_YN,

    -- FN-sourced fields
    fn.NEXT_FEE_WITHDRAW_DT_1 as NEXT_FEE_WITHDRAW_DT,
    fn.PRE_FEE_WITHDRAW_DT_1 as PRE_FEE_WITHDRAW_DT,
    fn.NEXT_STTL_DT,
    fn.PRE_STTL_DT,
    fn.STTL_PRD

from afn
left join fn
    on afn.FUND_CD = fn.FUND_CD
left join "postgres"."igisam"."mtfn" mtfn
    on afn.FUND_CD = mtfn."FUND_CD"
  );
[0m17:16:19.188692 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m17:16:19.191398 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:16:19.191734 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
alter table "postgres"."bi"."stg_fund_master__dbt_tmp" rename to "stg_fund_master"
[0m17:16:19.194074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:16:19.195095 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:16:19.195394 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:16:19.195647 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: COMMIT
[0m17:16:19.206105 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m17:16:19.208354 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi"."stg_fund_master__dbt_backup"
[0m17:16:19.208861 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.stg_fund_master"
[0m17:16:19.209163 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.stg_fund_master"} */
drop view if exists "postgres"."bi"."stg_fund_master__dbt_backup" cascade
[0m17:16:19.210072 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:16:19.211111 [debug] [Thread-1 (]: On model.fund_dbt_project.stg_fund_master: Close
[0m17:16:19.211605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eb3cd9e-d1cb-46c7-a302-23606f6d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131c3280>]}
[0m17:16:19.212122 [info ] [Thread-1 (]: 2 of 3 OK created sql view model bi.stg_fund_master ............................ [[32mCREATE VIEW[0m in 0.14s]
[0m17:16:19.212562 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.stg_fund_master
[0m17:16:19.212851 [debug] [Thread-1 (]: Began running node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:16:19.213335 [info ] [Thread-1 (]: 3 of 3 START sql view model bi.mart_fund_ledger_11304 .......................... [RUN]
[0m17:16:19.213694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fund_dbt_project.stg_fund_master, now model.fund_dbt_project.mart_fund_ledger_11304)
[0m17:16:19.213964 [debug] [Thread-1 (]: Began compiling node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:16:19.216341 [debug] [Thread-1 (]: Writing injected SQL for node "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:16:19.226323 [debug] [Thread-1 (]: Began executing node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:16:19.229258 [debug] [Thread-1 (]: Writing runtime sql for node "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:16:19.232513 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:16:19.232843 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: BEGIN
[0m17:16:19.233084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:19.242782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:16:19.243195 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:16:19.243473 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_11304"} */

  create view "postgres"."bi"."mart_fund_ledger_11304__dbt_tmp"
    
    
  as (
    with filtered as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    dc_div,
    pre_bal,
    debt_amt,
    credit_amt
  from "postgres"."bi"."stg_fund_ledger"
  where acct_cd in ('11304')
),

calc as (
  select
    proc_dt,
    fund_cd,
    acct_cd,
    case
      when dc_div = 'D' then pre_bal + debt_amt - credit_amt
      when dc_div = 'C' then pre_bal + credit_amt - debt_amt
      else null
    end as value
  from filtered
)

select * from calc
  );
[0m17:16:19.251469 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:16:19.254137 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:16:19.254560 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_11304"} */
alter table "postgres"."bi"."mart_fund_ledger_11304__dbt_tmp" rename to "mart_fund_ledger_11304"
[0m17:16:19.255507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:16:19.256573 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: COMMIT
[0m17:16:19.256855 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:16:19.257104 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: COMMIT
[0m17:16:19.258641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:16:19.261170 [debug] [Thread-1 (]: Applying DROP to: "postgres"."bi"."mart_fund_ledger_11304__dbt_backup"
[0m17:16:19.261582 [debug] [Thread-1 (]: Using postgres connection "model.fund_dbt_project.mart_fund_ledger_11304"
[0m17:16:19.261842 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "fund_dbt", "target_name": "dev", "node_id": "model.fund_dbt_project.mart_fund_ledger_11304"} */
drop view if exists "postgres"."bi"."mart_fund_ledger_11304__dbt_backup" cascade
[0m17:16:19.262522 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:16:19.263492 [debug] [Thread-1 (]: On model.fund_dbt_project.mart_fund_ledger_11304: Close
[0m17:16:19.263979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eb3cd9e-d1cb-46c7-a302-23606f6d422e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112985390>]}
[0m17:16:19.264454 [info ] [Thread-1 (]: 3 of 3 OK created sql view model bi.mart_fund_ledger_11304 ..................... [[32mCREATE VIEW[0m in 0.05s]
[0m17:16:19.264848 [debug] [Thread-1 (]: Finished running node model.fund_dbt_project.mart_fund_ledger_11304
[0m17:16:19.265661 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:19.265929 [debug] [MainThread]: On master: BEGIN
[0m17:16:19.266134 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:19.276669 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:16:19.277044 [debug] [MainThread]: On master: COMMIT
[0m17:16:19.277274 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:19.277474 [debug] [MainThread]: On master: COMMIT
[0m17:16:19.278019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:19.278361 [debug] [MainThread]: On master: Close
[0m17:16:19.278686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:19.278904 [debug] [MainThread]: Connection 'model.fund_dbt_project.mart_fund_ledger_11304' was properly closed.
[0m17:16:19.279175 [info ] [MainThread]: 
[0m17:16:19.279416 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m17:16:19.280037 [debug] [MainThread]: Command end result
[0m17:16:19.296161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/goonzardw/Developer/bi/dbt3/target/manifest.json
[0m17:16:19.298177 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/goonzardw/Developer/bi/dbt3/target/semantic_manifest.json
[0m17:16:19.303669 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/goonzardw/Developer/bi/dbt3/target/run_results.json
[0m17:16:19.303872 [info ] [MainThread]: 
[0m17:16:19.304112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:19.304300 [info ] [MainThread]: 
[0m17:16:19.304786 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:16:19.306790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5903223, "process_in_blocks": "0", "process_kernel_time": 0.327694, "process_mem_max_rss": "133693440", "process_out_blocks": "0", "process_user_time": 2.121522}
[0m17:16:19.307125 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:19.307065 after 3.59 seconds
[0m17:16:19.307368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110408c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c06bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a9c220>]}
[0m17:16:19.307600 [debug] [MainThread]: Flushing usage events
[0m17:16:20.110178 [debug] [MainThread]: An error was encountered while trying to flush usage events
